
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../reference_grid_helpers/">
      
      
        <link rel="next" href="../../contribution_guide/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Contingency Analysis - Topology Optimizer</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#contingency-analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Topology Optimizer" class="md-header__button md-logo" aria-label="Topology Optimizer" data-md-component="logo">
      
  <img src="../../assets/elia-group-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Topology Optimizer
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Contingency Analysis
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/eliagroup/ToOp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    EliaGroup-OpenSource/ToOp
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../importer/intro/" class="md-tabs__link">
          
  
  
  Importer

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../dc_solver/intro/" class="md-tabs__link">
          
  
  
  DC Solver

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../topology_optimizer/intro/" class="md-tabs__link">
          
  
  
  Topology Optimizer

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../interfaces/intro/" class="md-tabs__link">
          
  
  
  Interfaces

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../grid_helpers/intro/" class="md-tabs__link">
          
  
  
  Grid Helpers

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../contingency_analysis/intro/" class="md-tabs__link">
          
  
  
  Contingency Analysis

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contribution_guide/" class="md-tabs__link">
        
  
  
    
  
  Contribution Guide

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../benchmark/" class="md-tabs__link">
          
  
  
  Benchmark

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Topology Optimizer" class="md-nav__button md-logo" aria-label="Topology Optimizer" data-md-component="logo">
      
  <img src="../../assets/elia-group-logo.png" alt="logo">

    </a>
    Topology Optimizer
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/eliagroup/ToOp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    EliaGroup-OpenSource/ToOp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_importer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_dc_solver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DC Solver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_topology_optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Topology Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_interfaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interfaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_grid_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid Helpers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ac-loadflow-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        AC Loadflow Service
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;ac_loadflow_service
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ac_loadflow_service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service.get_ac_loadflow_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_ac_loadflow_results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_energy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_energy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.count_critical_branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;count_critical_branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.get_worst_k_contingencies_ac" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_worst_k_contingencies_ac
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;kafka_client
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" kafka_client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LongRunningKafkaConsumer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LongRunningKafkaConsumer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;consumer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.client_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;client_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;assignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.last_msg" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;last_msg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.is_paused" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_paused
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consume" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;consume
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.poll" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.commit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;commit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.start_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;heartbeat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.stop_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.close" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lf_worker
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lf_worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.args" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;args
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LoadflowWorkerArgs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LoadflowWorkerArgs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.kafka_broker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;kafka_broker
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_command_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_command_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_results_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_results_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_heartbeat_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_heartbeat_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.heartbeat_interval_ms" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;heartbeat_interval_ms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.instance_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;instance_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.processed_gridfile_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;processed_gridfile_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_result_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_result_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.n_processes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_processes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.idle_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;idle_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.solver_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solver_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid_fs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid_fs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.main" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;main
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PandaPower
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_pandapower
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_pandapower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_single_outage" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_single_outage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.restore_elements_to_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;restore_elements_to_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.get_element_results_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_element_results_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.set_outaged_elements_out_of_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_outaged_elements_out_of_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_sequential" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_sequential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_parallel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_pandapower
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.pandapower_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;pandapower_helpers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pypowsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PyPowsybl
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_powsybl
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_powsybl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_powsybl_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_powsybl_analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers_polars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers_polars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_va_diff_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.update_basename_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.add_name_column_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_branch_results_polars
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblContingency
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblContingency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.is_basecase" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_basecase
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblMonitoredElements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblMonitoredElements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.trafo3w" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;trafo3w
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.switches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;switches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;buses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblNMinus1Definition
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblNMinus1Definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.model_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.monitored_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;monitored_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branch_limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.bus_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bus_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.element_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;element_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_propagation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_propagation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__getitem__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_contingency_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_contingency_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_monitored_elements_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_monitored_elements_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_branch_limits
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prepare_branch_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits--todo-decide-if-and-how-this-could-be-extended-to-other-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        TODO Decide if and how this could be extended to other limits.
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff_with_buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff_with_buses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_va_diff_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_busbar_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_busbar_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_nminus1_for_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_nminus1_for_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_regulating_element_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_regulating_element_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_node_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_branch_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_convergence_result_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_convergence_result_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.update_basename" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.add_name_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.set_target_values_to_lf_values_incl_distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_target_values_to_lf_values_incl_distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_full_nminus1_definition_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_full_nminus1_definition_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Importer
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Importer
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../importer/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../importer/pandapower/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pandapower import
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../importer/pypowsybl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyPowSyBl import
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../importer/pypowsybl/merge_ucte_with_cgmes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Merging UCTE and CGMES Networks with pypowsybl
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../importer/network_graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Graph for Topologies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../importer/contingency_from_power_factory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contingency Import and Matching
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../importer/worker/worker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer worker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../importer/exporter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exporter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_importer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_dc_solver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DC Solver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_topology_optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Topology Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_interfaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interfaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_grid_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid Helpers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ac-loadflow-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        AC Loadflow Service
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;ac_loadflow_service
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ac_loadflow_service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service.get_ac_loadflow_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_ac_loadflow_results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_energy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_energy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.count_critical_branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;count_critical_branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.get_worst_k_contingencies_ac" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_worst_k_contingencies_ac
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;kafka_client
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" kafka_client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LongRunningKafkaConsumer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LongRunningKafkaConsumer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;consumer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.client_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;client_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;assignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.last_msg" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;last_msg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.is_paused" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_paused
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consume" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;consume
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.poll" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.commit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;commit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.start_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;heartbeat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.stop_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.close" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lf_worker
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lf_worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.args" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;args
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LoadflowWorkerArgs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LoadflowWorkerArgs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.kafka_broker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;kafka_broker
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_command_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_command_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_results_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_results_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_heartbeat_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_heartbeat_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.heartbeat_interval_ms" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;heartbeat_interval_ms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.instance_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;instance_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.processed_gridfile_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;processed_gridfile_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_result_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_result_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.n_processes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_processes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.idle_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;idle_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.solver_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solver_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid_fs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid_fs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.main" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;main
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PandaPower
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_pandapower
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_pandapower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_single_outage" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_single_outage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.restore_elements_to_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;restore_elements_to_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.get_element_results_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_element_results_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.set_outaged_elements_out_of_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_outaged_elements_out_of_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_sequential" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_sequential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_parallel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_pandapower
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.pandapower_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;pandapower_helpers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pypowsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PyPowsybl
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_powsybl
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_powsybl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_powsybl_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_powsybl_analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers_polars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers_polars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_va_diff_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.update_basename_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.add_name_column_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_branch_results_polars
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblContingency
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblContingency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.is_basecase" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_basecase
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblMonitoredElements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblMonitoredElements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.trafo3w" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;trafo3w
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.switches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;switches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;buses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblNMinus1Definition
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblNMinus1Definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.model_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.monitored_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;monitored_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branch_limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.bus_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bus_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.element_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;element_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_propagation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_propagation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__getitem__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_contingency_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_contingency_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_monitored_elements_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_monitored_elements_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_branch_limits
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prepare_branch_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits--todo-decide-if-and-how-this-could-be-extended-to-other-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        TODO Decide if and how this could be extended to other limits.
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff_with_buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff_with_buses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_va_diff_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_busbar_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_busbar_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_nminus1_for_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_nminus1_for_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_regulating_element_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_regulating_element_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_node_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_branch_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_convergence_result_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_convergence_result_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.update_basename" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.add_name_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.set_target_values_to_lf_values_incl_distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_target_values_to_lf_values_incl_distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_full_nminus1_definition_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_full_nminus1_definition_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    DC Solver
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    DC Solver
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dc_solver/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DC Solver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dc_solver/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dc_solver/switching_distance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Switching distance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dc_solver/nminus2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    N Minus 2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dc_solver/preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Preprocessing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dc_solver/busbar_outage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Busbar Outage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dc_solver/install_time/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install_time Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_importer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_dc_solver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DC Solver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_topology_optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Topology Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_interfaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interfaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_grid_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid Helpers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ac-loadflow-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        AC Loadflow Service
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;ac_loadflow_service
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ac_loadflow_service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service.get_ac_loadflow_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_ac_loadflow_results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_energy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_energy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.count_critical_branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;count_critical_branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.get_worst_k_contingencies_ac" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_worst_k_contingencies_ac
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;kafka_client
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" kafka_client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LongRunningKafkaConsumer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LongRunningKafkaConsumer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;consumer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.client_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;client_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;assignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.last_msg" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;last_msg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.is_paused" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_paused
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consume" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;consume
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.poll" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.commit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;commit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.start_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;heartbeat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.stop_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.close" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lf_worker
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lf_worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.args" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;args
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LoadflowWorkerArgs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LoadflowWorkerArgs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.kafka_broker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;kafka_broker
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_command_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_command_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_results_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_results_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_heartbeat_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_heartbeat_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.heartbeat_interval_ms" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;heartbeat_interval_ms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.instance_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;instance_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.processed_gridfile_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;processed_gridfile_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_result_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_result_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.n_processes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_processes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.idle_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;idle_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.solver_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solver_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid_fs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid_fs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.main" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;main
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PandaPower
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_pandapower
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_pandapower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_single_outage" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_single_outage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.restore_elements_to_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;restore_elements_to_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.get_element_results_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_element_results_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.set_outaged_elements_out_of_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_outaged_elements_out_of_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_sequential" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_sequential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_parallel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_pandapower
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.pandapower_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;pandapower_helpers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pypowsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PyPowsybl
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_powsybl
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_powsybl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_powsybl_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_powsybl_analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers_polars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers_polars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_va_diff_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.update_basename_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.add_name_column_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_branch_results_polars
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblContingency
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblContingency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.is_basecase" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_basecase
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblMonitoredElements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblMonitoredElements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.trafo3w" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;trafo3w
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.switches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;switches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;buses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblNMinus1Definition
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblNMinus1Definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.model_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.monitored_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;monitored_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branch_limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.bus_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bus_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.element_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;element_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_propagation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_propagation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__getitem__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_contingency_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_contingency_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_monitored_elements_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_monitored_elements_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_branch_limits
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prepare_branch_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits--todo-decide-if-and-how-this-could-be-extended-to-other-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        TODO Decide if and how this could be extended to other limits.
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff_with_buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff_with_buses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_va_diff_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_busbar_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_busbar_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_nminus1_for_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_nminus1_for_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_regulating_element_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_regulating_element_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_node_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_branch_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_convergence_result_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_convergence_result_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.update_basename" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.add_name_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.set_target_values_to_lf_values_incl_distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_target_values_to_lf_values_incl_distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_full_nminus1_definition_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_full_nminus1_definition_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Topology Optimizer
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Topology Optimizer
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topology_optimizer/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Topology Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topology_optimizer/structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package Structure and Interactions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topology_optimizer/deepdive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Under the Hood: Optimization Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AC Validation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    AC Validation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topology_optimizer/ac/select_strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Selection Strategy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topology_optimizer/ac/early_stopping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Early Stopping Strategy for N-1 Overload Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_importer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_dc_solver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DC Solver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_topology_optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Topology Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_interfaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interfaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_grid_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid Helpers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ac-loadflow-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        AC Loadflow Service
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;ac_loadflow_service
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ac_loadflow_service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service.get_ac_loadflow_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_ac_loadflow_results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_energy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_energy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.count_critical_branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;count_critical_branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.get_worst_k_contingencies_ac" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_worst_k_contingencies_ac
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;kafka_client
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" kafka_client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LongRunningKafkaConsumer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LongRunningKafkaConsumer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;consumer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.client_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;client_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;assignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.last_msg" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;last_msg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.is_paused" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_paused
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consume" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;consume
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.poll" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.commit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;commit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.start_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;heartbeat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.stop_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.close" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lf_worker
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lf_worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.args" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;args
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LoadflowWorkerArgs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LoadflowWorkerArgs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.kafka_broker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;kafka_broker
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_command_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_command_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_results_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_results_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_heartbeat_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_heartbeat_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.heartbeat_interval_ms" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;heartbeat_interval_ms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.instance_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;instance_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.processed_gridfile_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;processed_gridfile_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_result_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_result_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.n_processes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_processes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.idle_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;idle_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.solver_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solver_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid_fs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid_fs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.main" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;main
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PandaPower
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_pandapower
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_pandapower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_single_outage" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_single_outage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.restore_elements_to_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;restore_elements_to_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.get_element_results_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_element_results_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.set_outaged_elements_out_of_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_outaged_elements_out_of_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_sequential" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_sequential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_parallel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_pandapower
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.pandapower_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;pandapower_helpers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pypowsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PyPowsybl
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_powsybl
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_powsybl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_powsybl_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_powsybl_analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers_polars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers_polars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_va_diff_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.update_basename_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.add_name_column_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_branch_results_polars
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblContingency
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblContingency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.is_basecase" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_basecase
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblMonitoredElements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblMonitoredElements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.trafo3w" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;trafo3w
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.switches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;switches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;buses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblNMinus1Definition
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblNMinus1Definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.model_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.monitored_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;monitored_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branch_limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.bus_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bus_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.element_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;element_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_propagation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_propagation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__getitem__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_contingency_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_contingency_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_monitored_elements_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_monitored_elements_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_branch_limits
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prepare_branch_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits--todo-decide-if-and-how-this-could-be-extended-to-other-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        TODO Decide if and how this could be extended to other limits.
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff_with_buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff_with_buses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_va_diff_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_busbar_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_busbar_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_nminus1_for_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_nminus1_for_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_regulating_element_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_regulating_element_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_node_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_branch_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_convergence_result_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_convergence_result_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.update_basename" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.add_name_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.set_target_values_to_lf_values_incl_distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_target_values_to_lf_values_incl_distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_full_nminus1_definition_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_full_nminus1_definition_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Interfaces
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Interfaces
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ToOp-Interfaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../interfaces/asset_topology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Asset Topology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_importer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_dc_solver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DC Solver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_topology_optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Topology Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_interfaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interfaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_grid_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid Helpers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ac-loadflow-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        AC Loadflow Service
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;ac_loadflow_service
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ac_loadflow_service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service.get_ac_loadflow_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_ac_loadflow_results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_energy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_energy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.count_critical_branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;count_critical_branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.get_worst_k_contingencies_ac" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_worst_k_contingencies_ac
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;kafka_client
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" kafka_client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LongRunningKafkaConsumer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LongRunningKafkaConsumer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;consumer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.client_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;client_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;assignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.last_msg" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;last_msg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.is_paused" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_paused
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consume" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;consume
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.poll" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.commit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;commit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.start_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;heartbeat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.stop_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.close" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lf_worker
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lf_worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.args" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;args
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LoadflowWorkerArgs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LoadflowWorkerArgs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.kafka_broker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;kafka_broker
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_command_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_command_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_results_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_results_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_heartbeat_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_heartbeat_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.heartbeat_interval_ms" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;heartbeat_interval_ms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.instance_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;instance_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.processed_gridfile_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;processed_gridfile_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_result_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_result_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.n_processes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_processes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.idle_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;idle_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.solver_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solver_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid_fs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid_fs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.main" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;main
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PandaPower
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_pandapower
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_pandapower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_single_outage" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_single_outage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.restore_elements_to_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;restore_elements_to_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.get_element_results_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_element_results_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.set_outaged_elements_out_of_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_outaged_elements_out_of_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_sequential" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_sequential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_parallel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_pandapower
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.pandapower_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;pandapower_helpers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pypowsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PyPowsybl
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_powsybl
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_powsybl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_powsybl_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_powsybl_analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers_polars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers_polars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_va_diff_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.update_basename_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.add_name_column_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_branch_results_polars
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblContingency
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblContingency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.is_basecase" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_basecase
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblMonitoredElements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblMonitoredElements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.trafo3w" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;trafo3w
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.switches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;switches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;buses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblNMinus1Definition
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblNMinus1Definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.model_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.monitored_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;monitored_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branch_limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.bus_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bus_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.element_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;element_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_propagation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_propagation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__getitem__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_contingency_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_contingency_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_monitored_elements_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_monitored_elements_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_branch_limits
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prepare_branch_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits--todo-decide-if-and-how-this-could-be-extended-to-other-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        TODO Decide if and how this could be extended to other limits.
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff_with_buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff_with_buses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_va_diff_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_busbar_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_busbar_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_nminus1_for_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_nminus1_for_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_regulating_element_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_regulating_element_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_node_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_branch_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_convergence_result_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_convergence_result_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.update_basename" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.add_name_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.set_target_values_to_lf_values_incl_distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_target_values_to_lf_values_incl_distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_full_nminus1_definition_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_full_nminus1_definition_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Grid Helpers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Grid Helpers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid_helpers/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid Helpers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_importer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_dc_solver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DC Solver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_topology_optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Topology Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_interfaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interfaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_grid_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid Helpers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ac-loadflow-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        AC Loadflow Service
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;ac_loadflow_service
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ac_loadflow_service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service.get_ac_loadflow_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_ac_loadflow_results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_energy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_energy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.count_critical_branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;count_critical_branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.get_worst_k_contingencies_ac" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_worst_k_contingencies_ac
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;kafka_client
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" kafka_client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LongRunningKafkaConsumer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LongRunningKafkaConsumer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;consumer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.client_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;client_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;assignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.last_msg" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;last_msg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.is_paused" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_paused
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consume" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;consume
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.poll" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.commit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;commit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.start_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;heartbeat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.stop_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.close" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lf_worker
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lf_worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.args" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;args
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LoadflowWorkerArgs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LoadflowWorkerArgs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.kafka_broker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;kafka_broker
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_command_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_command_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_results_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_results_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_heartbeat_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_heartbeat_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.heartbeat_interval_ms" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;heartbeat_interval_ms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.instance_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;instance_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.processed_gridfile_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;processed_gridfile_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_result_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_result_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.n_processes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_processes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.idle_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;idle_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.solver_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solver_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid_fs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid_fs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.main" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;main
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PandaPower
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_pandapower
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_pandapower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_single_outage" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_single_outage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.restore_elements_to_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;restore_elements_to_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.get_element_results_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_element_results_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.set_outaged_elements_out_of_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_outaged_elements_out_of_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_sequential" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_sequential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_parallel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_pandapower
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.pandapower_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;pandapower_helpers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pypowsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PyPowsybl
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_powsybl
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_powsybl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_powsybl_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_powsybl_analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers_polars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers_polars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_va_diff_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.update_basename_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.add_name_column_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_branch_results_polars
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblContingency
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblContingency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.is_basecase" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_basecase
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblMonitoredElements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblMonitoredElements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.trafo3w" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;trafo3w
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.switches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;switches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;buses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblNMinus1Definition
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblNMinus1Definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.model_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.monitored_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;monitored_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branch_limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.bus_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bus_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.element_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;element_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_propagation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_propagation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__getitem__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_contingency_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_contingency_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_monitored_elements_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_monitored_elements_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_branch_limits
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prepare_branch_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits--todo-decide-if-and-how-this-could-be-extended-to-other-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        TODO Decide if and how this could be extended to other limits.
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff_with_buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff_with_buses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_va_diff_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_busbar_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_busbar_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_nminus1_for_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_nminus1_for_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_regulating_element_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_regulating_element_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_node_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_branch_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_convergence_result_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_convergence_result_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.update_basename" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.add_name_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.set_target_values_to_lf_values_incl_distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_target_values_to_lf_values_incl_distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_full_nminus1_definition_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_full_nminus1_definition_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contingency Analysis
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contingency_analysis/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" checked>
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_importer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_dc_solver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DC Solver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_topology_optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Topology Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_interfaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interfaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_grid_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grid Helpers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Contingency Analysis
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ac-loadflow-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        AC Loadflow Service
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;ac_loadflow_service
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ac_loadflow_service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service.get_ac_loadflow_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_ac_loadflow_results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_energy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_energy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.count_critical_branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;count_critical_branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.get_worst_k_contingencies_ac" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_worst_k_contingencies_ac
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;kafka_client
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" kafka_client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LongRunningKafkaConsumer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LongRunningKafkaConsumer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;consumer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.client_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;client_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;assignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.last_msg" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;last_msg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.is_paused" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_paused
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consume" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;consume
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.poll" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.commit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;commit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.start_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;heartbeat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.stop_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.close" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lf_worker
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lf_worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.args" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;args
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LoadflowWorkerArgs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LoadflowWorkerArgs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.kafka_broker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;kafka_broker
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_command_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_command_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_results_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_results_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_heartbeat_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_heartbeat_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.heartbeat_interval_ms" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;heartbeat_interval_ms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.instance_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;instance_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.processed_gridfile_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;processed_gridfile_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_result_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_result_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.n_processes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_processes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.idle_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;idle_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.solver_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solver_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid_fs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid_fs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.main" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;main
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PandaPower
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_pandapower
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_pandapower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_single_outage" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_single_outage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.restore_elements_to_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;restore_elements_to_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.get_element_results_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_element_results_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.set_outaged_elements_out_of_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_outaged_elements_out_of_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_sequential" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_sequential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_parallel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_pandapower
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.pandapower_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;pandapower_helpers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pypowsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PyPowsybl
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_powsybl
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_powsybl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_powsybl_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_powsybl_analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers_polars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers_polars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_va_diff_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.update_basename_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.add_name_column_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_branch_results_polars
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblContingency
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblContingency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.is_basecase" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_basecase
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblMonitoredElements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblMonitoredElements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.trafo3w" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;trafo3w
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.switches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;switches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;buses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblNMinus1Definition
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblNMinus1Definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.model_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.monitored_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;monitored_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branch_limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.bus_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bus_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.element_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;element_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_propagation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_propagation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__getitem__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_contingency_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_contingency_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_monitored_elements_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_monitored_elements_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_branch_limits
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prepare_branch_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits--todo-decide-if-and-how-this-could-be-extended-to-other-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        TODO Decide if and how this could be extended to other limits.
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff_with_buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff_with_buses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_va_diff_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_busbar_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_busbar_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_nminus1_for_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_nminus1_for_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_regulating_element_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_regulating_element_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_node_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_branch_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_convergence_result_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_convergence_result_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.update_basename" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.add_name_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.set_target_values_to_lf_values_incl_distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_target_values_to_lf_values_incl_distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_full_nminus1_definition_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_full_nminus1_definition_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contribution_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contribution Guide
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Benchmark
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Benchmark
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_benchmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ac-loadflow-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        AC Loadflow Service
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;ac_loadflow_service
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ac_loadflow_service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service.get_ac_loadflow_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_ac_loadflow_results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" compute_metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_load" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_energy" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_overload_energy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.count_critical_branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;count_critical_branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_max_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.get_worst_k_contingencies_ac" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_worst_k_contingencies_ac
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;compute_metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;kafka_client
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" kafka_client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LongRunningKafkaConsumer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LongRunningKafkaConsumer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consumer" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;consumer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.client_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;client_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;assignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.last_msg" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;last_msg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.is_paused" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;is_paused
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consume" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;consume
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.poll" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;poll
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.commit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;commit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.start_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;heartbeat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.stop_processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.close" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;close
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;lf_worker
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" lf_worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.args" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;args
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;LoadflowWorkerArgs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" LoadflowWorkerArgs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.kafka_broker" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;kafka_broker
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_command_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_command_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_results_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_results_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_heartbeat_topic" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_heartbeat_topic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.heartbeat_interval_ms" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;heartbeat_interval_ms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.instance_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;instance_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.processed_gridfile_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;processed_gridfile_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_result_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;loadflow_result_folder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.n_processes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_processes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.idle_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;idle_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.solver_loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;solver_loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid_fs" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid_fs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;load_base_grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.main" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;main
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PandaPower
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_pandapower
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_pandapower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_single_outage" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_single_outage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.restore_elements_to_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;restore_elements_to_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.get_element_results_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_element_results_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.set_outaged_elements_out_of_service" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_outaged_elements_out_of_service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_sequential" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_sequential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_parallel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_pandapower" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_pandapower
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pandapower.pandapower_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;pandapower_helpers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contingency-analysis-pypowsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contingency Analysis PyPowsybl
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;contingency_analysis_powsybl
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" contingency_analysis_powsybl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_powsybl_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_powsybl_analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;run_contingency_analysis_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers_polars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers_polars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_va_diff_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.update_basename_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.add_name_column_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_node_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_node_results_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_branch_results_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_failed_branch_results_polars
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;powsybl_helpers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" powsybl_helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.POWSYBL_CONVERGENCE_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;POWSYBL_CONVERGENCE_MAP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblContingency
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblContingency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.is_basecase" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;is_basecase
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblMonitoredElements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblMonitoredElements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.branches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.trafo3w" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;trafo3w
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.switches" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;switches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;buses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;PowsyblNMinus1Definition
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" PowsyblNMinus1Definition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.model_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.monitored_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;monitored_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_elements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_elements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_contingencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;missing_contingencies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;branch_limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.bus_map" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;bus_map
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.element_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;element_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_name_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_name_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.voltage_levels" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;voltage_levels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_propagation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;contingency_propagation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__getitem__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_contingency_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_contingency_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_monitored_elements_to_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_monitored_elements_to_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_branch_limits
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prepare_branch_limits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits--todo-decide-if-and-how-this-could-be-extended-to-other-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        TODO Decide if and how this could be extended to other limits.
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff_with_buses" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_blank_va_diff_with_buses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_va_diff_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_va_diff_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_busbar_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_busbar_mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_nminus1_for_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;translate_nminus1_for_powsybl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_regulating_element_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_regulating_element_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_node_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_node_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_branch_results" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_branch_results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_convergence_result_df" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_convergence_result_df
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.update_basename" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_basename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.add_name_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;add_name_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.set_target_values_to_lf_values_incl_distributed_slack" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_target_values_to_lf_values_incl_distributed_slack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_full_nminus1_definition_powsybl" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_full_nminus1_definition_powsybl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/eliagroup/ToOp/edit/master/docs/references/reference_contingency_analysis.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="contingency-analysis">Contingency Analysis<a class="headerlink" href="#contingency-analysis" title="Permanent link">#</a></h1>
<h2 id="ac-loadflow-service">AC Loadflow Service<a class="headerlink" href="#ac-loadflow-service" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-module">



<h2 id="toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service" class="headerlink" title="Permanent link">#</a></h2>

    <div class="doc doc-contents first">

        <p>Get the results of the AC Contingency Analysis for the given network</p>










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service.get_ac_loadflow_results" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_ac_loadflow_results</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.ac_loadflow_service.get_ac_loadflow_results" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_ac_loadflow_results</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">n_minus_1_definition</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">timestep</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">job_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">n_processes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the results of the AC loadflow for the given network</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The network to run the contingency analysis on</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pp.pandapowerNet">pandapowerNet</span> | <span title="toop_engine_contingency_analysis.pypowsybl.network.Network">Network</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_minus_1_definition</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The N-1 definition to use for the contingency analysis. Contains outages and monitored elements</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            Nminus1Definition (toop_engine_interfaces.nminus1_definition.Nminus1Definition)" href="../reference_interfaces/#toop_engine_interfaces.nminus1_definition.Nminus1Definition">Nminus1Definition</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep of the results. Used to identify the results in the database</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The job id of the current job</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_processes</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.
If &gt; 1, the analysis is run in parallel
Paralelization is done by splitting the contingencies into chunks and running each chunk in a separate process</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The size of the batches to use for the parallelization.
This is ignored for Powsybl at the moment.
If None, the batch size is computed based on the number of contingencies and the number of processes.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Optional">Optional</span>[<span title="int">int</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="            LoadflowResultsPolars (toop_engine_interfaces.loadflow_results_polars.LoadflowResultsPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.LoadflowResultsPolars">LoadflowResultsPolars</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The results of the Contingency analysis</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="ValueError">ValueError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the network is not a PandapowerNetwork or PowsyblNetwork</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/ac_loadflow_service.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_ac_loadflow_results</span><span class="p">(</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">net</span><span class="p">:</span> <span class="n">PandapowerNetwork</span> <span class="o">|</span> <span class="n">PowsyblNetwork</span><span class="p">,</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">n_minus_1_definition</span><span class="p">:</span> <span class="n">Nminus1Definition</span><span class="p">,</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">n_processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoadflowResultsPolars</span><span class="p">:</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the results of the AC loadflow for the given network</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32"></a>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    ----------</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    net : pp.pandapowerNet | pypowsybl.network.Network</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        The network to run the contingency analysis on</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    n_minus_1_definition: Nminus1Definition</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        The N-1 definition to use for the contingency analysis. Contains outages and monitored elements</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    timestep: int, default=0</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        The timestep of the results. Used to identify the results in the database</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    job_id: str, default=&quot;&quot;</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        The job id of the current job</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    n_processes: int, default=1</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        If &gt; 1, the analysis is run in parallel</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        Paralelization is done by splitting the contingencies into chunks and running each chunk in a separate process</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    batch_size: int, optional</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        The size of the batches to use for the parallelization.</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        This is ignored for Powsybl at the moment.</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        If None, the batch size is computed based on the number of contingencies and the number of processes.</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Returns</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    -------</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    LoadflowResultsPolars</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        The results of the Contingency analysis</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    Raises</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    ------</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    ValueError</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        If the network is not a PandapowerNetwork or PowsyblNetwork</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">PandapowerNetwork</span><span class="p">):</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">lf_results</span> <span class="o">=</span> <span class="n">run_contingency_analysis_pandapower</span><span class="p">(</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>            <span class="n">n_minus_1_definition</span><span class="p">,</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a>            <span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a>            <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="n">n_processes</span><span class="o">=</span><span class="n">n_processes</span><span class="p">,</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a>            <span class="n">polars</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="p">)</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">PowsyblNetwork</span><span class="p">):</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">lf_results</span> <span class="o">=</span> <span class="n">run_contingency_analysis_powsybl</span><span class="p">(</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="n">n_minus_1_definition</span><span class="p">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="n">n_processes</span><span class="o">=</span><span class="n">n_processes</span><span class="p">,</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="n">polars</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="p">)</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;net must be a pandapowerNet or powsybl network&quot;</span><span class="p">)</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="k">return</span> <span class="n">lf_results</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics" class="headerlink" title="Permanent link">#</a></h2>

    <div class="doc doc-contents first">

        <p>Provides functions to compute the metrics directly from the results dataframes.</p>
<p>This is similar to jax.aggregate_results.py but straight on the results dataframes.</p>










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_column" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_overload_column</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_column" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">compute_overload_column</span><span class="p">(</span><span class="n">branch_results</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the overload column for further aggregation.</p>
<p>This is just a max operation</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>branch_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The branch results dataframe containing the loading information.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandera.typing.polars.LazyFrame">LazyFrame</span>[<a class="autorefs autorefs-internal" title="            BranchResultSchemaPolars (toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars">BranchResultSchemaPolars</a>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>field</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The field to use for the overload calculation, either "p" for power or "i" for current, by default "i".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="p">p</span>, <span title="i">i</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;i&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="branch_results_with_overload-:-patpl.lazyframe" open>
  <summary>branch_results_with_overload : patpl.LazyFrame</summary>
  <div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>The branch results dataframe with an additional &quot;overload&quot; column.
</code></pre></div></td></tr></table></div>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/compute_metrics.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="k">def</span><span class="w"> </span><span class="nf">compute_overload_column</span><span class="p">(</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">branch_results</span><span class="p">:</span> <span class="n">patpl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">[</span><span class="n">BranchResultSchemaPolars</span><span class="p">],</span> <span class="n">field</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;i&quot;</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">:</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the overload column for further aggregation.</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30"></a>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    This is just a max operation</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32"></a>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    ----------</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    branch_results : patpl.LazyFrame[BranchResultSchemaPolars]</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        The branch results dataframe containing the loading information.</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    field : Literal[&quot;p&quot;, &quot;i&quot;], optional</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        The field to use for the overload calculation, either &quot;p&quot; for power or &quot;i&quot; for current, by default &quot;i&quot;.</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39"></a>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    branch_results_with_overload : patpl.LazyFrame</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    -------</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        The branch results dataframe with an additional &quot;overload&quot; column.</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">branch_results_with_overload</span> <span class="o">=</span> <span class="n">branch_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="n">_val_max</span><span class="o">=</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">/</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;loading&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">abs</span><span class="p">(),</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="p">)</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">overload</span><span class="o">=</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;_val_max&quot;</span><span class="p">)),</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="p">)</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="k">return</span> <span class="n">branch_results_with_overload</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_max_load</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_load" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">compute_max_load</span><span class="p">(</span><span class="n">branch_results</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the highest loading of the branches in the results.</p>
<p>This is just a max operation</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>branch_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The branch results dataframe containing the loading information.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandera.typing.polars.LazyFrame">LazyFrame</span>[<a class="autorefs autorefs-internal" title="            BranchResultSchemaPolars (toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars">BranchResultSchemaPolars</a>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="float">float</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The maximum loading in factor of maximum rated current (percent / 100) of any branch in the results.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/compute_metrics.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="k">def</span><span class="w"> </span><span class="nf">compute_max_load</span><span class="p">(</span><span class="n">branch_results</span><span class="p">:</span> <span class="n">patpl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">[</span><span class="n">BranchResultSchemaPolars</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the highest loading of the branches in the results.</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    This is just a max operation</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    ----------</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    branch_results : patpl.LazyFrame[BranchResultSchemaPolars]</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        The branch results dataframe containing the loading information.</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    Returns</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    -------</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    float</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        The maximum loading in factor of maximum rated current (percent / 100) of any branch in the results.</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">max_loading</span> <span class="o">=</span> <span class="n">branch_results</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;loading&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">return</span> <span class="n">max_loading</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_energy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_overload_energy</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_overload_energy" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">compute_overload_energy</span><span class="p">(</span><span class="n">branch_results</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the maximum overload current of the branches in the results.</p>
<p>This is just a max operation</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>branch_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The branch results dataframe containing the loading information.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandera.typing.polars.LazyFrame">LazyFrame</span>[<a class="autorefs autorefs-internal" title="            BranchResultSchemaPolars (toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars">BranchResultSchemaPolars</a>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>field</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The field to use for the overload calculation, either "p" for power or "i" for current, by default "i".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="p">p</span>, <span title="i">i</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;i&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="float">float</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The maximum overload total current or power</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/compute_metrics.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="k">def</span><span class="w"> </span><span class="nf">compute_overload_energy</span><span class="p">(</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">branch_results</span><span class="p">:</span> <span class="n">patpl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">[</span><span class="n">BranchResultSchemaPolars</span><span class="p">],</span> <span class="n">field</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;i&quot;</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the maximum overload current of the branches in the results.</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    This is just a max operation</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    ----------</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    branch_results : patpl.LazyFrame[BranchResultSchemaPolars]</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        The branch results dataframe containing the loading information.</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    field : Literal[&quot;p&quot;, &quot;i&quot;], optional</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        The field to use for the overload calculation, either &quot;p&quot; for power or &quot;i&quot; for current, by default &quot;i&quot;.</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    Returns</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    -------</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    float</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        The maximum overload total current or power</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">branch_results_with_overload</span> <span class="o">=</span> <span class="n">compute_overload_column</span><span class="p">(</span><span class="n">branch_results</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">field</span><span class="p">)</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">overload</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="n">branch_results_with_overload</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;timestep&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span> <span class="s2">&quot;overload&quot;</span><span class="p">)</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="o">.</span><span class="n">drop_nulls</span><span class="p">()</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;overload&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="o">.</span><span class="n">group_by</span><span class="p">([</span><span class="s2">&quot;timestep&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">])</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;overload&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;overload&quot;</span><span class="p">))</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="o">.</span><span class="n">drop_nans</span><span class="p">(</span><span class="s2">&quot;overload&quot;</span><span class="p">)</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;overload&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="p">)</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="k">return</span> <span class="n">overload</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.count_critical_branches" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">count_critical_branches</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.count_critical_branches" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">count_critical_branches</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">branch_results</span><span class="p">,</span> <span class="n">critical_threshold</span><span class="o">=</span><span class="mf">1.0</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Count how many branches are above 100% in any side/contingency</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>branch_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The branch results dataframe containing the loading information.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandera.typing.polars.LazyFrame">LazyFrame</span>[<a class="autorefs autorefs-internal" title="            BranchResultSchemaPolars (toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars">BranchResultSchemaPolars</a>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>critical_threshold</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The loading threshold to consider a branch as critical, by default 1.0 (100%)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1.0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="int">int</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The number of branches that are overloaded in any side/contingency.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/compute_metrics.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="k">def</span><span class="w"> </span><span class="nf">count_critical_branches</span><span class="p">(</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">branch_results</span><span class="p">:</span> <span class="n">patpl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">[</span><span class="n">BranchResultSchemaPolars</span><span class="p">],</span> <span class="n">critical_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Count how many branches are above 100% in any side/contingency</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    ----------</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    branch_results : patpl.LazyFrame[BranchResultSchemaPolars]</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        The branch results dataframe containing the loading information.</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    critical_threshold : float, optional</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        The loading threshold to consider a branch as critical, by default 1.0 (100%)</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    Returns</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    -------</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    int</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        The number of branches that are overloaded in any side/contingency.</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="c1"># Do an any-aggregation across branch sides and contingencies (group by timestep/element)</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="c1"># This will return a boolean series with True for each branch that is overloaded in any contingency/side</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="c1"># Summing this will give the count of critical branches</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">branch_results</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;loading&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fill_nan</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">critical_threshold</span><span class="p">)</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;timestep&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">)</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">len</span><span class="p">())</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_va_diff" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_max_va_diff</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_max_va_diff" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">compute_max_va_diff</span><span class="p">(</span><span class="n">va_diff_results</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the maximum voltage angle difference.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>va_diff_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The voltage angle difference results dataframe.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandera.typing.polars.LazyFrame">LazyFrame</span>[<a class="autorefs autorefs-internal" title="            VADiffResultSchemaPolars (toop_engine_interfaces.loadflow_results_polars.VADiffResultSchemaPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.VADiffResultSchemaPolars">VADiffResultSchemaPolars</a>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="float">float</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The maximum voltage angle difference in degrees.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/compute_metrics.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="k">def</span><span class="w"> </span><span class="nf">compute_max_va_diff</span><span class="p">(</span><span class="n">va_diff_results</span><span class="p">:</span> <span class="n">patpl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">[</span><span class="n">VADiffResultSchemaPolars</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the maximum voltage angle difference.</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    ----------</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    va_diff_results : patpl.LazyFrame[VADiffResultSchemaPolars]</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        The voltage angle difference results dataframe.</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    Returns</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    -------</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    float</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        The maximum voltage angle difference in degrees.</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">max_va_diff</span> <span class="o">=</span> <span class="n">va_diff_results</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;va_diff&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">if</span> <span class="n">max_va_diff</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">max_va_diff</span><span class="p">):</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">max_va_diff</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.get_worst_k_contingencies_ac" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_worst_k_contingencies_ac</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.get_worst_k_contingencies_ac" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_worst_k_contingencies_ac</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">branch_results</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="n">base_case_id</span><span class="o">=</span><span class="s2">&quot;BASECASE&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the worst k contingencies based on overload energy.</p>
<p>If k is greater than the number of contingencies, all contingencies will be returned.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>branch_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The branch results dataframe containing the loading information.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="            BranchResultSchemaPolars (toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars">BranchResultSchemaPolars</a>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>k</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of worst contingencies to return, by default 10.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>10</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>field</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The field to use for the overload calculation, either "p" for power or "i" for current, by default "p".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="p">p</span>, <span title="i">i</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;p&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_case_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The contingency ID for the base case (N-0), by default "BASECASE".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;BASECASE&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="list">list</span>[<span title="list">list</span>[<span title="str">str</span>]], <span title="list">list</span>[<span title="float">float</span>]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A tuple containing:
- A list of lists with the contingency IDs for each timestep. The length of the outer list is
the number of timesteps while the inner lists contain the top k contingencies for that timestep.
- A list of total overload energy for each timestep. The length matches the number of timesteps.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/compute_metrics.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_worst_k_contingencies_ac</span><span class="p">(</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="n">branch_results</span><span class="p">:</span> <span class="n">patpl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">[</span><span class="n">BranchResultSchemaPolars</span><span class="p">],</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="n">field</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">base_case_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;BASECASE&quot;</span><span class="p">,</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the worst k contingencies based on overload energy.</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    If k is greater than the number of contingencies, all contingencies will be returned.</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    ----------</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    branch_results : DataFrame[BranchResultSchemaPolars]</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        The branch results dataframe containing the loading information.</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    k : int, optional</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        The number of worst contingencies to return, by default 10.</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    field : Literal[&quot;p&quot;, &quot;i&quot;], optional</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        The field to use for the overload calculation, either &quot;p&quot; for power or &quot;i&quot; for current, by default &quot;p&quot;.</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    base_case_id : str, optional</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        The contingency ID for the base case (N-0), by default &quot;BASECASE&quot;.</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    Returns</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    -------</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    tuple[list[list[str]], list[float]]</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        A tuple containing:</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        - A list of lists with the contingency IDs for each timestep. The length of the outer list is</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        the number of timesteps while the inner lists contain the top k contingencies for that timestep.</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        - A list of total overload energy for each timestep. The length matches the number of timesteps.</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="n">branch_results_with_overload</span> <span class="o">=</span> <span class="n">compute_overload_column</span><span class="p">(</span><span class="n">branch_results</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">field</span><span class="p">)</span><span class="o">.</span><span class="n">drop_nans</span><span class="p">(</span><span class="s2">&quot;overload&quot;</span><span class="p">)</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">overload</span> <span class="o">=</span> <span class="n">branch_results_with_overload</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;overload&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="n">overload_n1</span> <span class="o">=</span> <span class="n">overload</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">base_case_id</span><span class="p">)</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="c1"># Compute per (timestep, contingency) max overload using polars lazy API</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="n">overload_per_cont</span> <span class="o">=</span> <span class="n">overload_n1</span><span class="o">.</span><span class="n">group_by</span><span class="p">([</span><span class="s2">&quot;timestep&quot;</span><span class="p">,</span> <span class="s2">&quot;contingency&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;overload&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;overload&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">if</span> <span class="n">overload_per_cont</span><span class="o">.</span><span class="n">height</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="n">contingencies</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">overloads</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">overload_per_cont</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="s2">&quot;timestep&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">df_t</span> <span class="o">=</span> <span class="n">overload_per_cont</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;timestep&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;overload&quot;</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">cont_ids</span> <span class="o">=</span> <span class="n">df_t</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">contingencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cont_ids</span><span class="p">)</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="k">if</span> <span class="n">cont_ids</span><span class="p">:</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="n">br_results_top_k</span> <span class="o">=</span> <span class="n">branch_results</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_in</span><span class="p">(</span><span class="n">cont_ids</span><span class="p">))</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="n">overload_top_k</span> <span class="o">=</span> <span class="n">compute_overload_energy</span><span class="p">(</span><span class="n">br_results_top_k</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">field</span><span class="p">)</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="n">overload_top_k</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="n">overloads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">overload_top_k</span><span class="p">))</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="k">return</span> <span class="n">contingencies</span><span class="p">,</span> <span class="n">overloads</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_metrics" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">compute_metrics</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.compute_metrics.compute_metrics" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">compute_metrics</span><span class="p">(</span><span class="n">loadflow_results</span><span class="p">,</span> <span class="n">base_case_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the metrics from the loadflow results.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>loadflow_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The loadflow results containing the branch results.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            LoadflowResultsPolars (toop_engine_interfaces.loadflow_results_polars.LoadflowResultsPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.LoadflowResultsPolars">LoadflowResultsPolars</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_case_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The contingency ID for the base case (N-0). If not provided, no n-0 metrics will be computed.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Optional">Optional</span>[<span title="str">str</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span>[<a class="autorefs autorefs-internal" title="            MetricType


  
      module-attribute
   (toop_engine_interfaces.types.MetricType)" href="../reference_interfaces/#toop_engine_interfaces.types.MetricType">MetricType</a>, <span title="float">float</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A dictionary with the computed metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/compute_metrics.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="k">def</span><span class="w"> </span><span class="nf">compute_metrics</span><span class="p">(</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">loadflow_results</span><span class="p">:</span> <span class="n">LoadflowResultsPolars</span><span class="p">,</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">base_case_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">MetricType</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the metrics from the loadflow results.</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    ----------</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    loadflow_results : LoadflowResultsPolars</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        The loadflow results containing the branch results.</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    base_case_id : Optional[str], optional</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        The contingency ID for the base case (N-0). If not provided, no n-0 metrics will be computed.</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">    Returns</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    -------</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    dict[MetricType, float]</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        A dictionary with the computed metrics.</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="s2">&quot;max_flow_n_1&quot;</span><span class="p">:</span> <span class="n">compute_max_load</span><span class="p">(</span><span class="n">loadflow_results</span><span class="o">.</span><span class="n">branch_results</span><span class="p">),</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="s2">&quot;overload_energy_n_1&quot;</span><span class="p">:</span> <span class="n">compute_overload_energy</span><span class="p">(</span><span class="n">loadflow_results</span><span class="o">.</span><span class="n">branch_results</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">),</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="s2">&quot;max_va_diff_n_1&quot;</span><span class="p">:</span> <span class="n">compute_max_va_diff</span><span class="p">(</span><span class="n">loadflow_results</span><span class="o">.</span><span class="n">va_diff_results</span><span class="p">),</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="s2">&quot;overload_current_n_1&quot;</span><span class="p">:</span> <span class="n">compute_overload_energy</span><span class="p">(</span><span class="n">loadflow_results</span><span class="o">.</span><span class="n">branch_results</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="p">),</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="s2">&quot;critical_branch_count_n_1&quot;</span><span class="p">:</span> <span class="n">count_critical_branches</span><span class="p">(</span><span class="n">loadflow_results</span><span class="o">.</span><span class="n">branch_results</span><span class="p">),</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="p">}</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="k">if</span> <span class="n">base_case_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="c1"># Base case (N-0) results as Polars LazyFrames</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">n_0_branch_res</span> <span class="o">=</span> <span class="n">loadflow_results</span><span class="o">.</span><span class="n">branch_results</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">base_case_id</span><span class="p">)</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="c1"># Va diff may not contain the base case; filtering will yield an empty frame if absent.</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="c1"># compute_max_va_diff already returns 0.0 if empty/None, so no explicit fallback needed.</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">n_0_va_diff</span> <span class="o">=</span> <span class="n">loadflow_results</span><span class="o">.</span><span class="n">va_diff_results</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">base_case_id</span><span class="p">)</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">metrics</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="p">{</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="s2">&quot;max_flow_n_0&quot;</span><span class="p">:</span> <span class="n">compute_max_load</span><span class="p">(</span><span class="n">n_0_branch_res</span><span class="p">),</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>                <span class="s2">&quot;overload_energy_n_0&quot;</span><span class="p">:</span> <span class="n">compute_overload_energy</span><span class="p">(</span><span class="n">n_0_branch_res</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">),</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a>                <span class="s2">&quot;max_va_diff_n_0&quot;</span><span class="p">:</span> <span class="n">compute_max_va_diff</span><span class="p">(</span><span class="n">n_0_va_diff</span><span class="p">),</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a>                <span class="s2">&quot;overload_current_n_0&quot;</span><span class="p">:</span> <span class="n">compute_overload_energy</span><span class="p">(</span><span class="n">n_0_branch_res</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="p">),</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a>                <span class="s2">&quot;critical_branch_count_n_0&quot;</span><span class="p">:</span> <span class="n">count_critical_branches</span><span class="p">(</span><span class="n">n_0_branch_res</span><span class="p">),</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="p">}</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="p">)</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="k">return</span> <span class="n">metrics</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toop_engine_contingency_analysis.ac_loadflow_service.kafka_client</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client" class="headerlink" title="Permanent link">#</a></h2>

    <div class="doc doc-contents first">

        <p>Provides a wrapper around the confluent_kafka Consumer to allow long running processes.</p>
<p>There are fundamentally two ways how to deal with long running processes in kafka:
  - increase the max.poll.interval.ms to a very high value so the processing can happen in between.
  - pause the consumer while processing and resume it afterwards, regularly polling the paused consumer to reset the
  max.poll.interval.ms timeout. These polls will not consume any messages, but will reset the timeout.</p>
<p>The first method is not recommended as it inhibits rebalances during frozen time, does not detect frozen consumers and is
generally not what kafka was designed for. However, kafka does not provide a way to pause and resume a topic, only a
topic-partition. That means if a consumer is paused but then a rebalance happens, new topic-partitions will not be
paused and the consumer may receive messages for it. However, the polls we are doing are happening in the processing loop
and we are fundamentally unable to process anything there. Hence, this wrapper provides a way to pause and resume a consumer,
listening to the assignment changes and pausing or resuming the new TPs accordingly. As a drawback, this consumer then looses
the ability to consume multiple topics.</p>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.logger" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">logger</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.logger" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">logger</span> <span class="o">=</span> <span class="n"><span title="logbook.Logger">Logger</span></span><span class="p">(</span><span class="n"><span title="__name__">__name__</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-class">



<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">LongRunningKafkaConsumer</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">LongRunningKafkaConsumer</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">topic</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">bootstrap_servers</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">client_id</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">max_poll_interval_ms</span><span class="o">=</span><span class="mi">1800000</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">kafka_auth_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">



        <p>A kafka consumer for long running processes that need to pause and resume the topic consumption.</p>

        <p>Initialize the LongRunningKafkaConsumer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The topic to subscribe to. This can only be a single topic as the consumer will pause and resume it.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>group_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The consumer group id</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bootstrap_servers</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The bootstrap servers to connect to, e.g. "localhost:9092</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>client_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The client id to use for the consumer. This is used for logging and debugging purposes.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_poll_interval_ms</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The maximum time in milliseconds between polls before the consumer is considered dead. Defaults to 1_800_000
(30 minutes). Set this long enough so the process fits in with confidence.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1800000</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kafka_auth_config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Additional kafka authentication configuration to pass to the consumer. Defaults to None.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/kafka_client.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">bootstrap_servers</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">max_poll_interval_ms</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1_800_000</span><span class="p">,</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">kafka_auth_config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the LongRunningKafkaConsumer.</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    ----------</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    topic : str</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        The topic to subscribe to. This can only be a single topic as the consumer will pause and resume it.</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    group_id : str</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        The consumer group id</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    bootstrap_servers : str</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        The bootstrap servers to connect to, e.g. &quot;localhost:9092</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    client_id : str</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        The client id to use for the consumer. This is used for logging and debugging purposes.</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    max_poll_interval_ms : int, optional</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        The maximum time in milliseconds between polls before the consumer is considered dead. Defaults to 1_800_000</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        (30 minutes). Set this long enough so the process fits in with confidence.</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    kafka_auth_config : dict | None, optional</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        Additional kafka authentication configuration to pass to the consumer. Defaults to None.</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">topic</span> <span class="o">=</span> <span class="n">topic</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">consumer_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="s2">&quot;bootstrap.servers&quot;</span><span class="p">:</span> <span class="n">bootstrap_servers</span><span class="p">,</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="s2">&quot;group.id&quot;</span><span class="p">:</span> <span class="n">group_id</span><span class="p">,</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="s2">&quot;auto.offset.reset&quot;</span><span class="p">:</span> <span class="s2">&quot;earliest&quot;</span><span class="p">,</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="s2">&quot;enable.auto.commit&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="s2">&quot;client.id&quot;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="s2">&quot;max.poll.interval.ms&quot;</span><span class="p">:</span> <span class="n">max_poll_interval_ms</span><span class="p">,</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="s2">&quot;log_level&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="p">}</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">if</span> <span class="n">kafka_auth_config</span><span class="p">:</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">consumer_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kafka_auth_config</span><span class="p">)</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span> <span class="o">=</span> <span class="n">Consumer</span><span class="p">(</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">consumer_config</span><span class="p">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">logger</span><span class="o">=</span><span class="n">getLogger</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;consumer_</span><span class="si">{</span><span class="n">client_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="p">)</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="n">client_id</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assignment</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TopicPartition</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">topic</span><span class="p">],</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">on_assign</span><span class="o">=</span><span class="k">lambda</span> <span class="n">_consumer</span><span class="p">,</span> <span class="n">assignment</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_assignment</span><span class="p">(</span><span class="n">new_tps</span><span class="o">=</span><span class="n">assignment</span><span class="p">,</span> <span class="n">removed_tps</span><span class="o">=</span><span class="p">[]),</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">on_revoke</span><span class="o">=</span><span class="k">lambda</span> <span class="n">_consumer</span><span class="p">,</span> <span class="n">assignment</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_assignment</span><span class="p">(</span><span class="n">new_tps</span><span class="o">=</span><span class="p">[],</span> <span class="n">removed_tps</span><span class="o">=</span><span class="n">assignment</span><span class="p">),</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">on_lost</span><span class="o">=</span><span class="k">lambda</span> <span class="n">_consumer</span><span class="p">,</span> <span class="n">assignment</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_assignment</span><span class="p">(</span><span class="n">new_tps</span><span class="o">=</span><span class="p">[],</span> <span class="n">removed_tps</span><span class="o">=</span><span class="n">assignment</span><span class="p">),</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="p">)</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Message</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_paused</span> <span class="o">=</span> <span class="kc">False</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.topic" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">topic</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.topic" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">topic</span> <span class="o">=</span> <span class="n"><span title="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer(topic)">topic</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consumer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">consumer</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consumer" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">consumer</span> <span class="o">=</span> <span class="n"><span title="confluent_kafka.Consumer">Consumer</span></span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="consumer_config">consumer_config</span></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n"><span title="confluent_kafka.Consumer(logger)">logger</span></span><span class="o">=</span><span class="n"><span title="logging.getLogger">getLogger</span></span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;consumer_</span><span class="si">{</span><span class="n"><span title="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer(client_id)">client_id</span></span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.client_id" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">client_id</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.client_id" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">client_id</span> <span class="o">=</span> <span class="n"><span title="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer(client_id)">client_id</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.assignment" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">assignment</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.assignment" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">assignment</span> <span class="o">=</span> <span class="p">[]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.last_msg" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">last_msg</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.last_msg" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">last_msg</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.is_paused" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">is_paused</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.is_paused" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">is_paused</span> <span class="o">=</span> <span class="kc">False</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consume" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">consume</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.consume" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">consume</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">num_messages</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Consume a batch of messages from the kafka topic at once.</p>
<p>This will commit all offsets directly after consuming the messages.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The maximum time to wait for messages in seconds. If no messages are available, returns an empty list.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span> | <span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_messages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The maximum number of messages to consume. If more messages are available, they will not be consumed.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="list">list</span>[<span title="confluent_kafka.Message">Message</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The consumed messages, or an empty list if no messages are available within the timeout.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/kafka_client.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="k">def</span><span class="w"> </span><span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num_messages</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Message</span><span class="p">]:</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Consume a batch of messages from the kafka topic at once.</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    This will commit all offsets directly after consuming the messages.</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    ----------</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    timeout : float | int</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        The maximum time to wait for messages in seconds. If no messages are available, returns an empty list.</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    num_messages : int</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        The maximum number of messages to consume. If more messages are available, they will not be consumed.</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Returns</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    -------</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    list[Message]</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        The consumed messages, or an empty list if no messages are available within the timeout.</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Commit the last message either through commit or stop_processing before consuming again&quot;</span><span class="p">)</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">messages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">consume</span><span class="p">(</span><span class="n">num_messages</span><span class="o">=</span><span class="n">num_messages</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">timeout</span><span class="p">))</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">messages</span><span class="p">:</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="k">return</span> <span class="p">[]</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">messages</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">asynchronous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="k">return</span> <span class="n">messages</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.poll" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">poll</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.poll" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">poll</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Consume a single message from the Kafka topic.</p>
<p>This will not commit the offset to the broker</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The maximum time to wait for a message in seconds. If no message is available, returns None.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span> | <span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="beartype.typing.Optional">Optional</span>[<span title="confluent_kafka.Message">Message</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The consumed message, or None if no message is available within the timeout.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/kafka_client.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="k">def</span><span class="w"> </span><span class="nf">poll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Message</span><span class="p">]:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Consume a single message from the Kafka topic.</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    This will not commit the offset to the broker</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    ----------</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    timeout : float | int</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        The maximum time to wait for a message in seconds. If no message is available, returns None.</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Returns</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    -------</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    Optional[Message]</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        The consumed message, or None if no message is available within the timeout.</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Commit the last message either through commit or stop_processing before consuming again&quot;</span><span class="p">)</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">timeout</span><span class="p">))</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span> <span class="o">=</span> <span class="n">msg</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">return</span> <span class="n">msg</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.commit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">commit</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.commit" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">commit</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Commit the last consumed message.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/kafka_client.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="k">def</span><span class="w"> </span><span class="nf">commit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Commit the last consumed message.&quot;&quot;&quot;</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span><span class="p">,</span> <span class="n">asynchronous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No message to commit&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.start_processing" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">start_processing</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.start_processing" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">start_processing</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Start a long running process to consume the message.</p>
<p>This will internally pause the consumer. To not exceed the poll timeout, call heartbeat() periodically while
processing, e.g. every epoch</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/kafka_client.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="k">def</span><span class="w"> </span><span class="nf">start_processing</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Start a long running process to consume the message.</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    This will internally pause the consumer. To not exceed the poll timeout, call heartbeat() periodically while</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">    processing, e.g. every epoch</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_paused</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_update_assignment</span><span class="p">([],</span> <span class="p">[])</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.heartbeat" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">heartbeat</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.heartbeat" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">heartbeat</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Send a heartbeat to the kafka topic while processing to reset the max poll interval timeout.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/kafka_client.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="k">def</span><span class="w"> </span><span class="nf">heartbeat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Send a heartbeat to the kafka topic while processing to reset the max poll interval timeout.&quot;&quot;&quot;</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_paused</span><span class="p">:</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot send heartbeat while not processing&quot;</span><span class="p">)</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_update_assignment</span><span class="p">([],</span> <span class="p">[])</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="k">if</span> <span class="n">msg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Heartbeat should not consume messages&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.stop_processing" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">stop_processing</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.stop_processing" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">stop_processing</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Stop the long running process and commit the last message</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/kafka_client.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="k">def</span><span class="w"> </span><span class="nf">stop_processing</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop the long running process and commit the last message&quot;&quot;&quot;</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_paused</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_update_assignment</span><span class="p">([],</span> <span class="p">[])</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span><span class="p">:</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span><span class="p">,</span> <span class="n">asynchronous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.close" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">close</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.kafka_client.LongRunningKafkaConsumer.close" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">close</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Close the consumer and commit the last message if any.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/kafka_client.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Close the consumer and commit the last message if any.&quot;&quot;&quot;</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span><span class="p">:</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span><span class="p">,</span> <span class="n">asynchronous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_msg</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toop_engine_contingency_analysis.ac_loadflow_service.lf_worker</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker" class="headerlink" title="Permanent link">#</a></h2>

    <div class="doc doc-contents first">

        <p>Module contains functions for the kafka communication of the ac loadflow worker.</p>
<p>General Idea:
- The worker will listen for commands on the preprocessing  kafka topic
- Once the initial conversion is done, it runs an initial loadflow
- Once the optimiuation is done,
The command contains a path to the pandapower or powsybl grid file
The command contains the N-1 Definition</p>
<ul>
<li>The worker will load the grid file and the N-1 definition</li>
</ul>
<ul>
<li>The worker will run the N-1 analysis on the grid file with as many processes as possible</li>
<li>The worker will send the results to a kafka topic
    - ErrorResult, if anything goes wrong
    - SuccessResult, if everything goes well even if loadflow fails
    - LoadflowStartedResult?
    # Use the LoadflowResultsClass as the result result</li>
<li>The worker will send a heartbeat to a kafka topic every X seconds</li>
</ul>
<p>Questions:
- Does it make sense to return the results in batches?
    - Faster results, but dont really tell the full story
- How to deal with grid updates?
    - Separate Service? (Load would be doubled)
- Passing the grid file as path valid?
    - Otherwise large files need to be passed as bytes
    which kafka supports but is not really intended</p>
<p>File: worker.py
Author:  Leonard Hilfrich
Created: 05/2024</p>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.logger" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">logger</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.logger" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">logger</span> <span class="o">=</span> <span class="n"><span title="logging.getLogger">getLogger</span></span><span class="p">(</span><span class="n"><span title="__name__">__name__</span></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.args" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">args</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.args" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">args</span> <span class="o">=</span> <span class="n"><span title="tyro.cli">cli</span></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="            LoadflowWorkerArgs


  
      dataclass
   (toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs)" href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs">LoadflowWorkerArgs</a></span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-class">



<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">LoadflowWorkerArgs</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">LoadflowWorkerArgs</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">kafka_broker</span><span class="o">=</span><span class="s2">&quot;localhost:9092&quot;</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">loadflow_command_topic</span><span class="o">=</span><span class="s2">&quot;loadflow_commands&quot;</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">loadflow_results_topic</span><span class="o">=</span><span class="s2">&quot;loadflow_results&quot;</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">loadflow_heartbeat_topic</span><span class="o">=</span><span class="s2">&quot;loadflow_heartbeat&quot;</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">heartbeat_interval_ms</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">instance_id</span><span class="o">=</span><span class="s2">&quot;loadflow_worker&quot;</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">processed_gridfile_folder</span><span class="o">=</span><span class="n"><span title="pathlib.Path">Path</span></span><span class="p">(</span><span class="s2">&quot;processed_gridfiles&quot;</span><span class="p">),</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">loadflow_result_folder</span><span class="o">=</span><span class="n"><span title="pathlib.Path">Path</span></span><span class="p">(</span><span class="s2">&quot;loadflow_results&quot;</span><span class="p">),</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">n_processes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">



        <p>Holds arguments which must be provided at the launch of the worker.</p>
<p>Contains arguments that static for each loadflow run.</p>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.kafka_broker" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">kafka_broker</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.kafka_broker" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">kafka_broker</span> <span class="o">=</span> <span class="s1">&#39;localhost:9092&#39;</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The Kafka broker to connect to.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_command_topic" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">loadflow_command_topic</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_command_topic" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">loadflow_command_topic</span> <span class="o">=</span> <span class="s1">&#39;loadflow_commands&#39;</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The Kafka topic to listen for commands on.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_results_topic" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">loadflow_results_topic</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_results_topic" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">loadflow_results_topic</span> <span class="o">=</span> <span class="s1">&#39;loadflow_results&#39;</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The topic to push results to.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_heartbeat_topic" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">loadflow_heartbeat_topic</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_heartbeat_topic" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">loadflow_heartbeat_topic</span> <span class="o">=</span> <span class="s1">&#39;loadflow_heartbeat&#39;</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The topic to push heartbeats to.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.heartbeat_interval_ms" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">heartbeat_interval_ms</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.heartbeat_interval_ms" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">heartbeat_interval_ms</span> <span class="o">=</span> <span class="mi">1000</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The interval in milliseconds to send heartbeats.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.instance_id" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">instance_id</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.instance_id" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">instance_id</span> <span class="o">=</span> <span class="s1">&#39;loadflow_worker&#39;</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The instance id of the worker, used to identify the worker in the logs.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.processed_gridfile_folder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">processed_gridfile_folder</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.processed_gridfile_folder" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">processed_gridfile_folder</span> <span class="o">=</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">(</span><span class="s1">&#39;processed_gridfiles&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>A folder where pre-processed grid files are stored - this should be a NFS share together with the backend and
optimizer.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_result_folder" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">loadflow_result_folder</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.loadflow_result_folder" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">loadflow_result_folder</span> <span class="o">=</span> <span class="n"><span title="pathlib.Path">Path</span></span><span class="p">(</span><span class="s1">&#39;loadflow_results&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>A folder where the loadflow results are stored - this should be a NFS share together with the backend and
optimizer.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.n_processes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">n_processes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.LoadflowWorkerArgs.n_processes" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">n_processes</span> <span class="o">=</span> <span class="mi">1</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The number of processes to use for the loadflow calculation. If 1, the analysis is run sequentially.
If &gt; 1, the analysis is run in parallel</p>

    </div>

</div>






  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.idle_loop" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">idle_loop</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.idle_loop" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">idle_loop</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">consumer</span><span class="p">,</span> <span class="n">send_heartbeat_fn</span><span class="p">,</span> <span class="n">heartbeat_interval_ms</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Start the idle loop of the worker.</p>
<p>This will be running when the worker is currently not preprocessing
This will wait until a StartCalculationCommand is received and return it. In case a
ShutdownCommand is received, the worker will exit with the exit code provided in the command.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>consumer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The initialized Kafka consumer to listen for commands on.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="Consumer">Consumer</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>send_heartbeat_fn</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A function to call when there were no messages received for a while.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="callable">callable</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>heartbeat_interval_ms</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The time to wait for a new command in milliseconds. If no command has been received, a
heartbeat will be sent and then the receiver will wait for commands again.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="StartOptimizationCommand">StartOptimizationCommand</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The start optimization command to start the optimization run with</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/lf_worker.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="k">def</span><span class="w"> </span><span class="nf">idle_loop</span><span class="p">(</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">consumer</span><span class="p">:</span> <span class="n">LongRunningKafkaConsumer</span><span class="p">,</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">send_heartbeat_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="kc">None</span><span class="p">],</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">heartbeat_interval_ms</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StartCalculationCommand</span><span class="p">:</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Start the idle loop of the worker.</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    This will be running when the worker is currently not preprocessing</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    This will wait until a StartCalculationCommand is received and return it. In case a</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    ShutdownCommand is received, the worker will exit with the exit code provided in the command.</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    ----------</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    consumer : Consumer</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        The initialized Kafka consumer to listen for commands on.</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    send_heartbeat_fn : callable</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        A function to call when there were no messages received for a while.</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    heartbeat_interval_ms : int</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        The time to wait for a new command in milliseconds. If no command has been received, a</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        heartbeat will be sent and then the receiver will wait for commands again.</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Returns</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    -------</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    StartOptimizationCommand</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        The start optimization command to start the optimization run with</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">send_heartbeat_fn</span><span class="p">()</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Entering idle loop&quot;</span><span class="p">)</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">message</span> <span class="o">=</span> <span class="n">consumer</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">heartbeat_interval_ms</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="c1"># Wait timeout exceeded</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">message</span><span class="p">:</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="n">send_heartbeat_fn</span><span class="p">()</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="k">continue</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">command</span> <span class="o">=</span> <span class="n">LoadflowServiceCommand</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">deserialize_message</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">value</span><span class="p">()))</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="n">StartCalculationCommand</span><span class="p">):</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="k">return</span> <span class="n">command</span><span class="o">.</span><span class="n">command</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="n">ShutdownCommand</span><span class="p">):</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="n">consumer</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="n">consumer</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">exit_code</span><span class="p">)</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="c1"># If we are here, we received a command that we do not know</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received unknown command, dropping: </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">consumer</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.solver_loop" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">solver_loop</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.solver_loop" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">solver_loop</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">command</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">producer</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">processed_grid_path</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">loadflow_solver_path</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">heartbeat_fn</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">instance_id</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">n_processes</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">results_topic</span><span class="p">,</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Start the solver loop of the worker.</p>
<p>This will be running when the worker is currently solving the loadflow
This will wait until a StartCalculationCommand is received and return it. In case a
ShutdownCommand is received, the worker will exit with the exit code provided in the command.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>command</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The command to start the optimization run with.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            StartCalculationCommand (toop_engine_interfaces.messages.lf_service.loadflow_commands.StartCalculationCommand)" href="../reference_interfaces/#toop_engine_interfaces.messages.lf_service.loadflow_commands.StartCalculationCommand">StartCalculationCommand</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>producer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The initialized Kafka producer to send results to.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="KafkaProducer">KafkaProducer</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>processed_grid_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The path to the pre-processed grid files. This is used to load the grid files.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pathlib.Path">Path</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loadflow_solver_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The path to the loadflow solver results. This is used to save the loadflow results.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pathlib.Path">Path</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>heartbeat_fn</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A function to call to send a heartbeat message to the kafka topic.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Callable">Callable</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>instance_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The instance id of the worker, used to identify the worker in the logs.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_processes</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of processes to use for the optimization run. If 1, the analysis is run sequentially.
If &gt; 1, the analysis is run in parallel
Paralelization is done by splitting the contingencies into chunks and running each chunk in a separate process</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>results_topic</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The topic to push results to.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/lf_worker.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="k">def</span><span class="w"> </span><span class="nf">solver_loop</span><span class="p">(</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">command</span><span class="p">:</span> <span class="n">StartCalculationCommand</span><span class="p">,</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="n">producer</span><span class="p">:</span> <span class="n">Producer</span><span class="p">,</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">processed_grid_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="n">loadflow_solver_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">heartbeat_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="n">instance_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">n_processes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="n">results_topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Start the solver loop of the worker.</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    This will be running when the worker is currently solving the loadflow</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    This will wait until a StartCalculationCommand is received and return it. In case a</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    ShutdownCommand is received, the worker will exit with the exit code provided in the command.</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    ----------</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    command : StartCalculationCommand</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        The command to start the optimization run with.</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    producer : KafkaProducer</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        The initialized Kafka producer to send results to.</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    processed_grid_path : Path</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        The path to the pre-processed grid files. This is used to load the grid files.</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    loadflow_solver_path : Path</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        The path to the loadflow solver results. This is used to save the loadflow results.</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    heartbeat_fn : Callable</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        A function to call to send a heartbeat message to the kafka topic.</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    instance_id : str</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        The instance id of the worker, used to identify the worker in the logs.</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    n_processes : int</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        The number of processes to use for the optimization run. If 1, the analysis is run sequentially.</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        If &gt; 1, the analysis is run in parallel</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Paralelization is done by splitting the contingencies into chunks and running each chunk in a separate process</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    results_topic : str</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        The topic to push results to.</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="n">dirfs</span> <span class="o">=</span> <span class="n">DirFileSystem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">loadflow_solver_path</span><span class="p">))</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">grid_data</span><span class="o">.</span><span class="n">n_1_definition</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No N-1 definition provided. This is currently not supported.&quot;</span><span class="p">)</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="n">n_minus_1_definition</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">grid_data</span><span class="o">.</span><span class="n">n_1_definition</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="n">producer</span><span class="o">.</span><span class="n">produce</span><span class="p">(</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="n">results_topic</span><span class="p">,</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>                <span class="n">value</span><span class="o">=</span><span class="n">serialize_message</span><span class="p">(</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>                    <span class="n">LoadflowBaseResult</span><span class="p">(</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>                        <span class="n">job_id</span><span class="o">=</span><span class="n">job</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>                        <span class="n">instance_id</span><span class="o">=</span><span class="n">instance_id</span><span class="p">,</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>                        <span class="n">loadflow_id</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">loadflow_id</span><span class="p">,</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>                        <span class="n">runtime</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a>                        <span class="n">result</span><span class="o">=</span><span class="n">LoadflowStartedResult</span><span class="p">(),</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>                    <span class="p">)</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a>                <span class="p">),</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>                <span class="n">key</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">loadflow_id</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="p">)</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="n">job_loadflow_results_polars</span> <span class="o">=</span> <span class="n">LoadflowResultsPolars</span><span class="p">(</span><span class="n">job_id</span><span class="o">=</span><span class="n">job</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">grid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">grid_data</span><span class="o">.</span><span class="n">grid_files</span><span class="p">):</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a>                <span class="n">heartbeat_fn</span><span class="p">(</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a>                    <span class="n">command</span><span class="o">.</span><span class="n">loadflow_id</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loadflow Calculation run started for timestep </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a>                <span class="p">)</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a>                <span class="n">net</span> <span class="o">=</span> <span class="n">load_base_grid</span><span class="p">(</span><span class="n">processed_grid_path</span> <span class="o">/</span> <span class="n">grid</span><span class="p">,</span> <span class="n">command</span><span class="o">.</span><span class="n">grid_data</span><span class="o">.</span><span class="n">grid_type</span><span class="p">)</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a>                <span class="n">timestep_result_polars</span> <span class="o">=</span> <span class="n">get_ac_loadflow_results</span><span class="p">(</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>                    <span class="n">net</span><span class="o">=</span><span class="n">net</span><span class="p">,</span> <span class="n">n_minus_1_definition</span><span class="o">=</span><span class="n">n_minus_1_definition</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">job_id</span><span class="o">=</span><span class="n">job</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">n_processes</span><span class="o">=</span><span class="n">n_processes</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a>                <span class="p">)</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a>                <span class="n">job_loadflow_results_polars</span> <span class="o">=</span> <span class="n">concatenate_loadflow_results_polars</span><span class="p">(</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a>                    <span class="p">[</span><span class="n">job_loadflow_results_polars</span><span class="p">,</span> <span class="n">timestep_result_polars</span><span class="p">]</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a>                <span class="p">)</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>                <span class="n">ref</span> <span class="o">=</span> <span class="n">save_loadflow_results_polars</span><span class="p">(</span><span class="n">dirfs</span><span class="p">,</span> <span class="n">job</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">job_loadflow_results_polars</span><span class="p">)</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">grid_data</span><span class="o">.</span><span class="n">grid_files</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a>                    <span class="n">result_msg</span> <span class="o">=</span> <span class="n">LoadflowStreamResult</span><span class="p">(</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a>                        <span class="n">loadflow_reference</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a>                        <span class="n">solved_timesteps</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>                        <span class="n">remainging_timesteps</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">grid_data</span><span class="o">.</span><span class="n">grid_files</span><span class="p">))),</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>                    <span class="p">)</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>                    <span class="n">result_msg</span> <span class="o">=</span> <span class="n">LoadflowSuccessResult</span><span class="p">(</span><span class="n">loadflow_reference</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a>                <span class="n">producer</span><span class="o">.</span><span class="n">produce</span><span class="p">(</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a>                    <span class="n">topic</span><span class="o">=</span><span class="n">results_topic</span><span class="p">,</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a>                    <span class="n">value</span><span class="o">=</span><span class="n">serialize_message</span><span class="p">(</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>                        <span class="n">LoadflowBaseResult</span><span class="p">(</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>                            <span class="n">job_id</span><span class="o">=</span><span class="n">job</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>                            <span class="n">loadflow_id</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">loadflow_id</span><span class="p">,</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>                            <span class="n">instance_id</span><span class="o">=</span><span class="n">instance_id</span><span class="p">,</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>                            <span class="n">runtime</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a>                            <span class="n">result</span><span class="o">=</span><span class="n">result_msg</span><span class="p">,</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a>                        <span class="p">)</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a>                    <span class="p">),</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a>                    <span class="n">key</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">loadflow_id</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a>                <span class="p">)</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error while processing </span><span class="si">{</span><span class="n">command</span><span class="o">.</span><span class="n">loadflow_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="n">producer</span><span class="o">.</span><span class="n">produce</span><span class="p">(</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="n">topic</span><span class="o">=</span><span class="n">results_topic</span><span class="p">,</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">value</span><span class="o">=</span><span class="n">serialize_message</span><span class="p">(</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>                <span class="n">LoadflowBaseResult</span><span class="p">(</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a>                    <span class="n">job_id</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">loadflow_id</span><span class="p">,</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a>                    <span class="n">instance_id</span><span class="o">=</span><span class="n">instance_id</span><span class="p">,</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a>                    <span class="n">loadflow_id</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">loadflow_id</span><span class="p">,</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a>                    <span class="n">runtime</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a>                    <span class="n">result</span><span class="o">=</span><span class="n">ErrorResult</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)),</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a>                <span class="p">)</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="p">),</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="n">key</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">loadflow_id</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid_fs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">load_base_grid_fs</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid_fs" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_base_grid_fs</span><span class="p">(</span><span class="n">filesystem</span><span class="p">,</span> <span class="n">grid_path</span><span class="p">,</span> <span class="n">grid_type</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load the base grid from the grid file.</p>
<p>Force loading pandapower if grid type is pandapower, otherwise load powsybl.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filesystem</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The filesystem to load the grid from</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="fsspec.AbstractFileSystem">AbstractFileSystem</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>grid_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The grid to load</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pathlib.Path">Path</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>grid_type</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The type of the grid, either "pandapower", "powsybl", "ucte" or "cgmes".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="pandapower">pandapower</span>, <span title="powsybl">powsybl</span>, <span title="ucte">ucte</span>, <span title="cgmes">cgmes</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="PandapowerNet">PandapowerNet</span> | <span title="pypowsybl.network.Network">Network</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded grid</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="ValueError">ValueError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the grid type is not supported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/lf_worker.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_base_grid_fs</span><span class="p">(</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="n">filesystem</span><span class="p">:</span> <span class="n">AbstractFileSystem</span><span class="p">,</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="n">grid_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="n">grid_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;pandapower&quot;</span><span class="p">,</span> <span class="s2">&quot;powsybl&quot;</span><span class="p">,</span> <span class="s2">&quot;ucte&quot;</span><span class="p">,</span> <span class="s2">&quot;cgmes&quot;</span><span class="p">],</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandapower</span><span class="o">.</span><span class="n">pandapowerNet</span> <span class="o">|</span> <span class="n">Network</span><span class="p">:</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the base grid from the grid file.</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">    Force loading pandapower if grid type is pandapower, otherwise load powsybl.</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    ----------</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    filesystem : AbstractFileSystem</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        The filesystem to load the grid from</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    grid_path : Path</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        The grid to load</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    grid_type: Literal[&quot;pandapower&quot;, &quot;powsybl&quot;, &quot;ucte&quot;, &quot;cgmes&quot;]</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        The type of the grid, either &quot;pandapower&quot;, &quot;powsybl&quot;, &quot;ucte&quot; or &quot;cgmes&quot;.</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">    Returns</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    -------</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">    PandapowerNet | Network</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        The loaded grid</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    Raises</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    ------</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    ValueError</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        If the grid type is not supported.</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="k">if</span> <span class="n">grid_type</span> <span class="o">==</span> <span class="s2">&quot;pandapower&quot;</span><span class="p">:</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="k">return</span> <span class="n">load_pandapower_from_fs</span><span class="p">(</span><span class="n">filesystem</span><span class="p">,</span> <span class="n">grid_path</span><span class="p">)</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="k">if</span> <span class="n">grid_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;powsybl&quot;</span><span class="p">,</span> <span class="s2">&quot;ucte&quot;</span><span class="p">,</span> <span class="s2">&quot;cgmes&quot;</span><span class="p">]:</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="k">return</span> <span class="n">load_powsybl_from_fs</span><span class="p">(</span><span class="n">filesystem</span><span class="p">,</span> <span class="n">grid_path</span><span class="p">)</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown grid type: </span><span class="si">{</span><span class="n">grid_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">load_base_grid</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.load_base_grid" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_base_grid</span><span class="p">(</span><span class="n">grid_path</span><span class="p">,</span> <span class="n">grid_type</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Load the base grid from the grid file.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>grid_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The grid to load</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pathlib.Path">Path</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>grid_type</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The type of the grid, either "pandapower", "powsybl", "ucte" or "cgmes".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="pandapower">pandapower</span>, <span title="powsybl">powsybl</span>, <span title="ucte">ucte</span>, <span title="cgmes">cgmes</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="PandapowerNet">PandapowerNet</span> | <span title="pypowsybl.network.Network">Network</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The loaded grid</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="ValueError">ValueError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the grid type is not supported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/lf_worker.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_base_grid</span><span class="p">(</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="n">grid_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">grid_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;pandapower&quot;</span><span class="p">,</span> <span class="s2">&quot;powsybl&quot;</span><span class="p">,</span> <span class="s2">&quot;ucte&quot;</span><span class="p">,</span> <span class="s2">&quot;cgmes&quot;</span><span class="p">]</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandapower</span><span class="o">.</span><span class="n">pandapowerNet</span> <span class="o">|</span> <span class="n">Network</span><span class="p">:</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the base grid from the grid file.</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">    ----------</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    grid_path : Path</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        The grid to load</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    grid_type: Literal[&quot;pandapower&quot;, &quot;powsybl&quot;, &quot;ucte&quot;, &quot;cgmes&quot;]</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        The type of the grid, either &quot;pandapower&quot;, &quot;powsybl&quot;, &quot;ucte&quot; or &quot;cgmes&quot;.</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    Returns</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">    -------</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    PandapowerNet | Network</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        The loaded grid</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    Raises</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    ------</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    ValueError</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        If the grid type is not supported.</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="k">return</span> <span class="n">load_base_grid_fs</span><span class="p">(</span><span class="n">LocalFileSystem</span><span class="p">(),</span> <span class="n">grid_path</span><span class="p">,</span> <span class="n">grid_type</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.main" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">main</span>


<a href="#toop_engine_contingency_analysis.ac_loadflow_service.lf_worker.main" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Start main function of the worker.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/ac_loadflow_service/lf_worker.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">LoadflowWorkerArgs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Start main function of the worker.&quot;&quot;&quot;</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting importer instance </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">instance_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="n">consumer</span> <span class="o">=</span> <span class="n">LongRunningKafkaConsumer</span><span class="p">(</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="n">topic</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">loadflow_command_topic</span><span class="p">,</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="n">group_id</span><span class="o">=</span><span class="s2">&quot;loadflow-worker&quot;</span><span class="p">,</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="n">bootstrap_servers</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">kafka_broker</span><span class="p">,</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="n">client_id</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">instance_id</span><span class="p">,</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="p">)</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="n">producer</span> <span class="o">=</span> <span class="n">Producer</span><span class="p">(</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="p">{</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="s2">&quot;bootstrap.servers&quot;</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">kafka_broker</span><span class="p">,</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="s2">&quot;client.id&quot;</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">instance_id</span><span class="p">,</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="s2">&quot;log_level&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="p">},</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="p">)</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">heartbeat_idle</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="n">producer</span><span class="o">.</span><span class="n">produce</span><span class="p">(</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="n">args</span><span class="o">.</span><span class="n">loadflow_heartbeat_topic</span><span class="p">,</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="n">value</span><span class="o">=</span><span class="n">serialize_message</span><span class="p">(</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a>                <span class="n">LoadflowHeartbeat</span><span class="p">(</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a>                    <span class="n">idle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a>                    <span class="n">status_info</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a>                <span class="p">)</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="p">),</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="n">key</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">instance_id</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="p">)</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">producer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">heartbeat_fn</span><span class="p">(</span><span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">runtime</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="n">producer</span><span class="o">.</span><span class="n">produce</span><span class="p">(</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="n">args</span><span class="o">.</span><span class="n">loadflow_heartbeat_topic</span><span class="p">,</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="n">value</span><span class="o">=</span><span class="n">serialize_message</span><span class="p">(</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="n">LoadflowHeartbeat</span><span class="p">(</span>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a>                    <span class="n">idle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a>                    <span class="n">status_info</span><span class="o">=</span><span class="n">LoadflowStatusInfo</span><span class="p">(</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a>                        <span class="n">loadflow_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a>                        <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">,</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a>                        <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a>                    <span class="p">),</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a>                <span class="p">)</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="p">),</span>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="n">key</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">instance_id</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="p">)</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="n">producer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="n">consumer</span><span class="o">.</span><span class="n">heartbeat</span><span class="p">()</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="n">command</span> <span class="o">=</span> <span class="n">idle_loop</span><span class="p">(</span>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="n">consumer</span><span class="o">=</span><span class="n">consumer</span><span class="p">,</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="n">send_heartbeat_fn</span><span class="o">=</span><span class="n">heartbeat_idle</span><span class="p">,</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="n">heartbeat_interval_ms</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">heartbeat_interval_ms</span><span class="p">,</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="p">)</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="n">consumer</span><span class="o">.</span><span class="n">start_processing</span><span class="p">()</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="n">solver_loop</span><span class="p">(</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="n">producer</span><span class="o">=</span><span class="n">producer</span><span class="p">,</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="n">processed_grid_path</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">processed_gridfile_folder</span><span class="p">,</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a>            <span class="n">loadflow_solver_path</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">loadflow_result_folder</span><span class="p">,</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="n">heartbeat_fn</span><span class="o">=</span><span class="n">heartbeat_fn</span><span class="p">,</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="n">instance_id</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">instance_id</span><span class="p">,</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="n">n_processes</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">n_processes</span><span class="p">,</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="n">results_topic</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">loadflow_results_topic</span><span class="p">,</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="p">)</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="n">producer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="n">consumer</span><span class="o">.</span><span class="n">stop_processing</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="contingency-analysis-pandapower">Contingency Analysis PandaPower<a class="headerlink" href="#contingency-analysis-pandapower" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-module">



<h2 id="toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower</span>


<a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower" class="headerlink" title="Permanent link">#</a></h2>

    <div class="doc doc-contents first">

        <p>Compute the N-1 AC/DC power flow for the pandapower network.</p>










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_single_outage" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">run_single_outage</span>


<a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_single_outage" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">run_single_outage</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">contingency</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">monitored_elements</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">runpp_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute a single outage for the given network</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The network to compute the outage for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandapower.pandapowerNet">pandapowerNet</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>contingency</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The contingency to compute the outage for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="toop_engine_contingency_analysis.pandapower.pandapower_helpers.PandapowerContingency">PandapowerContingency</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_elements</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The elements to monitor during the outage</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandera.typing.DataFrame">DataFrame</span>[<span title="toop_engine_contingency_analysis.pandapower.pandapower_helpers.PandapowerMonitoredElementSchema">PandapowerMonitoredElementSchema</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep of the results</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The job id of the current job</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The method to use for the loadflow. Either "ac" or "dc"</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="ac">ac</span>, <span title="dc">dc</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runpp_kwargs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to runpp/rundcpp functions, by default None</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="            LoadflowResults (toop_engine_interfaces.loadflow_results.LoadflowResults)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.LoadflowResults">LoadflowResults</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The results of the ContingencyAnalysis computation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pandapower/contingency_analysis_pandapower.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_single_outage</span><span class="p">(</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">net</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">pandapowerNet</span><span class="p">,</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">contingency</span><span class="p">:</span> <span class="n">PandapowerContingency</span><span class="p">,</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">monitored_elements</span><span class="p">:</span> <span class="n">pat</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">PandapowerMonitoredElementSchema</span><span class="p">],</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">],</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">runpp_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoadflowResults</span><span class="p">:</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a single outage for the given network</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    ----------</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    net : pp.pandapowerNet</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        The network to compute the outage for</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    contingency: PandapowerContingency,</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        The contingency to compute the outage for</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    monitored_elements: pat.DataFrame[PandapowerMonitoredElementSchema],</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        The elements to monitor during the outage</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        The timestep of the results</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    job_id : str</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        The job id of the current job</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    method : Literal[&quot;ac&quot;, &quot;dc&quot;]</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        The method to use for the loadflow. Either &quot;ac&quot; or &quot;dc&quot;</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    runpp_kwargs : Optional[dict], optional</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        Additional keyword arguments to pass to runpp/rundcpp functions, by default None</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    Returns</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    -------</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    LoadflowResults</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        The results of the ContingencyAnalysis computation</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">outaged_elements</span> <span class="o">=</span> <span class="n">contingency</span><span class="o">.</span><span class="n">elements</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">were_in_service</span> <span class="o">=</span> <span class="n">set_outaged_elements_out_of_service</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">outaged_elements</span><span class="p">)</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">were_in_service</span><span class="p">):</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="c1"># If no elements were outaged, this is the base case and we should not run the loadflow</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="n">status</span> <span class="o">=</span> <span class="n">ConvergenceStatus</span><span class="o">.</span><span class="n">NO_CALCULATION</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">runpp_kwargs</span> <span class="o">=</span> <span class="n">runpp_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="n">pp</span><span class="o">.</span><span class="n">rundcpp</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="o">**</span><span class="n">runpp_kwargs</span><span class="p">)</span> <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;dc&quot;</span> <span class="k">else</span> <span class="n">pp</span><span class="o">.</span><span class="n">runpp</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="o">**</span><span class="n">runpp_kwargs</span><span class="p">)</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">ConvergenceStatus</span><span class="o">.</span><span class="n">CONVERGED</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">except</span> <span class="n">pp</span><span class="o">.</span><span class="n">LoadflowNotConverged</span><span class="p">:</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">ConvergenceStatus</span><span class="o">.</span><span class="n">FAILED</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">convergence_df</span> <span class="o">=</span> <span class="n">get_convergence_df</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span> <span class="n">contingency</span><span class="o">=</span><span class="n">contingency</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">regulating_elements_df</span> <span class="o">=</span> <span class="n">get_regulating_element_results</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">monitored_elements</span><span class="p">,</span> <span class="n">contingency</span><span class="p">)</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">branch_results_df</span><span class="p">,</span> <span class="n">node_results_df</span><span class="p">,</span> <span class="n">va_diff_results</span> <span class="o">=</span> <span class="n">get_element_results_df</span><span class="p">(</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">net</span><span class="p">,</span> <span class="n">contingency</span><span class="p">,</span> <span class="n">monitored_elements</span><span class="p">,</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">status</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="p">)</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">restore_elements_to_service</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">outaged_elements</span><span class="p">,</span> <span class="n">were_in_service</span><span class="p">)</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">element_name_map</span> <span class="o">=</span> <span class="n">monitored_elements</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="n">branch_results_df</span><span class="p">,</span> <span class="n">node_results_df</span><span class="p">,</span> <span class="n">regulating_elements_df</span><span class="p">,</span> <span class="n">va_diff_results</span><span class="p">]:</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">no_name_yet</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;element_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">no_name_yet</span><span class="p">,</span> <span class="s2">&quot;element_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">no_name_yet</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">element_name_map</span><span class="p">)</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;contingency_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">contingency</span><span class="o">.</span><span class="n">name</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">lf_result</span> <span class="o">=</span> <span class="n">LoadflowResults</span><span class="p">(</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">branch_results</span><span class="o">=</span><span class="n">branch_results_df</span><span class="p">,</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">node_results</span><span class="o">=</span><span class="n">node_results_df</span><span class="p">,</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">converged</span><span class="o">=</span><span class="n">convergence_df</span><span class="p">,</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">regulating_element_results</span><span class="o">=</span><span class="n">regulating_elements_df</span><span class="p">,</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">va_diff_results</span><span class="o">=</span><span class="n">va_diff_results</span><span class="p">,</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">warnings</span><span class="o">=</span><span class="p">[],</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="p">)</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="k">return</span> <span class="n">lf_result</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.restore_elements_to_service" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">restore_elements_to_service</span>


<a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.restore_elements_to_service" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">restore_elements_to_service</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">net</span><span class="p">,</span> <span class="n">outaged_elements</span><span class="p">,</span> <span class="n">were_in_service</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Restore the outaged elements to their original in_service status.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The pandapower network to restore the elements in</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandapower.pandapowerNet">pandapowerNet</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>outaged_elements</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The elements that were outaged</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="toop_engine_contingency_analysis.pandapower.pandapower_helpers.PandapowerElements">PandapowerElements</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>were_in_service</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A list indicating whether each element was in service before being set out of service</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="bool">bool</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pandapower/contingency_analysis_pandapower.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="k">def</span><span class="w"> </span><span class="nf">restore_elements_to_service</span><span class="p">(</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">net</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">pandapowerNet</span><span class="p">,</span> <span class="n">outaged_elements</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PandapowerElements</span><span class="p">],</span> <span class="n">were_in_service</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Restore the outaged elements to their original in_service status.</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    ----------</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    net : pp.pandapowerNet</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        The pandapower network to restore the elements in</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    outaged_elements : list[PandapowerElements]</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        The elements that were outaged</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    were_in_service : list[bool]</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        A list indicating whether each element was in service before being set out of service</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outaged_elements</span><span class="p">):</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="k">if</span> <span class="n">were_in_service</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="n">net</span><span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">table</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">table_id</span><span class="p">),</span> <span class="s2">&quot;in_service&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.get_element_results_df" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_element_results_df</span>


<a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.get_element_results_df" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_element_results_df</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">net</span><span class="p">,</span> <span class="n">contingency</span><span class="p">,</span> <span class="n">monitored_elements</span><span class="p">,</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">status</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the element results dataframes for the given contingency and monitored elements.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The pandapower network to get the results from</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandapower.pandapowerNet">pandapowerNet</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>contingency</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The contingency to get the results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="toop_engine_contingency_analysis.pandapower.pandapower_helpers.PandapowerContingency">PandapowerContingency</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_elements</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The monitored elements to get the results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandera.typing.DataFrame">DataFrame</span>[<span title="toop_engine_contingency_analysis.pandapower.pandapower_helpers.PandapowerMonitoredElementSchema">PandapowerMonitoredElementSchema</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep of the results</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>status</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The convergence status of the loadflow computation</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            ConvergenceStatus (toop_engine_interfaces.loadflow_results.ConvergenceStatus)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.ConvergenceStatus">ConvergenceStatus</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="pd.DataFrame">DataFrame</span>, <span title="pd.DataFrame">DataFrame</span>, <span title="pd.DataFrame">DataFrame</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The branch results dataframe, node results dataframe and va diff results dataframe</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pandapower/contingency_analysis_pandapower.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_element_results_df</span><span class="p">(</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">net</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">pandapowerNet</span><span class="p">,</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">contingency</span><span class="p">:</span> <span class="n">PandapowerContingency</span><span class="p">,</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">monitored_elements</span><span class="p">:</span> <span class="n">pat</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">PandapowerMonitoredElementSchema</span><span class="p">],</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">status</span><span class="p">:</span> <span class="n">ConvergenceStatus</span><span class="p">,</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pat</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">BranchResultSchema</span><span class="p">],</span> <span class="n">pat</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">NodeResultSchema</span><span class="p">],</span> <span class="n">pat</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">VADiffResultSchema</span><span class="p">]]:</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the element results dataframes for the given contingency and monitored elements.</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    ----------</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    net : pp.pandapowerNet</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        The pandapower network to get the results from</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    contingency : PandapowerContingency</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        The contingency to get the results for</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    monitored_elements : pat.DataFrame[PandapowerMonitoredElementSchema]</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        The monitored elements to get the results for</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        The timestep of the results</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    status : ConvergenceStatus</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        The convergence status of the loadflow computation</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    Returns</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    -------</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    tuple[pd.DataFrame, pd.DataFrame, pd.DataFrame]</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        The branch results dataframe, node results dataframe and va diff results dataframe</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">ConvergenceStatus</span><span class="o">.</span><span class="n">CONVERGED</span><span class="p">:</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">branch_results_df</span> <span class="o">=</span> <span class="n">get_branch_results</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">contingency</span><span class="p">,</span> <span class="n">monitored_elements</span><span class="p">,</span> <span class="n">timestep</span><span class="p">)</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">node_results_df</span> <span class="o">=</span> <span class="n">get_node_result_df</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">contingency</span><span class="p">,</span> <span class="n">monitored_elements</span><span class="p">,</span> <span class="n">timestep</span><span class="p">)</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">va_diff_results</span> <span class="o">=</span> <span class="n">get_va_diff_results</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">monitored_elements</span><span class="p">,</span> <span class="n">contingency</span><span class="p">)</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">monitored_trafo3w</span> <span class="o">=</span> <span class="n">monitored_elements</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;table == &#39;trafo3w&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">monitored_branches</span> <span class="o">=</span> <span class="n">monitored_elements</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;kind == &#39;branch&#39; &amp; table != &#39;trafo3w&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">monitored_buses</span> <span class="o">=</span> <span class="n">monitored_elements</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;kind == &#39;bus&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">branch_results_df</span> <span class="o">=</span> <span class="n">get_failed_branch_results</span><span class="p">(</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="n">timestep</span><span class="p">,</span> <span class="p">[</span><span class="n">contingency</span><span class="o">.</span><span class="n">unique_id</span><span class="p">],</span> <span class="n">monitored_branches</span><span class="p">,</span> <span class="n">monitored_trafo3w</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="p">)</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">node_results_df</span> <span class="o">=</span> <span class="n">get_failed_node_results</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span> <span class="p">[</span><span class="n">contingency</span><span class="o">.</span><span class="n">unique_id</span><span class="p">],</span> <span class="n">monitored_buses</span><span class="p">)</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">va_diff_results</span> <span class="o">=</span> <span class="n">get_failed_va_diff_results</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">monitored_elements</span><span class="p">,</span> <span class="n">contingency</span><span class="p">)</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="k">return</span> <span class="n">branch_results_df</span><span class="p">,</span> <span class="n">node_results_df</span><span class="p">,</span> <span class="n">va_diff_results</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.set_outaged_elements_out_of_service" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">set_outaged_elements_out_of_service</span>


<a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.set_outaged_elements_out_of_service" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">set_outaged_elements_out_of_service</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">outaged_elements</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the outaged elements in the network to out of service.</p>
<p>Returns info if the elements were in service before being set out of service.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The pandapower network to set the elements out of service in</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandapower.pandapowerNet">pandapowerNet</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>outaged_elements</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The elements to set out of service</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="toop_engine_contingency_analysis.pandapower.pandapower_helpers.PandapowerElements">PandapowerElements</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="list">list</span>[<span title="bool">bool</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A list indicating whether each element was in service before being set out of service</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pandapower/contingency_analysis_pandapower.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_outaged_elements_out_of_service</span><span class="p">(</span><span class="n">net</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">pandapowerNet</span><span class="p">,</span> <span class="n">outaged_elements</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PandapowerElements</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the outaged elements in the network to out of service.</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    Returns info if the elements were in service before being set out of service.</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    ----------</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    net : pp.pandapowerNet</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        The pandapower network to set the elements out of service in</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    outaged_elements : list[PandapowerElements]</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        The elements to set out of service</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    Returns</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    -------</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    list[bool]</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        A list indicating whether each element was in service before being set out of service</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="n">were_in_service</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outaged_elements</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="c1"># This is the base case. Append a dummy True so it does not raise due to no elements being outaged</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="n">were_in_service</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">outaged_elements</span><span class="p">:</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="n">was_in_service</span> <span class="o">=</span> <span class="n">net</span><span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">table</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">table_id</span><span class="p">,</span> <span class="s2">&quot;in_service&quot;</span><span class="p">]</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="n">were_in_service</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">was_in_service</span><span class="p">))</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="n">net</span><span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">table</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">table_id</span><span class="p">,</span> <span class="s2">&quot;in_service&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">return</span> <span class="n">were_in_service</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_sequential" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">run_contingency_analysis_sequential</span>


<a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_sequential" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">run_contingency_analysis_sequential</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">n_minus_1_definition</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">slack_allocation_config</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;dc&quot;</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">runpp_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute a full N-1 analysis for the given network, but a single timestep</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The network to compute the N-1 analysis for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandapower.pandapowerNet">pandapowerNet</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_minus_1_definition</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The N-1 definition to use for the analysis</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="toop_engine_contingency_analysis.pandapower.pandapower_helpers.PandapowerNMinus1Definition">PandapowerNMinus1Definition</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The job id of the current job</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep of the results</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slack_allocation_config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Precomputed configuration for slack allocation per island.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="toop_engine_contingency_analysis.pandapower.pandapower_helpers.SlackAllocationConfig">SlackAllocationConfig</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The method to use for the loadflow, by default "dc"</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="ac">ac</span>, <span title="dc">dc</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;dc&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runpp_kwargs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to runpp/rundcpp functions, by default None</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="            LoadflowResults (toop_engine_interfaces.loadflow_results.LoadflowResults)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.LoadflowResults">LoadflowResults</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A list of the results per contingency</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pandapower/contingency_analysis_pandapower.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_contingency_analysis_sequential</span><span class="p">(</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">net</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">pandapowerNet</span><span class="p">,</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="n">n_minus_1_definition</span><span class="p">:</span> <span class="n">PandapowerNMinus1Definition</span><span class="p">,</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">slack_allocation_config</span><span class="p">:</span> <span class="n">SlackAllocationConfig</span><span class="p">,</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dc&quot;</span><span class="p">,</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">runpp_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">LoadflowResults</span><span class="p">]:</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a full N-1 analysis for the given network, but a single timestep</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    ----------</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    net : pp.pandapowerNet</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        The network to compute the N-1 analysis for</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    n_minus_1_definition: PandapowerNMinus1Definition,</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        The N-1 definition to use for the analysis</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    job_id : str</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        The job id of the current job</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        The timestep of the results</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    slack_allocation_config : SlackAllocationConfig</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        Precomputed configuration for slack allocation per island.</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    method : Literal[&quot;ac&quot;, &quot;dc&quot;], optional</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        The method to use for the loadflow, by default &quot;dc&quot;</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    runpp_kwargs : Optional[dict], optional</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        Additional keyword arguments to pass to runpp/rundcpp functions, by default None</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    Returns</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    -------</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    list[LoadflowResults]</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        A list of the results per contingency</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">contingencies</span><span class="p">:</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">copy_net</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">elements_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">unique_id</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">contingency</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">removed_edges</span> <span class="o">=</span> <span class="n">assign_slack_per_island</span><span class="p">(</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="n">net</span><span class="o">=</span><span class="n">copy_net</span><span class="p">,</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="n">net_graph</span><span class="o">=</span><span class="n">slack_allocation_config</span><span class="o">.</span><span class="n">net_graph</span><span class="p">,</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="n">bus_lookup</span><span class="o">=</span><span class="n">slack_allocation_config</span><span class="o">.</span><span class="n">bus_lookup</span><span class="p">,</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="n">elements_ids</span><span class="o">=</span><span class="n">elements_ids</span><span class="p">,</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="n">min_island_size</span><span class="o">=</span><span class="n">slack_allocation_config</span><span class="o">.</span><span class="n">min_island_size</span><span class="p">,</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="p">)</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">single_res</span> <span class="o">=</span> <span class="n">run_single_outage</span><span class="p">(</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="n">net</span><span class="o">=</span><span class="n">copy_net</span><span class="p">,</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="n">contingency</span><span class="o">=</span><span class="n">contingency</span><span class="p">,</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="n">monitored_elements</span><span class="o">=</span><span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">monitored_elements</span><span class="p">,</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="n">runpp_kwargs</span><span class="o">=</span><span class="n">runpp_kwargs</span><span class="p">,</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="p">)</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">single_res</span><span class="p">)</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">slack_allocation_config</span><span class="o">.</span><span class="n">net_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">removed_edges</span><span class="p">)</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="k">return</span> <span class="n">results</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_parallel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">run_contingency_analysis_parallel</span>


<a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_parallel" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">run_contingency_analysis_parallel</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">n_minus_1_definition</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">slack_allocation_config</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;dc&quot;</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">n_processes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">runpp_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the N-1 AC/DC power flow for the network.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The pandapower network to compute the N-1 power flow for, with the topolgy already applied.
You can either pass the network directly or a ray.ObjectRef to the network (wrapped in a
list to avoid dereferencing the object).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandapower.pandapowerNet">pandapowerNet</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_minus_1_definition</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The N-1 definition to use for the analysis. Contains outages and monitored elements</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="toop_engine_contingency_analysis.pandapower.pandapower_helpers.PandapowerNMinus1Definition">PandapowerNMinus1Definition</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The job id of the current job</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep of the results</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slack_allocation_config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Precomputed configuration for slack allocation per island.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="toop_engine_contingency_analysis.pandapower.pandapower_helpers.SlackAllocationConfig">SlackAllocationConfig</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The method to use for the loadflow, by default "dc"</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="ac">ac</span>, <span title="dc">dc</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;dc&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_processes</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.
If &gt; 1, the analysis is run in parallel. Paralelization is done by splitting the contingencies into
chunks and running each chunk in a separate process</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The size of the batches to use for the parallelization. If None, the batch size is set to the number of
contingencies divided by the number of processes, rounded up. This is used to avoid too many handles in</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Optional">Optional</span>[<span title="int">int</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runpp_kwargs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to runpp/rundcpp functions, by default None</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="            LoadflowResults (toop_engine_interfaces.loadflow_results.LoadflowResults)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.LoadflowResults">LoadflowResults</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A list of the results per contingency</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pandapower/contingency_analysis_pandapower.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_contingency_analysis_parallel</span><span class="p">(</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="n">net</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">pandapowerNet</span><span class="p">,</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="n">n_minus_1_definition</span><span class="p">:</span> <span class="n">PandapowerNMinus1Definition</span><span class="p">,</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="n">slack_allocation_config</span><span class="p">:</span> <span class="n">SlackAllocationConfig</span><span class="p">,</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dc&quot;</span><span class="p">,</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">n_processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">runpp_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">LoadflowResults</span><span class="p">]:</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the N-1 AC/DC power flow for the network.</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">    ----------</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    net: pp.pandapowerNet,</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        The pandapower network to compute the N-1 power flow for, with the topolgy already applied.</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        You can either pass the network directly or a ray.ObjectRef to the network (wrapped in a</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        list to avoid dereferencing the object).</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    n_minus_1_definition: PandapowerNMinus1Definition,</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        The N-1 definition to use for the analysis. Contains outages and monitored elements</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    job_id : str</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        The job id of the current job</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        The timestep of the results</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    slack_allocation_config : SlackAllocationConfig</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        Precomputed configuration for slack allocation per island.</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    method : Literal[&quot;ac&quot;, &quot;dc&quot;], optional</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        The method to use for the loadflow, by default &quot;dc&quot;</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    n_processes : int, optional</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">        The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        If &gt; 1, the analysis is run in parallel. Paralelization is done by splitting the contingencies into</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        chunks and running each chunk in a separate process</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    batch_size : Optional[int]</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        The size of the batches to use for the parallelization. If None, the batch size is set to the number of</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        contingencies divided by the number of processes, rounded up. This is used to avoid too many handles in</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    runpp_kwargs : Optional[dict], optional</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        Additional keyword arguments to pass to runpp/rundcpp functions, by default None</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    Returns</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    -------</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    list[LoadflowResults]</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        A list of the results per contingency</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="n">n_outages</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">contingencies</span><span class="p">)</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="k">if</span> <span class="n">batch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_outages</span> <span class="o">/</span> <span class="n">n_processes</span><span class="p">)</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="n">work</span> <span class="o">=</span> <span class="p">[</span><span class="n">n_minus_1_definition</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_outages</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)]</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="c1"># Schedule work until the handle list is too long, then wait for the first result and continue</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">handles</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="n">result_lists</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="n">_compute_remote</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">run_contingency_analysis_sequential</span><span class="p">)</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">work</span><span class="p">:</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="n">_compute_remote</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a>                <span class="n">net</span><span class="o">=</span><span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a>                <span class="n">n_minus_1_definition</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a>                <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a>                <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a>                <span class="n">slack_allocation_config</span><span class="o">=</span><span class="n">slack_allocation_config</span><span class="p">,</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a>                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a>                <span class="n">runpp_kwargs</span><span class="o">=</span><span class="n">runpp_kwargs</span><span class="p">,</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="p">)</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="p">)</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">handles</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">n_processes</span><span class="p">:</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="c1"># Wait for the first result and continue</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="n">finished</span><span class="p">,</span> <span class="n">handles</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">num_returns</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="n">result_lists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">finished</span><span class="p">))</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="n">result_lists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">handles</span><span class="p">))</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="c1"># Sort the result_lists back into the original order</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="k">del</span> <span class="n">handles</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="c1"># Flatten the result_lists</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span> <span class="k">for</span> <span class="n">result_list</span> <span class="ow">in</span> <span class="n">result_lists</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">result_list</span><span class="p">]</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="k">return</span> <span class="n">results</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_pandapower" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">run_contingency_analysis_pandapower</span>


<a href="#toop_engine_contingency_analysis.pandapower.contingency_analysis_pandapower.run_contingency_analysis_pandapower" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">run_contingency_analysis_pandapower</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">n_minus_1_definition</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">min_island_size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">n_processes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">runpp_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">polars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the N-1 AC/DC power flow for the network.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The pandapower network to compute the N-1 power flow for, with the topology already applied.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandapower.pandapowerNet">pandapowerNet</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_minus_1_definition</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The N-1 definition to use for the analysis. Contains outages and monitored elements</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            Nminus1Definition (toop_engine_interfaces.nminus1_definition.Nminus1Definition)" href="../reference_interfaces/#toop_engine_interfaces.nminus1_definition.Nminus1Definition">Nminus1Definition</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The job id of the current job</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep of the results</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_island_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The minimum island size to consider</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>11</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The method to use for the loadflow, by default "ac"</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="ac">ac</span>, <span title="dc">dc</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;ac&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_processes</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.
If &gt; 1, the analysis is run in parallel. Paralelization is done by splitting the contingencies into
chunks and running each chunk in a separate process</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The size of the batches to use for the parallelization. If None, the batch size is set to the number of
contingencies divided by the number of processes, rounded up.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Optional">Optional</span>[<span title="int">int</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runpp_kwargs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to runpp/rundcpp functions, by default None</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>polars</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to return the results as a LoadflowResultsPolars object. If False, returns a LoadflowResults
object. Note that this only affects the type of the returned object, the computations are the same.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="beartype.typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="            LoadflowResults (toop_engine_interfaces.loadflow_results.LoadflowResults)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.LoadflowResults">LoadflowResults</a>, <a class="autorefs autorefs-internal" title="            LoadflowResultsPolars (toop_engine_interfaces.loadflow_results_polars.LoadflowResultsPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.LoadflowResultsPolars">LoadflowResultsPolars</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The results of the loadflow computation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pandapower/contingency_analysis_pandapower.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_contingency_analysis_pandapower</span><span class="p">(</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="n">net</span><span class="p">:</span> <span class="n">pp</span><span class="o">.</span><span class="n">pandapowerNet</span><span class="p">,</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="n">n_minus_1_definition</span><span class="p">:</span> <span class="n">Nminus1Definition</span><span class="p">,</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="n">min_island_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ac&quot;</span><span class="p">,</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="n">n_processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="n">runpp_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="n">polars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">LoadflowResults</span><span class="p">,</span> <span class="n">LoadflowResultsPolars</span><span class="p">]:</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the N-1 AC/DC power flow for the network.</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    ----------</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    net : pp.pandapowerNet</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        The pandapower network to compute the N-1 power flow for, with the topology already applied.</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">    n_minus_1_definition : Nminus1Definition</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        The N-1 definition to use for the analysis. Contains outages and monitored elements</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">    job_id : str</span>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">        The job id of the current job</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        The timestep of the results</span>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">    min_island_size: int</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        The minimum island size to consider</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    method : Literal[&quot;ac&quot;, &quot;dc&quot;], optional</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">        The method to use for the loadflow, by default &quot;ac&quot;</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    n_processes : int, optional</span>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">        The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.</span>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        If &gt; 1, the analysis is run in parallel. Paralelization is done by splitting the contingencies into</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">        chunks and running each chunk in a separate process</span>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">    batch_size : Optional[int]</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        The size of the batches to use for the parallelization. If None, the batch size is set to the number of</span>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        contingencies divided by the number of processes, rounded up.</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">    runpp_kwargs : Optional[dict], optional</span>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        Additional keyword arguments to pass to runpp/rundcpp functions, by default None</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">    polars: bool, default=False</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        Whether to return the results as a LoadflowResultsPolars object. If False, returns a LoadflowResults</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        object. Note that this only affects the type of the returned object, the computations are the same.</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">    Returns</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">    -------</span>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">    Union[LoadflowResults, LoadflowResultsPolars]</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        The results of the loadflow computation</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="n">pp_n1_definition</span> <span class="o">=</span> <span class="n">translate_nminus1_for_pandapower</span><span class="p">(</span><span class="n">n_minus_1_definition</span><span class="p">,</span> <span class="n">net</span><span class="p">)</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="n">net_graph</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="n">create_nxgraph</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="n">bus_lookup</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">create_bus_lookup_simple</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="n">slack_allocation_config</span> <span class="o">=</span> <span class="n">SlackAllocationConfig</span><span class="p">(</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="n">net_graph</span><span class="o">=</span><span class="n">net_graph</span><span class="p">,</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="n">bus_lookup</span><span class="o">=</span><span class="n">bus_lookup</span><span class="p">,</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="n">min_island_size</span><span class="o">=</span><span class="n">min_island_size</span><span class="p">,</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="p">)</span>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="k">if</span> <span class="n">n_processes</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">batch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="n">results</span> <span class="o">=</span> <span class="n">run_contingency_analysis_sequential</span><span class="p">(</span>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="n">net</span><span class="o">=</span><span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="n">n_minus_1_definition</span><span class="o">=</span><span class="n">pp_n1_definition</span><span class="p">,</span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="n">slack_allocation_config</span><span class="o">=</span><span class="n">slack_allocation_config</span><span class="p">,</span>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a>            <span class="n">runpp_kwargs</span><span class="o">=</span><span class="n">runpp_kwargs</span><span class="p">,</span>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="p">)</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="n">results</span> <span class="o">=</span> <span class="n">run_contingency_analysis_parallel</span><span class="p">(</span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="n">net</span><span class="o">=</span><span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="n">n_minus_1_definition</span><span class="o">=</span><span class="n">pp_n1_definition</span><span class="p">,</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a>            <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-427"><a id="__codelineno-0-427" name="__codelineno-0-427"></a>            <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-428"><a id="__codelineno-0-428" name="__codelineno-0-428"></a>            <span class="n">slack_allocation_config</span><span class="o">=</span><span class="n">slack_allocation_config</span><span class="p">,</span>
</span><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430"></a>            <span class="n">n_processes</span><span class="o">=</span><span class="n">n_processes</span><span class="p">,</span>
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432"></a>            <span class="n">runpp_kwargs</span><span class="o">=</span><span class="n">runpp_kwargs</span><span class="p">,</span>
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="p">)</span>
</span><span id="__span-0-434"><a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="n">lf_result</span> <span class="o">=</span> <span class="n">concatenate_loadflow_results</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435"></a>
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="n">missing_element_warnings</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="sa">f</span><span class="s2">&quot;Element with id </span><span class="si">{</span><span class="n">element</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> not found in the network.&quot;</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">pp_n1_definition</span><span class="o">.</span><span class="n">missing_elements</span>
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="p">]</span>
</span><span id="__span-0-439"><a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="n">missing_contingency_warnings</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-440"><a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="sa">f</span><span class="s2">&quot;Contingency with id </span><span class="si">{</span><span class="n">contingency</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> contains elements that are not found in the network.&quot;</span>
</span><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">pp_n1_definition</span><span class="o">.</span><span class="n">missing_contingencies</span>
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="p">]</span>
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="n">duplicated_id_warnings</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="sa">f</span><span class="s2">&quot;Element with id </span><span class="si">{</span><span class="n">element_id</span><span class="si">}</span><span class="s2"> is not unique in the grid.&quot;</span>
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="k">for</span> <span class="n">element_id</span> <span class="ow">in</span> <span class="n">pp_n1_definition</span><span class="o">.</span><span class="n">duplicated_grid_elements</span>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="p">]</span>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="n">lf_result</span><span class="o">.</span><span class="n">warnings</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="o">*</span><span class="n">duplicated_id_warnings</span><span class="p">,</span>
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="o">*</span><span class="n">missing_element_warnings</span><span class="p">,</span>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="o">*</span><span class="n">missing_contingency_warnings</span><span class="p">,</span>
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="o">*</span><span class="n">lf_result</span><span class="o">.</span><span class="n">warnings</span><span class="p">,</span>
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="p">]</span>
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">polars</span><span class="p">:</span>
</span><span id="__span-0-454"><a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="k">return</span> <span class="n">lf_result</span>
</span><span id="__span-0-455"><a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="k">return</span> <span class="n">convert_pandas_loadflow_results_to_polars</span><span class="p">(</span><span class="n">lf_result</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="toop_engine_contingency_analysis.pandapower.pandapower_helpers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toop_engine_contingency_analysis.pandapower.pandapower_helpers</span>


<a href="#toop_engine_contingency_analysis.pandapower.pandapower_helpers" class="headerlink" title="Permanent link">#</a></h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="contingency-analysis-pypowsybl">Contingency Analysis PyPowsybl<a class="headerlink" href="#contingency-analysis-pypowsybl" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-module">



<h2 id="toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl" class="headerlink" title="Permanent link">#</a></h2>

    <div class="doc doc-contents first">

        <p>Compute the N-1 AC/DC power flow for the network.</p>










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_powsybl_analysis" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">run_powsybl_analysis</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_powsybl_analysis" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">run_powsybl_analysis</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">net</span><span class="p">,</span> <span class="n">n_minus_1_definition</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="n">n_processes</span><span class="o">=</span><span class="mi">1</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Run the powsybl security analysis for the given network and N-1 definition.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The powsybl network to compute the Contingency Analysis for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pypowsybl.network.Network">Network</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_minus_1_definition</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The N-1 definition to use for the contingency analysis. Contains outages and monitored elements</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            Nminus1Definition (toop_engine_interfaces.nminus1_definition.Nminus1Definition)" href="../reference_interfaces/#toop_engine_interfaces.nminus1_definition.Nminus1Definition">Nminus1Definition</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The method to use for the contingency analysis. Either "ac" or "dc", by default "ac"</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="ac">ac</span>, <span title="dc">dc</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;ac&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_processes</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>res</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The security analysis result from powsybl containing the monitored elements and the results of the contingencies.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="pypowsybl.security.SecurityAnalysisResult">SecurityAnalysisResult</span></code>
                  </span>
                </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>basecase_id</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The name of the basecase contingency, if it is included in the run. Otherwise None.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | None</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/contingency_analysis_powsybl.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_powsybl_analysis</span><span class="p">(</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">net</span><span class="p">:</span> <span class="n">Network</span><span class="p">,</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">n_minus_1_definition</span><span class="p">:</span> <span class="n">PowsyblNMinus1Definition</span><span class="p">,</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ac&quot;</span><span class="p">,</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">n_processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">SecurityAnalysisResult</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run the powsybl security analysis for the given network and N-1 definition.</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    ----------</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    net : Network</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        The powsybl network to compute the Contingency Analysis for</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    n_minus_1_definition : Nminus1Definition</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        The N-1 definition to use for the contingency analysis. Contains outages and monitored elements</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    method : Literal[&quot;ac&quot;, &quot;dc&quot;], optional</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        The method to use for the contingency analysis. Either &quot;ac&quot; or &quot;dc&quot;, by default &quot;ac&quot;</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    n_processes : int, optional</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Returns</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    -------</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    res: SecurityAnalysisResult</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        The security analysis result from powsybl containing the monitored elements and the results of the contingencies.</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    basecase_id : str | None</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        The name of the basecase contingency, if it is included in the run. Otherwise None.</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="c1"># Run the actual loadflow computation</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">analysis</span> <span class="o">=</span> <span class="n">pypowsybl</span><span class="o">.</span><span class="n">security</span><span class="o">.</span><span class="n">create_analysis</span><span class="p">()</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">analysis</span><span class="o">.</span><span class="n">add_monitored_elements</span><span class="p">(</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">branch_ids</span><span class="o">=</span><span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">monitored_elements</span><span class="p">[</span><span class="s2">&quot;branches&quot;</span><span class="p">],</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">three_windings_transformer_ids</span><span class="o">=</span><span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">monitored_elements</span><span class="p">[</span><span class="s2">&quot;trafo3w&quot;</span><span class="p">],</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">voltage_level_ids</span><span class="o">=</span><span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">monitored_elements</span><span class="p">[</span><span class="s2">&quot;voltage_levels&quot;</span><span class="p">],</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="p">)</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">basecase_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">contingencies</span><span class="p">:</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">outages</span> <span class="o">=</span> <span class="n">contingency</span><span class="o">.</span><span class="n">elements</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outages</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a>            <span class="n">analysis</span><span class="o">.</span><span class="n">add_multiple_elements_contingency</span><span class="p">(</span><span class="n">outages</span><span class="p">,</span> <span class="n">contingency_id</span><span class="o">=</span><span class="n">contingency</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">outages</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="c1"># If there are no outages, we add the basecase contingency</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="n">basecase_id</span> <span class="o">=</span> <span class="n">contingency</span><span class="o">.</span><span class="n">id</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="n">analysis</span><span class="o">.</span><span class="n">add_single_element_contingency</span><span class="p">(</span><span class="n">outages</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">contingency_id</span><span class="o">=</span><span class="n">contingency</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;ac&quot;</span> <span class="ow">and</span> <span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">distributed_slack</span><span class="p">:</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="c1"># If we have distributed slack and AC loadflows, we need to set the slack to a single generator</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="c1"># This is done by setting the target values of the generators to the loadflow values</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">lf_params</span> <span class="o">=</span> <span class="n">DISTRIBUTED_SLACK</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="c1"># The security analysis in DC should always run with a single slack to avoid changing gen values for each N-1 case</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="c1"># This way it matches the current way our N-1 analysis in the GPU-solver is set up</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">lf_params</span> <span class="o">=</span> <span class="n">SINGLE_SLACK</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">contingency_propagation</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span> <span class="k">if</span> <span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">contingency_propagation</span> <span class="k">else</span> <span class="s2">&quot;false&quot;</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">security_params</span> <span class="o">=</span> <span class="n">pypowsybl</span><span class="o">.</span><span class="n">security</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">Parameters</span><span class="p">(</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="n">load_flow_parameters</span><span class="o">=</span><span class="n">lf_params</span><span class="p">,</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">provider_parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;threadCount&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_processes</span><span class="p">),</span> <span class="s2">&quot;contingencyPropagation&quot;</span><span class="p">:</span> <span class="n">contingency_propagation</span><span class="p">},</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="p">)</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">run_ac</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">security_params</span><span class="p">)</span> <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;ac&quot;</span> <span class="k">else</span> <span class="n">analysis</span><span class="o">.</span><span class="n">run_dc</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">security_params</span><span class="p">)</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">basecase_id</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_polars" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">run_contingency_analysis_polars</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_polars" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">run_contingency_analysis_polars</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">pow_n1_definition</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;dc&quot;</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">n_processes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the N-0 + N-1 power flow for the network.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The powsybl network to compute the Contingency Analysis for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pypowsybl.network.Network">Network</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pow_n1_definition</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The N-1 definition to use for the contingency analysis. Contains outages and monitored elements</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            PowsyblNMinus1Definition (toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition)" href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition">PowsyblNMinus1Definition</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The job id of the current job</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep to use for the contingency analysis</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to compute the AC or DC power flow, by default "dc"</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="ac">ac</span>, <span title="dc">dc</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;dc&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_processes</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.
If &gt; 1, the analysis is run in parallel
Paralelization is done by splitting the contingencies into chunks and running each chunk in a separate process
This is done via the openloadflow native threadCount parameter,
which is set in the powsybl security analysis parameters.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="            LoadflowResultsPolars (toop_engine_interfaces.loadflow_results_polars.LoadflowResultsPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.LoadflowResultsPolars">LoadflowResultsPolars</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The results of the loadflow computation. Invalid or otherwise failed results will be set to NaN.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/contingency_analysis_powsybl.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_contingency_analysis_polars</span><span class="p">(</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">net</span><span class="p">:</span> <span class="n">Network</span><span class="p">,</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">pow_n1_definition</span><span class="p">:</span> <span class="n">PowsyblNMinus1Definition</span><span class="p">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dc&quot;</span><span class="p">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">n_processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoadflowResultsPolars</span><span class="p">:</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the N-0 + N-1 power flow for the network.</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    ----------</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    net : Network</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        The powsybl network to compute the Contingency Analysis for</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    pow_n1_definition : PowsyblNMinus1Definition</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        The N-1 definition to use for the contingency analysis. Contains outages and monitored elements</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    job_id : str</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        The job id of the current job</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        The timestep to use for the contingency analysis</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    method : Literal[&quot;ac&quot;, &quot;dc&quot;], optional</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        Whether to compute the AC or DC power flow, by default &quot;dc&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    n_processes : int, optional</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        If &gt; 1, the analysis is run in parallel</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        Paralelization is done by splitting the contingencies into chunks and running each chunk in a separate process</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        This is done via the openloadflow native threadCount parameter,</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        which is set in the powsybl security analysis parameters.</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    Returns</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    -------</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    LoadflowResultsPolars</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        The results of the loadflow computation. Invalid or otherwise failed results will be set to NaN.</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">monitored_elements</span> <span class="o">=</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">monitored_elements</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">ca_result</span><span class="p">,</span> <span class="n">basecase_id</span> <span class="o">=</span> <span class="n">run_powsybl_analysis</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">pow_n1_definition</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">n_processes</span><span class="o">=</span><span class="n">n_processes</span><span class="p">)</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">bus_results</span> <span class="o">=</span> <span class="n">get_ca_bus_results</span><span class="p">(</span><span class="n">ca_result</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">branch_results</span> <span class="o">=</span> <span class="n">get_ca_branch_results</span><span class="p">(</span><span class="n">ca_result</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">three_windings_transformer_results</span> <span class="o">=</span> <span class="n">get_ca_three_windings_transformer_results</span><span class="p">(</span><span class="n">ca_result</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">post_contingency_results</span> <span class="o">=</span> <span class="n">ca_result</span><span class="o">.</span><span class="n">post_contingency_results</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">pre_contingency_result</span> <span class="o">=</span> <span class="n">ca_result</span><span class="o">.</span><span class="n">pre_contingency_result</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">all_outage_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">contingency</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">contingencies</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">contingency</span><span class="o">.</span><span class="n">is_basecase</span><span class="p">()]</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">convergence_df</span><span class="p">,</span> <span class="n">failed_outages</span> <span class="o">=</span> <span class="n">get_convergence_result_df</span><span class="p">(</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="n">post_contingency_results</span><span class="p">,</span> <span class="n">pre_contingency_result</span><span class="p">,</span> <span class="n">all_outage_ids</span><span class="p">,</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">basecase_id</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="p">)</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="n">add_name_column</span><span class="p">(</span><span class="n">convergence_df</span><span class="p">,</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">contingency_name_mapping</span><span class="p">,</span> <span class="n">index_level</span><span class="o">=</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="n">convergence_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">convergence_df</span><span class="p">,</span> <span class="n">include_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nan_to_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lazy</span><span class="p">()</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">branch_limit_polars</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">branch_limits</span><span class="p">,</span> <span class="n">include_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nan_to_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lazy</span><span class="p">()</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="n">branch_results_df</span> <span class="o">=</span> <span class="n">get_branch_results_polars</span><span class="p">(</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">branch_results</span><span class="p">,</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">three_windings_transformer_results</span><span class="p">,</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">monitored_elements</span><span class="p">[</span><span class="s2">&quot;branches&quot;</span><span class="p">],</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">monitored_elements</span><span class="p">[</span><span class="s2">&quot;trafo3w&quot;</span><span class="p">],</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="n">failed_outages</span><span class="p">,</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">branch_limit_polars</span><span class="p">,</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="p">)</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">node_results_df</span> <span class="o">=</span> <span class="n">get_node_results_polars</span><span class="p">(</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">bus_results</span><span class="p">,</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">monitored_elements</span><span class="p">[</span><span class="s2">&quot;buses&quot;</span><span class="p">],</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">bus_map</span><span class="p">,</span> <span class="n">include_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nan_to_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lazy</span><span class="p">(),</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">voltage_levels</span><span class="p">,</span> <span class="n">include_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nan_to_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lazy</span><span class="p">(),</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">failed_outages</span><span class="p">,</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="p">)</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">regulating_elements_df</span> <span class="o">=</span> <span class="n">get_regulating_element_results</span><span class="p">(</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">monitored_elements</span><span class="p">[</span><span class="s2">&quot;buses&quot;</span><span class="p">],</span> <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span> <span class="n">basecase_name</span><span class="o">=</span><span class="n">basecase_id</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="p">)</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="n">regulating_elements_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">regulating_elements_df</span><span class="p">,</span> <span class="n">include_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nan_to_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lazy</span><span class="p">()</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">va_diff_results_df</span> <span class="o">=</span> <span class="n">get_va_diff_results_polars</span><span class="p">(</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">bus_results</span><span class="o">=</span><span class="n">bus_results</span><span class="p">,</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">outages</span><span class="o">=</span><span class="n">all_outage_ids</span><span class="p">,</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">va_diff_with_buses</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">blank_va_diff</span><span class="p">,</span> <span class="n">include_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nan_to_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lazy</span><span class="p">(),</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">bus_map</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">bus_map</span><span class="p">,</span> <span class="n">include_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nan_to_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lazy</span><span class="p">(),</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="p">)</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="n">branch_results_df</span> <span class="o">=</span> <span class="n">update_basename_polars</span><span class="p">(</span><span class="n">branch_results_df</span><span class="p">,</span> <span class="n">basecase_id</span><span class="p">)</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="n">branch_results_df</span> <span class="o">=</span> <span class="n">add_name_column_polars</span><span class="p">(</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">branch_results_df</span><span class="p">,</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">element_name_mapping</span><span class="p">,</span> <span class="n">index_level</span><span class="o">=</span><span class="s2">&quot;element&quot;</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="p">)</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="n">branch_results_df</span> <span class="o">=</span> <span class="n">add_name_column_polars</span><span class="p">(</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">branch_results_df</span><span class="p">,</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">contingency_name_mapping</span><span class="p">,</span> <span class="n">index_level</span><span class="o">=</span><span class="s2">&quot;contingency&quot;</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="p">)</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">node_results_df</span> <span class="o">=</span> <span class="n">update_basename_polars</span><span class="p">(</span><span class="n">node_results_df</span><span class="p">,</span> <span class="n">basecase_id</span><span class="p">)</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="n">node_results_df</span> <span class="o">=</span> <span class="n">add_name_column_polars</span><span class="p">(</span><span class="n">node_results_df</span><span class="p">,</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">element_name_mapping</span><span class="p">,</span> <span class="n">index_level</span><span class="o">=</span><span class="s2">&quot;element&quot;</span><span class="p">)</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="n">node_results_df</span> <span class="o">=</span> <span class="n">add_name_column_polars</span><span class="p">(</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">node_results_df</span><span class="p">,</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">contingency_name_mapping</span><span class="p">,</span> <span class="n">index_level</span><span class="o">=</span><span class="s2">&quot;contingency&quot;</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="p">)</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="n">regulating_elements_df</span> <span class="o">=</span> <span class="n">update_basename_polars</span><span class="p">(</span><span class="n">regulating_elements_df</span><span class="p">,</span> <span class="n">basecase_id</span><span class="p">)</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="n">regulating_elements_df</span> <span class="o">=</span> <span class="n">add_name_column_polars</span><span class="p">(</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="n">regulating_elements_df</span><span class="p">,</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">element_name_mapping</span><span class="p">,</span> <span class="n">index_level</span><span class="o">=</span><span class="s2">&quot;element&quot;</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="p">)</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">regulating_elements_df</span> <span class="o">=</span> <span class="n">add_name_column_polars</span><span class="p">(</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="n">regulating_elements_df</span><span class="p">,</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">contingency_name_mapping</span><span class="p">,</span> <span class="n">index_level</span><span class="o">=</span><span class="s2">&quot;contingency&quot;</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="p">)</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="n">va_diff_results_df</span> <span class="o">=</span> <span class="n">update_basename_polars</span><span class="p">(</span><span class="n">va_diff_results_df</span><span class="p">,</span> <span class="n">basecase_id</span><span class="p">)</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="n">va_diff_results_df</span> <span class="o">=</span> <span class="n">add_name_column_polars</span><span class="p">(</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="n">va_diff_results_df</span><span class="p">,</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">element_name_mapping</span><span class="p">,</span> <span class="n">index_level</span><span class="o">=</span><span class="s2">&quot;element&quot;</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="p">)</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">va_diff_results_df</span> <span class="o">=</span> <span class="n">add_name_column_polars</span><span class="p">(</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">va_diff_results_df</span><span class="p">,</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">contingency_name_mapping</span><span class="p">,</span> <span class="n">index_level</span><span class="o">=</span><span class="s2">&quot;contingency&quot;</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="p">)</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="n">lf_results</span> <span class="o">=</span> <span class="n">LoadflowResultsPolars</span><span class="p">(</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">branch_results</span><span class="o">=</span><span class="n">branch_results_df</span><span class="p">,</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">node_results</span><span class="o">=</span><span class="n">node_results_df</span><span class="p">,</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">regulating_element_results</span><span class="o">=</span><span class="n">regulating_elements_df</span><span class="p">,</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="n">va_diff_results</span><span class="o">=</span><span class="n">va_diff_results_df</span><span class="p">,</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">converged</span><span class="o">=</span><span class="n">convergence_df</span><span class="p">,</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">warnings</span><span class="o">=</span><span class="p">[],</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">additional_information</span><span class="o">=</span><span class="p">[],</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">lazy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="p">)</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">return</span> <span class="n">lf_results</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_powsybl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">run_contingency_analysis_powsybl</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.contingency_analysis_powsybl.run_contingency_analysis_powsybl" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">run_contingency_analysis_powsybl</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">n_minus_1_definition</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">n_processes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">polars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the Contingency Analysis for the network.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The powsybl network to compute the Contingency Analysis for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pypowsybl.network.Network">Network</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_minus_1_definition</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The N-1 definition to use for the contingency analysis. Contains outages and monitored elements</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            Nminus1Definition (toop_engine_interfaces.nminus1_definition.Nminus1Definition)" href="../reference_interfaces/#toop_engine_interfaces.nminus1_definition.Nminus1Definition">Nminus1Definition</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_id</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The job id of the current job</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep to use for the contingency analysis</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The method to use for the contingency analysis. Either "ac" or "dc", by default "dc"</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="ac">ac</span>, <span title="dc">dc</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;ac&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_processes</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.
If &gt; 1, the analysis is run in parallel
Paralelization is done by splitting the contingencies into chunks and running each chunk in a separate process</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>polars</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to use polars for the dataframe operations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="beartype.typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="            LoadflowResults (toop_engine_interfaces.loadflow_results.LoadflowResults)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.LoadflowResults">LoadflowResults</a>, <a class="autorefs autorefs-internal" title="            LoadflowResultsPolars (toop_engine_interfaces.loadflow_results_polars.LoadflowResultsPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.LoadflowResultsPolars">LoadflowResultsPolars</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The results of the loadflow computation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/contingency_analysis_powsybl.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_contingency_analysis_powsybl</span><span class="p">(</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">net</span><span class="p">:</span> <span class="n">Network</span><span class="p">,</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="n">n_minus_1_definition</span><span class="p">:</span> <span class="n">Nminus1Definition</span><span class="p">,</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ac&quot;</span><span class="p">,</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">n_processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">polars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">LoadflowResults</span><span class="p">,</span> <span class="n">LoadflowResultsPolars</span><span class="p">]:</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the Contingency Analysis for the network.</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    ----------</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    net : Network</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        The powsybl network to compute the Contingency Analysis for</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    n_minus_1_definition : Nminus1Definition</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        The N-1 definition to use for the contingency analysis. Contains outages and monitored elements</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    job_id : str</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        The job id of the current job</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        The timestep to use for the contingency analysis</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    method : Literal[&quot;ac&quot;, &quot;dc&quot;], optional</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        The method to use for the contingency analysis. Either &quot;ac&quot; or &quot;dc&quot;, by default &quot;dc&quot;</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    n_processes : int, optional</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        The number of processes to use for the contingency analysis. If 1, the analysis is run sequentially.</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        If &gt; 1, the analysis is run in parallel</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        Paralelization is done by splitting the contingencies into chunks and running each chunk in a separate process</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    polars: bool</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        Whether to use polars for the dataframe operations.</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    Returns</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    -------</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    Union[LoadflowResults, LoadflowResultsPolars]</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        The results of the loadflow computation.</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="k">if</span> <span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">loadflow_parameters</span><span class="o">.</span><span class="n">distributed_slack</span><span class="p">:</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="c1"># We only do this once, before the first batch. So we dont have to redo it every iteration</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">net</span> <span class="o">=</span> <span class="n">set_target_values_to_lf_values_incl_distributed_slack</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="n">pow_n1_definition</span> <span class="o">=</span> <span class="n">translate_nminus1_for_powsybl</span><span class="p">(</span><span class="n">n_minus_1_definition</span><span class="p">,</span> <span class="n">net</span><span class="p">)</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="n">lf_result</span> <span class="o">=</span> <span class="n">run_contingency_analysis_polars</span><span class="p">(</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">net</span><span class="o">=</span><span class="n">net</span><span class="p">,</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">pow_n1_definition</span><span class="o">=</span><span class="n">pow_n1_definition</span><span class="p">,</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">,</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="n">n_processes</span><span class="o">=</span><span class="n">n_processes</span><span class="p">,</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="p">)</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">polars</span><span class="p">:</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="n">lf_result</span> <span class="o">=</span> <span class="n">convert_polars_loadflow_results_to_pandas</span><span class="p">(</span><span class="n">lf_result</span><span class="p">)</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="n">missing_element_warnings</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="sa">f</span><span class="s2">&quot;Element with id </span><span class="si">{</span><span class="n">element</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> not found in the network.&quot;</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">missing_elements</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="p">]</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">missing_contingency_warnings</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="sa">f</span><span class="s2">&quot;Contingency with id </span><span class="si">{</span><span class="n">contingency</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> contains elements that are not found in the network.&quot;</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">pow_n1_definition</span><span class="o">.</span><span class="n">missing_contingencies</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="p">]</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="n">lf_result</span><span class="o">.</span><span class="n">warnings</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">missing_element_warnings</span><span class="p">,</span> <span class="o">*</span><span class="n">missing_contingency_warnings</span><span class="p">,</span> <span class="o">*</span><span class="n">lf_result</span><span class="o">.</span><span class="n">warnings</span><span class="p">]</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="k">return</span> <span class="n">lf_result</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars" class="headerlink" title="Permanent link">#</a></h2>

    <div class="doc doc-contents first">

        <p>Helper functions to translate the N-1 definition into a usable format for Powsybl.</p>
<p>This includes translating contingencies, monitored elements and collecting
the necessary data from the network, so this only has to happen once.</p>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.POWSYBL_CONVERGENCE_MAP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">POWSYBL_CONVERGENCE_MAP</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.POWSYBL_CONVERGENCE_MAP" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">POWSYBL_CONVERGENCE_MAP</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="pypowsybl.loadflow.ComponentStatus.CONVERGED.value">value</span></span><span class="p">:</span> <span class="n"><span title="toop_engine_interfaces.loadflow_results.ConvergenceStatus.CONVERGED.value">value</span></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n"><span title="pypowsybl.loadflow.ComponentStatus.FAILED.value">value</span></span><span class="p">:</span> <span class="n"><span title="toop_engine_interfaces.loadflow_results.ConvergenceStatus.FAILED.value">value</span></span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n"><span title="pypowsybl.loadflow.ComponentStatus.NO_CALCULATION.value">value</span></span><span class="p">:</span> <span class="n"><span title="toop_engine_interfaces.loadflow_results.ConvergenceStatus.NO_CALCULATION.value">value</span></span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n"><span title="pypowsybl.loadflow.ComponentStatus.MAX_ITERATION_REACHED.value">value</span></span><span class="p">:</span> <span class="n"><span title="toop_engine_interfaces.loadflow_results.ConvergenceStatus.MAX_ITERATION_REACHED.value">value</span></span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">}</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_node_results_polars" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_node_results_polars</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_node_results_polars" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_node_results_polars</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">bus_results</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">monitored_buses</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">bus_map</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">voltage_levels</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">failed_outages</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the node results for the given outages and timestep.</p>
<p>TODO: This is currently faking the sum of p and q at the node</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bus_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The bus results from the powsybl security analysis</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="polars.LazyFrame">LazyFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_buses</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored buses to get the node results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bus_map</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A mapping from busbar sections or bus_breaker_buses to the electrical buses.
This is used to map the buses from bus_results to electrical buses and back to the monitored buses.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="polars.LazyFrame">LazyFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>voltage_levels</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The voltage levels of the buses. This is used to determine
voltage limits and nominal v in DC.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="polars.LazyFrame">LazyFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>failed_outages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of failed outages to get nan-node results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep to get the node results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The method to use for the node results. Either "ac" or "dc"</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="ac">ac</span>, <span title="dc">dc</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandera.typing.polars.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="            NodeResultSchemaPolars (toop_engine_interfaces.loadflow_results_polars.NodeResultSchemaPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.NodeResultSchemaPolars">NodeResultSchemaPolars</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The node results for the given outages and timestep</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers_polars.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_node_results_polars</span><span class="p">(</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">bus_results</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">monitored_buses</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="n">bus_map</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">voltage_levels</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">failed_outages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">],</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">patpl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">[</span><span class="n">NodeResultSchemaPolars</span><span class="p">]:</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the node results for the given outages and timestep.</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52"></a>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    TODO: This is currently faking the sum of p and q at the node</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54"></a>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    ----------</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    bus_results : pl.LazyFrame</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        The bus results from the powsybl security analysis</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    monitored_buses : list[str]</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        The list of monitored buses to get the node results for</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    bus_map: pl.LazyFrame</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        A mapping from busbar sections or bus_breaker_buses to the electrical buses.</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        This is used to map the buses from bus_results to electrical buses and back to the monitored buses.</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    voltage_levels: pl.LazyFrame</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        The voltage levels of the buses. This is used to determine</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        voltage limits and nominal v in DC.</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    failed_outages : list[str]</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        The list of failed outages to get nan-node results for</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        The timestep to get the node results for</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    method : Literal[&quot;ac&quot;, &quot;dc&quot;]</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        The method to use for the node results. Either &quot;ac&quot; or &quot;dc&quot;</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    Returns</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    -------</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    patpl.DataFrame[NodeResultSchemaPolars]</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        The node results for the given outages and timestep</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">if</span> <span class="n">bus_results</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="k">return</span> <span class="n">get_failed_node_results_polars</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">failed_outages</span><span class="p">,</span> <span class="n">monitored_buses</span><span class="p">)</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="c1"># Translate bus_ids that could be busbar sections or bus_breaker_buses to the monitored buses</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="c1"># Should work for both busbar and bus_breaker models</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">bus_results</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;operator_strategy_id&quot;</span><span class="p">)</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">:</span> <span class="s2">&quot;contingency&quot;</span><span class="p">})</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">bus_map</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">),</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bus_id&quot;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="p">)</span>  <span class="c1"># m:1 join</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">drop_nulls</span><span class="p">(</span><span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">)</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">monitored_bus_map</span> <span class="o">=</span> <span class="n">bus_map</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_in</span><span class="p">(</span><span class="n">monitored_buses</span><span class="p">))</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">bus_to_element_map</span> <span class="o">=</span> <span class="n">monitored_bus_map</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">),</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="p">)</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bus_to_element_map</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="c1"># remove not monitored buses</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">drop_nulls</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">)</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="c1"># Merge the actual voltage level in kV</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="n">voltage_levels</span><span class="p">,</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;voltage_level_id&quot;</span><span class="p">],</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="p">)</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="c1"># set timestamp column</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">timestep</span><span class="p">))</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;v_mag&quot;</span><span class="p">:</span> <span class="s2">&quot;vm&quot;</span><span class="p">,</span> <span class="s2">&quot;v_angle&quot;</span><span class="p">:</span> <span class="s2">&quot;va&quot;</span><span class="p">})</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="c1"># Calculate the values</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;dc&quot;</span><span class="p">:</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="n">pl</span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;va&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_not_null</span><span class="p">())</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;nominal_v&quot;</span><span class="p">))</span>  <span class="c1"># fill vm with nominal v if va is present</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;vm&quot;</span><span class="p">))</span>  <span class="c1"># keep original vm</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;vm&quot;</span><span class="p">)</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="p">)</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;vm&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;nominal_v&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;vm_deviation&quot;</span><span class="p">))</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;vm_deviation&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;high_voltage_limit&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;nominal_v&quot;</span><span class="p">)))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;deviation_to_max&quot;</span><span class="p">)</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="p">)</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;vm_deviation&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;nominal_v&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;low_voltage_limit&quot;</span><span class="p">)))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;deviation_to_min&quot;</span><span class="p">)</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="p">)</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">pl</span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;vm_deviation&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;deviation_to_max&quot;</span><span class="p">))</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;deviation_to_min&quot;</span><span class="p">))</span>  <span class="c1"># keep original vm</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;vm_loading&quot;</span><span class="p">)</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="p">)</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">failed_node_results</span> <span class="o">=</span> <span class="n">get_failed_node_results_polars</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">failed_outages</span><span class="p">,</span> <span class="n">monitored_buses</span><span class="p">)</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="c1"># TODO: va_loading is not defined yet</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">cast</span><span class="p">({</span><span class="s2">&quot;timestep&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">})</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="c1"># TODO: add p and q calculation at the node</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">p</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)),</span>  <span class="c1"># TODO</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">q</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)),</span>  <span class="c1"># TODO</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">element_name</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>  <span class="c1"># will be filled later</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">contingency_name</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>  <span class="c1"># will be filled later</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="p">)</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="p">[</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="s2">&quot;timestep&quot;</span><span class="p">,</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="s2">&quot;contingency&quot;</span><span class="p">,</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="s2">&quot;element&quot;</span><span class="p">,</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="s2">&quot;vm&quot;</span><span class="p">,</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="s2">&quot;va&quot;</span><span class="p">,</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="s2">&quot;vm_loading&quot;</span><span class="p">,</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="s2">&quot;p&quot;</span><span class="p">,</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="s2">&quot;q&quot;</span><span class="p">,</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="s2">&quot;element_name&quot;</span><span class="p">,</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="s2">&quot;contingency_name&quot;</span><span class="p">,</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="p">]</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="p">)</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="n">all_node_results</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">node_results</span><span class="p">,</span> <span class="n">failed_node_results</span><span class="p">])</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="k">return</span> <span class="n">all_node_results</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_branch_results_polars" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_branch_results_polars</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_branch_results_polars" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_branch_results_polars</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">branch_results</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">three_winding_results</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">monitored_branches</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">monitored_trafo3w</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">failed_outages</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">branch_limits</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the branch results for the given outages and timestep.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>branch_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The branch results from the powsybl security analysis</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="polars.LazyFrame">LazyFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>three_winding_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The three winding transformer results from the powsybl security analysis</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="polars.LazyFrame">LazyFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_branches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored branches with 2 sides to get the branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_trafo3w</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored three winding transformers to get the branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>failed_outages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of failed outages to get nan-branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep to get the branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branch_limits</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The branch limits from the powsybl network</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="polars.LazyFrame">LazyFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandera.typing.polars.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="            BranchResultSchemaPolars (toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars">BranchResultSchemaPolars</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The polars branch results for the given outages and timestep</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers_polars.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_branch_results_polars</span><span class="p">(</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="n">branch_results</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">three_winding_results</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">monitored_branches</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">monitored_trafo3w</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">failed_outages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">branch_limits</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">patpl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">[</span><span class="n">BranchResultSchemaPolars</span><span class="p">]:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the branch results for the given outages and timestep.</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    ----------</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    branch_results : pl.LazyFrame</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        The branch results from the powsybl security analysis</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    three_winding_results : pl.LazyFrame</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        The three winding transformer results from the powsybl security analysis</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    monitored_branches : list[str]</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        The list of monitored branches with 2 sides to get the branch results for</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    monitored_trafo3w : list[str]</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        The list of monitored three winding transformers to get the branch results for</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    failed_outages : list[str]</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        The list of failed outages to get nan-branch results for</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        The timestep to get the branch results for</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    branch_limits : pl.LazyFrame</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        The branch limits from the powsybl network</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Returns</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    -------</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    patpl.DataFrame[BranchResultSchemaPolars]</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        The polars branch results for the given outages and timestep</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="c1"># Align all indizes</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="n">branch_results</span> <span class="o">=</span> <span class="n">branch_results</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;operator_strategy_id&quot;</span><span class="p">)</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="n">branch_results</span> <span class="o">=</span> <span class="n">branch_results</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">:</span> <span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;branch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;element&quot;</span><span class="p">})</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="n">three_winding_results</span> <span class="o">=</span> <span class="n">three_winding_results</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">:</span> <span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;transformer_id&quot;</span><span class="p">:</span> <span class="s2">&quot;element&quot;</span><span class="p">})</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="n">side_one_results</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="p">[</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="n">branch_results</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span> <span class="s2">&quot;p1&quot;</span><span class="p">,</span> <span class="s2">&quot;q1&quot;</span><span class="p">,</span> <span class="s2">&quot;i1&quot;</span><span class="p">]),</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="n">three_winding_results</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span> <span class="s2">&quot;p1&quot;</span><span class="p">,</span> <span class="s2">&quot;q1&quot;</span><span class="p">,</span> <span class="s2">&quot;i1&quot;</span><span class="p">]),</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="p">]</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="p">)</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">BranchSide</span><span class="o">.</span><span class="n">ONE</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;p1&quot;</span><span class="p">:</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;q1&quot;</span><span class="p">:</span> <span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;i1&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">})</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="p">)</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">side_two_results</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="p">[</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>                <span class="n">branch_results</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span> <span class="s2">&quot;p2&quot;</span><span class="p">,</span> <span class="s2">&quot;q2&quot;</span><span class="p">,</span> <span class="s2">&quot;i2&quot;</span><span class="p">]),</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>                <span class="n">three_winding_results</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span> <span class="s2">&quot;p2&quot;</span><span class="p">,</span> <span class="s2">&quot;q2&quot;</span><span class="p">,</span> <span class="s2">&quot;i2&quot;</span><span class="p">]),</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="p">]</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="p">)</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">BranchSide</span><span class="o">.</span><span class="n">TWO</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;p2&quot;</span><span class="p">:</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;q2&quot;</span><span class="p">:</span> <span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;i2&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">})</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="p">)</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">side_three_results</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">three_winding_results</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span> <span class="s2">&quot;p3&quot;</span><span class="p">,</span> <span class="s2">&quot;q3&quot;</span><span class="p">,</span> <span class="s2">&quot;i3&quot;</span><span class="p">])</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">BranchSide</span><span class="o">.</span><span class="n">THREE</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;p3&quot;</span><span class="p">:</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;q3&quot;</span><span class="p">:</span> <span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;i3&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">})</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="p">)</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="c1"># Combine and Add timestep column</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">side_one_results</span><span class="p">,</span> <span class="n">side_two_results</span><span class="p">,</span> <span class="n">side_three_results</span><span class="p">])</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="n">timestep</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">timestep</span><span class="p">)</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="p">)</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">cast</span><span class="p">({</span><span class="s2">&quot;timestep&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">,</span> <span class="s2">&quot;side&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">})</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="n">branch_limits</span> <span class="o">=</span> <span class="n">branch_limits</span><span class="o">.</span><span class="n">cast</span><span class="p">({</span><span class="s2">&quot;side&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">})</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a>                <span class="n">branch_limits</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">,</span> <span class="s2">&quot;side&quot;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;element_id&quot;</span><span class="p">,</span> <span class="s2">&quot;side&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="p">)</span>  <span class="c1"># m:1 join</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">loading</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;i&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">))</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="p">)</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="c1"># add i column</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)))</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="c1"># add loading column</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">loading</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)))</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="c1"># cast null to str</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">cast</span><span class="p">({</span><span class="s2">&quot;contingency&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">})</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="c1"># fill loading nulls with nans for loading</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;loading&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fill_null</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)))</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="c1"># add empty element_name and contingency_name columns to match the schema</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">element_name</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="n">contingency_name</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="p">)</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="c1"># Add results for non convergent contingencies</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">failed_branch_results</span> <span class="o">=</span> <span class="n">get_failed_branch_results_polars</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">failed_outages</span><span class="p">,</span> <span class="n">monitored_branches</span><span class="p">,</span> <span class="n">monitored_trafo3w</span><span class="p">)</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="p">[</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="s2">&quot;timestep&quot;</span><span class="p">,</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="s2">&quot;contingency&quot;</span><span class="p">,</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="s2">&quot;element&quot;</span><span class="p">,</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="s2">&quot;side&quot;</span><span class="p">,</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="s2">&quot;p&quot;</span><span class="p">,</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="s2">&quot;q&quot;</span><span class="p">,</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="s2">&quot;i&quot;</span><span class="p">,</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="s2">&quot;loading&quot;</span><span class="p">,</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="s2">&quot;element_name&quot;</span><span class="p">,</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="s2">&quot;contingency_name&quot;</span><span class="p">,</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="p">]</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="p">)</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">converted_branch_results</span><span class="p">,</span> <span class="n">failed_branch_results</span><span class="p">])</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">return</span> <span class="n">converted_branch_results</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_va_diff_results_polars" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_va_diff_results_polars</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_va_diff_results_polars" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_va_diff_results_polars</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">bus_results</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">outages</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">va_diff_with_buses</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">bus_map</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the voltage angle difference results for the given outages and bus results.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bus_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the bus results of powsybl contingency analysis.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="polars.LazyFrame">LazyFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>outages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of outages to be considered. These are the contingency ids that are outaged.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>va_diff_with_buses</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the voltage angle difference results with the bus pairs that need checking.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="polars.LazyFrame">LazyFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bus_map</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A mapping from busbar sections to bus breaker buses. This is used to convert the busbar sections to bus breaker buses
in the Node Breaker model.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="polars.LazyFrame">LazyFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep of the results.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="            VADiffResultSchemaPolars (toop_engine_interfaces.loadflow_results_polars.VADiffResultSchemaPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.VADiffResultSchemaPolars">VADiffResultSchemaPolars</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The dataframe containing the voltage angle difference results for the given outages.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers_polars.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_va_diff_results_polars</span><span class="p">(</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="n">bus_results</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span> <span class="n">outages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">va_diff_with_buses</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span> <span class="n">bus_map</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">,</span> <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">patpl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">[</span><span class="n">VADiffResultSchemaPolars</span><span class="p">]:</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the voltage angle difference results for the given outages and bus results.</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    ----------</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    bus_results : pl.LazyFrame</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        The dataframe containing the bus results of powsybl contingency analysis.</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    outages : list[str]</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        The list of outages to be considered. These are the contingency ids that are outaged.</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    va_diff_with_buses : pl.LazyFrame</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        The dataframe containing the voltage angle difference results with the bus pairs that need checking.</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    bus_map: pl.LazyFrame</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        A mapping from busbar sections to bus breaker buses. This is used to convert the busbar sections to bus breaker buses</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        in the Node Breaker model.</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        The timestep of the results.</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">    Returns</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    -------</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    VADiffResultSchemaPolars</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        The dataframe containing the voltage angle difference results for the given outages.</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outages</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">bus_results</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">get_empty_dataframe_from_model</span><span class="p">(</span><span class="n">VADiffResultSchema</span><span class="p">),</span> <span class="n">include_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nan_to_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a>            <span class="o">.</span><span class="n">lazy</span><span class="p">()</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="o">.</span><span class="n">cast</span><span class="p">({</span><span class="s2">&quot;timestep&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">,</span> <span class="s2">&quot;va_diff&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">})</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="p">)</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="n">basecase_in_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">va_diff_with_buses</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_in</span><span class="p">([</span><span class="n">basecase_in_result</span><span class="p">,</span> <span class="o">*</span><span class="n">outages</span><span class="p">]))</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">timestep</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">))</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="c1"># Map busbar sections where there are any. For the rest use the bus_breaker_bus_id from the results (here the bus id)</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="n">bus_results</span> <span class="o">=</span> <span class="n">bus_results</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="n">bus_map</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">),</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bus_id&quot;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="p">)</span>  <span class="c1"># m:1 join</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="c1"># get the voltage angles for both buses in the va_diff definition</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="n">bus_results</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">,</span> <span class="s2">&quot;v_angle&quot;</span><span class="p">),</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus1_id&quot;</span><span class="p">],</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">],</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="p">)</span>  <span class="c1"># m:1 join</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;v_angle&quot;</span><span class="p">:</span> <span class="s2">&quot;v_angle_1&quot;</span><span class="p">})</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="n">bus_results</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">,</span> <span class="s2">&quot;v_angle&quot;</span><span class="p">),</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus2_id&quot;</span><span class="p">],</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">],</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="p">)</span>  <span class="c1"># m:1 join</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;v_angle&quot;</span><span class="p">:</span> <span class="s2">&quot;v_angle_2&quot;</span><span class="p">})</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="c1"># Calculate the voltage angle difference</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">with_columns</span><span class="p">((</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;v_angle_1&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;v_angle_2&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;va_diff&quot;</span><span class="p">))</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="c1"># drop duplicates</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="c1"># add empty element_name and contingency_name columns to match the schema</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="n">element_name</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>  <span class="c1"># will be filled later</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="n">contingency_name</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span>  <span class="c1"># will be filled later</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="p">)</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="p">[</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a>            <span class="s2">&quot;timestep&quot;</span><span class="p">,</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="s2">&quot;contingency&quot;</span><span class="p">,</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="s2">&quot;element&quot;</span><span class="p">,</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="s2">&quot;va_diff&quot;</span><span class="p">,</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="s2">&quot;element_name&quot;</span><span class="p">,</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="s2">&quot;contingency_name&quot;</span><span class="p">,</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="p">]</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="p">)</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="k">return</span> <span class="n">iteration_va_diff</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.update_basename_polars" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">update_basename_polars</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.update_basename_polars" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">update_basename_polars</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">basecase_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Update the basecase name in the results dataframes.</p>
<p>This function updates the contingency index level of the results dataframes to
reflect the basecase name. If the basecase is not included in the run, it will
remove it from the results. Powsybl includes the basecase as an empty string by default.</p>
<p>The Dataframes are expected to have a multi-index with a "contingency" level.
The Dataframes are updated inplace.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>result_df</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the branch / node / VADiff results</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            LoadflowResultTablePolars


  
      module-attribute
   (toop_engine_interfaces.loadflow_results_polars.LoadflowResultTablePolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.LoadflowResultTablePolars">LoadflowResultTablePolars</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>basecase_name</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The name of the basecase contingency, if it is included in the run. Otherwise None, by default None</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Optional">Optional</span>[<span title="str">str</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="            LoadflowResultTablePolars


  
      module-attribute
   (toop_engine_interfaces.loadflow_results_polars.LoadflowResultTablePolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.LoadflowResultTablePolars">LoadflowResultTablePolars</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The updated dataframes with the basecase name set or removed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers_polars.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_basename_polars</span><span class="p">(</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="n">result_df</span><span class="p">:</span> <span class="n">LoadflowResultTablePolars</span><span class="p">,</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="n">basecase_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoadflowResultTablePolars</span><span class="p">:</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the basecase name in the results dataframes.</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    This function updates the contingency index level of the results dataframes to</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    reflect the basecase name. If the basecase is not included in the run, it will</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    remove it from the results. Powsybl includes the basecase as an empty string by default.</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">    The Dataframes are expected to have a multi-index with a &quot;contingency&quot; level.</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    The Dataframes are updated inplace.</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377"></a>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    ----------</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">    result_df: LoadflowResultTablePolars</span>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">        The dataframe containing the branch / node / VADiff results</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    basecase_name: Optional[str], optional</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        The name of the basecase contingency, if it is included in the run. Otherwise None, by default None</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    Returns</span>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">    -------</span>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">    LoadflowResultTablePolars</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">        The updated dataframes with the basecase name set or removed.</span>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="k">if</span> <span class="n">basecase_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="c1"># Replace the empty string with the basecase name</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="n">result_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="n">pl</span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">basecase_name</span><span class="p">))</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">))</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="p">)</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="c1"># Remove the basecase from the results if it is not included in the run</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="n">result_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="k">return</span> <span class="n">result_df</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.add_name_column_polars" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">add_name_column_polars</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.add_name_column_polars" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">add_name_column_polars</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">result_df</span><span class="p">,</span> <span class="n">name_map</span><span class="p">,</span> <span class="n">index_level</span><span class="o">=</span><span class="s2">&quot;element&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Translate the element ids in the results dataframes to the original names.</p>
<p>This function translates the element names in the results dataframes to the original names
from the Powsybl network. This is useful for debugging and for displaying the results.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>result_df</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the node / branch / VADiff results</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            LoadflowResultTablePolars


  
      module-attribute
   (toop_engine_interfaces.loadflow_results_polars.LoadflowResultTablePolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.LoadflowResultTablePolars">LoadflowResultTablePolars</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name_map</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A mapping from the element ids to the original names. This is used to translate the element names in the results.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index_level</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The index level storing the ids that should be mapped to the names. by default "element" for the monitored elements.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;element&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="            LoadflowResultTablePolars


  
      module-attribute
   (toop_engine_interfaces.loadflow_results_polars.LoadflowResultTablePolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.LoadflowResultTablePolars">LoadflowResultTablePolars</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The updated dataframe with the ids translated to the original names.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers_polars.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_name_column_polars</span><span class="p">(</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="n">result_df</span><span class="p">:</span> <span class="n">LoadflowResultTablePolars</span><span class="p">,</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="n">name_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="n">index_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoadflowResultTablePolars</span><span class="p">:</span>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Translate the element ids in the results dataframes to the original names.</span>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">    This function translates the element names in the results dataframes to the original names</span>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">    from the Powsybl network. This is useful for debugging and for displaying the results.</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">    ----------</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">    result_df: LoadflowResultTablePolars</span>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        The dataframe containing the node / branch / VADiff results</span>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">    name_map: dict[str | str]</span>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        A mapping from the element ids to the original names. This is used to translate the element names in the results.</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">    index_level: str, optional</span>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        The index level storing the ids that should be mapped to the names. by default &quot;element&quot; for the monitored elements.</span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">    Returns</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    -------</span>
</span><span id="__span-0-427"><a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">    LoadflowResultTablePolars</span>
</span><span id="__span-0-428"><a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">        The updated dataframe with the ids translated to the original names.</span>
</span><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="n">result_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">index_level</span><span class="p">)</span>
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">name_map</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index_level</span><span class="si">}</span><span class="s2">_name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fill_null</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index_level</span><span class="si">}</span><span class="s2">_name&quot;</span><span class="p">)</span>
</span><span id="__span-0-434"><a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="p">)</span>
</span><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435"></a>
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="c1"># fill nulls with empty string</span>
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">result_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index_level</span><span class="si">}</span><span class="s2">_name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fill_null</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">return</span> <span class="n">result_df</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_node_results_polars" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_failed_node_results_polars</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_node_results_polars" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_failed_node_results_polars</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">timestep</span><span class="p">,</span> <span class="n">failed_outages</span><span class="p">,</span> <span class="n">monitored_nodes</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the failed node results for the given outages and timestep.</p>
<p>A wrapper around get_failed_node_results to convert the pandas dataframe to a polars dataframe.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep to get the node results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>failed_outages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of failed outages to get nan-node results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_nodes</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored nodes to get the node results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandera.typing.polars.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="            NodeResultSchemaPolars (toop_engine_interfaces.loadflow_results_polars.NodeResultSchemaPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.NodeResultSchemaPolars">NodeResultSchemaPolars</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The polars dataframe containing the failed node results for the given outages and timestep</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers_polars.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_failed_node_results_polars</span><span class="p">(</span>
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">failed_outages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">monitored_nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">patpl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">[</span><span class="n">NodeResultSchemaPolars</span><span class="p">]:</span>
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the failed node results for the given outages and timestep.</span>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446"></a>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">    A wrapper around get_failed_node_results to convert the pandas dataframe to a polars dataframe.</span>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448"></a>
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">    ----------</span>
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">        The timestep to get the node results for</span>
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    failed_outages : list[str]</span>
</span><span id="__span-0-454"><a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        The list of failed outages to get nan-node results for</span>
</span><span id="__span-0-455"><a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">    monitored_nodes : list[str]</span>
</span><span id="__span-0-456"><a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        The list of monitored nodes to get the node results for</span>
</span><span id="__span-0-457"><a id="__codelineno-0-457" name="__codelineno-0-457"></a>
</span><span id="__span-0-458"><a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">    Returns</span>
</span><span id="__span-0-459"><a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">    -------</span>
</span><span id="__span-0-460"><a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">    patpl.DataFrame[NodeResultSchemaPolars]</span>
</span><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        The polars dataframe containing the failed node results for the given outages and timestep</span>
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">failed_node_results</span> <span class="o">=</span> <span class="n">get_failed_node_results</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">failed_outages</span><span class="p">,</span> <span class="n">monitored_nodes</span><span class="p">)</span>
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="n">failed_node_results</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">failed_node_results</span><span class="p">,</span> <span class="n">include_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nan_to_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lazy</span><span class="p">()</span>
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="n">failed_node_results</span> <span class="o">=</span> <span class="n">failed_node_results</span><span class="o">.</span><span class="n">cast</span><span class="p">({</span><span class="s2">&quot;timestep&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">})</span>
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="k">return</span> <span class="n">failed_node_results</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_branch_results_polars" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_failed_branch_results_polars</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers_polars.get_failed_branch_results_polars" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_failed_branch_results_polars</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">failed_outages</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">monitored_branches</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">monitored_trafo3w</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the failed branch results for the given outages and timestep.</p>
<p>A wrapper around get_failed_branch_results to convert the pandas dataframe to a polars dataframe.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep to get the branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>failed_outages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of failed outages to get nan-branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_branches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored branches with 2 sides to get the branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_trafo3w</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored three winding transformers to get the branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandera.typing.polars.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="            BranchResultSchemaPolars (toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results_polars.BranchResultSchemaPolars">BranchResultSchemaPolars</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The polars dataframe containing the failed branch results for the given outages and timestep</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers_polars.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_failed_branch_results_polars</span><span class="p">(</span>
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">failed_outages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">monitored_branches</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">monitored_trafo3w</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">patpl</span><span class="o">.</span><span class="n">LazyFrame</span><span class="p">[</span><span class="n">BranchResultSchemaPolars</span><span class="p">]:</span>
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the failed branch results for the given outages and timestep.</span>
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474"></a>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">    A wrapper around get_failed_branch_results to convert the pandas dataframe to a polars dataframe.</span>
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476"></a>
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">    ----------</span>
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">        The timestep to get the branch results for</span>
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">    failed_outages : list[str]</span>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        The list of failed outages to get nan-branch results for</span>
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">    monitored_branches : list[str]</span>
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        The list of monitored branches with 2 sides to get the branch results for</span>
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    monitored_trafo3w : list[str]</span>
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        The list of monitored three winding transformers to get the branch results for</span>
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487"></a>
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">    Returns</span>
</span><span id="__span-0-489"><a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">    -------</span>
</span><span id="__span-0-490"><a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">    patpl.DataFrame[BranchResultSchemaPolars]</span>
</span><span id="__span-0-491"><a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">        The polars dataframe containing the failed branch results for the given outages and timestep</span>
</span><span id="__span-0-492"><a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-493"><a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="n">failed_branch_results</span> <span class="o">=</span> <span class="n">get_failed_branch_results</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">failed_outages</span><span class="p">,</span> <span class="n">monitored_branches</span><span class="p">,</span> <span class="n">monitored_trafo3w</span><span class="p">)</span>
</span><span id="__span-0-494"><a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="n">failed_branch_results</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">failed_branch_results</span><span class="p">,</span> <span class="n">include_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nan_to_null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lazy</span><span class="p">()</span>
</span><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="n">failed_branch_results</span> <span class="o">=</span> <span class="n">failed_branch_results</span><span class="o">.</span><span class="n">cast</span><span class="p">({</span><span class="s2">&quot;timestep&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">,</span> <span class="s2">&quot;side&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">})</span>
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="k">return</span> <span class="n">failed_branch_results</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">toop_engine_contingency_analysis.pypowsybl.powsybl_helpers</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers" class="headerlink" title="Permanent link">#</a></h2>

    <div class="doc doc-contents first">

        <p>Helper functions to translate the N-1 definition into a usable format for Powsybl.</p>
<p>This includes translating contingencies, monitored elements and collecting
the necessary data from the network, so this only has to happen once.</p>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.POWSYBL_CONVERGENCE_MAP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">POWSYBL_CONVERGENCE_MAP</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.POWSYBL_CONVERGENCE_MAP" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">POWSYBL_CONVERGENCE_MAP</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n"><span title="pypowsybl.loadflow.ComponentStatus.CONVERGED.value">value</span></span><span class="p">:</span> <span class="n"><span title="toop_engine_interfaces.loadflow_results.ConvergenceStatus.CONVERGED.value">value</span></span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n"><span title="pypowsybl.loadflow.ComponentStatus.FAILED.value">value</span></span><span class="p">:</span> <span class="n"><span title="toop_engine_interfaces.loadflow_results.ConvergenceStatus.FAILED.value">value</span></span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n"><span title="pypowsybl.loadflow.ComponentStatus.NO_CALCULATION.value">value</span></span><span class="p">:</span> <span class="n"><span title="toop_engine_interfaces.loadflow_results.ConvergenceStatus.NO_CALCULATION.value">value</span></span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n"><span title="pypowsybl.loadflow.ComponentStatus.MAX_ITERATION_REACHED.value">value</span></span><span class="p">:</span> <span class="n"><span title="toop_engine_interfaces.loadflow_results.ConvergenceStatus.MAX_ITERATION_REACHED.value">value</span></span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">}</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-class">



<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">PowsyblContingency</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>A Powsybl contingency.</p>
<p>This is a simplified version of the PandapowerContingency that is used in Powsybl.
It contains only the necessary information to run an N-1 analysis in Powsybl.</p>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.id" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">id</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.id" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">id</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The unique id of the contingency.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.name" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">name</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.name" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The name of the contingency.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.elements" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">elements</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.elements" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">elements</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The list of outaged element ids.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.is_basecase" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">is_basecase</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency.is_basecase" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">is_basecase</span><span class="p">()</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if the contingency is a basecase.</p>
<p>A basecase contingency has no outaged elements.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_basecase</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the contingency is a basecase.</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    A basecase contingency has no outaged elements.</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">PowsyblMonitoredElements</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing_extensions.TypedDict">TypedDict</span></code></p>



        <p>A dictionary to hold the monitored element ids for the N-1 analysis.</p>
<p>This is used to store the monitored elements in a format that can be used in Powsybl.</p>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.branches" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">branches</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.branches" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">branches</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.trafo3w" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">trafo3w</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.trafo3w" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">trafo3w</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.switches" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">switches</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.switches" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">switches</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.voltage_levels" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">voltage_levels</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.voltage_levels" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">voltage_levels</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.buses" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">buses</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements.buses" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">buses</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">PowsyblNMinus1Definition</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>A Powsybl N-1 definition.</p>
<p>This is a simplified version of the NMinus1Definition that is used in Powsybl.
It contains only the necessary information to run an N-1 analysis in Powsybl.</p>











<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.model_config" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model_config</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.model_config" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">model_config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;arbitrary_types_allowed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingencies" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">contingencies</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingencies" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">contingencies</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The outages to be considered. Maps contingency id to outaged element ids.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.monitored_elements" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">monitored_elements</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.monitored_elements" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">monitored_elements</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The list of branches with two sides, to be monitored during the N-1 analysis.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_elements" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">missing_elements</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_elements" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">missing_elements</span> <span class="o">=</span> <span class="p">[]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>A list of monitored elements that are not present in the network.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_contingencies" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">missing_contingencies</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.missing_contingencies" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">missing_contingencies</span> <span class="o">=</span> <span class="p">[]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>A list of contingencies whose elements are (partially) not present in the network.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.branch_limits" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">branch_limits</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.branch_limits" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">branch_limits</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The branch limits to be used during the N-1 analysis. If None, the default limits will be used.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.blank_va_diff" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">blank_va_diff</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.blank_va_diff" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">blank_va_diff</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The buses to be used during the N-1 analysis. This is used to determine the voltage levels of the monitored buses.
Could be a busbar section or a bus_breaker_buse depending on the model type.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.bus_map" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">bus_map</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.bus_map" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">bus_map</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>A mapping from busbar sections and bus breaker buses to bus breaker buses, electrical buses and voltage_levels.
This help to always get the correct buses, even if the model type changes.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.element_name_mapping" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">element_name_mapping</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.element_name_mapping" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">element_name_mapping</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>A mapping from element ids to their names. This is used to convert the element ids to their names in the results.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_name_mapping" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">contingency_name_mapping</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_name_mapping" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">contingency_name_mapping</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>A mapping from contingency ids to their names.
This is used to convert the contingency ids to their names in the results.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.voltage_levels" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">voltage_levels</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.voltage_levels" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">voltage_levels</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>The voltage levels of the buses. This is used to determine voltage limits.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.distributed_slack" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">distributed_slack</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.distributed_slack" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">distributed_slack</span> <span class="o">=</span> <span class="kc">True</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Whether to distribute the slack across the generators in the grid. Only relevant for powsybl grids.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_propagation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">contingency_propagation</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.contingency_propagation" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">contingency_propagation</span> <span class="o">=</span> <span class="kc">False</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Whether to enable powsybl's contingency propagation in the N-1 analysis.</p>
<p><a href="https://powsybl.readthedocs.io/projects/powsybl-open-loadflow/en/latest/security/parameters.html">https://powsybl.readthedocs.io/projects/powsybl-open-loadflow/en/latest/security/parameters.html</a>
Security Analysis will determine by topological search the switches with type circuit breakers
(i.e. capable of opening fault currents) that must be opened to isolate the fault. Depending on the network structure,
this could lead to more equipments to be simulated as tripped, because disconnectors and load break switches
(i.e., not capable of opening fault currents) are not considered.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.__getitem__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__getitem__</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition.__getitem__" class="headerlink" title="Permanent link">#</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get a subset of the nminus1definition based on the contingencies.</p>
<p>If a string is given, the contingency id must be in the contingencies list.
If an integer or slice is given, the case id will be indexed by the integer or slice.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PowsyblNMinus1Definition&quot;</span><span class="p">:</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a subset of the nminus1definition based on the contingencies.</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    If a string is given, the contingency id must be in the contingencies list.</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    If an integer or slice is given, the case id will be indexed by the integer or slice.</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">contingency_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">contingency</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contingencies</span><span class="p">]</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">contingency_ids</span><span class="p">:</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Contingency id </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> not in contingencies.&quot;</span><span class="p">)</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">contingency_ids</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="n">index</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">index</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">key</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Key must be a string, int or slice.&quot;</span><span class="p">)</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="n">updated_definition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">update</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="s2">&quot;contingencies&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">contingencies</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="p">}</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="p">)</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="c1"># pylint: disable=unsubscriptable-object</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">return</span> <span class="n">PowsyblNMinus1Definition</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">updated_definition</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_contingency_to_powsybl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">translate_contingency_to_powsybl</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_contingency_to_powsybl" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">translate_contingency_to_powsybl</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">contingencies</span><span class="p">,</span> <span class="n">identifiables</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Translate the contingencies to a format that can be used in Powsybl.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>contingencies</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of contingencies to translate.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="            Contingency (toop_engine_interfaces.nminus1_definition.Contingency)" href="../reference_interfaces/#toop_engine_interfaces.nminus1_definition.Contingency">Contingency</a>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>identifiables</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dataframe containing the identifiables of the network.
This is used to check if the elements are present in the network.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pow_contingency</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A list of PowsyblContingency objects, each containing the id, name and elements.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="            PowsyblContingency (toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency)" href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency">PowsyblContingency</a>]</code>
                  </span>
                </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>missing_contingency</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A list of all contingencies that are not fully present in the network.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="            Contingency (toop_engine_interfaces.nminus1_definition.Contingency)" href="../reference_interfaces/#toop_engine_interfaces.nminus1_definition.Contingency">Contingency</a>]</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="k">def</span><span class="w"> </span><span class="nf">translate_contingency_to_powsybl</span><span class="p">(</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">contingencies</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Contingency</span><span class="p">],</span> <span class="n">identifiables</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">PowsyblContingency</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">Contingency</span><span class="p">]]:</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Translate the contingencies to a format that can be used in Powsybl.</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    ----------</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    contingencies : list[Contingency]</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        The list of contingencies to translate.</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    identifiables : pd.DataFrame</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        A dataframe containing the identifiables of the network.</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        This is used to check if the elements are present in the network.</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    Returns</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    -------</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    pow_contingency: list[PowsyblContingency]</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        A list of PowsyblContingency objects, each containing the id, name and elements.</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    missing_contingency: list[Contingency]</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        A list of all contingencies that are not fully present in the network.</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">pow_contingencies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="n">missing_contingencies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">contingencies</span><span class="p">:</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">outaged_elements</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">contingency</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">identifiables</span><span class="p">:</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>                <span class="n">missing_contingencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contingency</span><span class="p">)</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a>                <span class="k">break</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="n">outaged_elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">pp_contingency</span> <span class="o">=</span> <span class="n">PowsyblContingency</span><span class="p">(</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="nb">id</span><span class="o">=</span><span class="n">contingency</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="n">name</span><span class="o">=</span><span class="n">contingency</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>                <span class="n">elements</span><span class="o">=</span><span class="n">outaged_elements</span><span class="p">,</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="p">)</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="n">pow_contingencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pp_contingency</span><span class="p">)</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">return</span> <span class="n">pow_contingencies</span><span class="p">,</span> <span class="n">missing_contingencies</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_monitored_elements_to_powsybl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">translate_monitored_elements_to_powsybl</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_monitored_elements_to_powsybl" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">translate_monitored_elements_to_powsybl</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">nminus1_definition</span><span class="p">,</span> <span class="n">branches</span><span class="p">,</span> <span class="n">buses</span><span class="p">,</span> <span class="n">switches</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Translate the monitored elements to a format that can be used in Powsybl.</p>
<p>Also adds busses that are not monitored per se, but are needed for the voltage angle difference calculation.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nminus1_definition</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The original Nminus1Definition containing the monitored elements and outages.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            Nminus1Definition (toop_engine_interfaces.nminus1_definition.Nminus1Definition)" href="../reference_interfaces/#toop_engine_interfaces.nminus1_definition.Nminus1Definition">Nminus1Definition</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the branches of the network and their voltage_id including 3w-trafos.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>buses</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the buses of the network and their voltage_id.
These include busbar sections and bus_breaker buses.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>switches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the switches of the network and their voltage_id.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>monitored_elements</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A dictionary containing the monitored elements in a format that can be used in Powsybl.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            PowsyblMonitoredElements (toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements)" href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblMonitoredElements">PowsyblMonitoredElements</a></code>
                  </span>
                </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>element_name_mapping</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A mapping from element ids to their names. This is used to convert the element ids to their names in the results.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
                  </span>
                </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>missing_elements</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A list of monitored elements that are not present in the network.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="            GridElement (toop_engine_interfaces.nminus1_definition.GridElement)" href="../reference_interfaces/#toop_engine_interfaces.nminus1_definition.GridElement">GridElement</a>]</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="k">def</span><span class="w"> </span><span class="nf">translate_monitored_elements_to_powsybl</span><span class="p">(</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">nminus1_definition</span><span class="p">:</span> <span class="n">Nminus1Definition</span><span class="p">,</span> <span class="n">branches</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">buses</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">switches</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">PowsyblMonitoredElements</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">GridElement</span><span class="p">]]:</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Translate the monitored elements to a format that can be used in Powsybl.</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    Also adds busses that are not monitored per se, but are needed for the voltage angle difference calculation.</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    ----------</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    nminus1_definition: Nminus1Definition</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        The original Nminus1Definition containing the monitored elements and outages.</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    branches : pd.DataFrame</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        The dataframe containing the branches of the network and their voltage_id including 3w-trafos.</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    buses : pd.DataFrame</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        The dataframe containing the buses of the network and their voltage_id.</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        These include busbar sections and bus_breaker buses.</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    switches : pd.DataFrame</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        The dataframe containing the switches of the network and their voltage_id.</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">    Returns</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    -------</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    monitored_elements: PowsyblMonitoredElements</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        A dictionary containing the monitored elements in a format that can be used in Powsybl.</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    element_name_mapping: dict[str, str]</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        A mapping from element ids to their names. This is used to convert the element ids to their names in the results.</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    missing_elements: list[GridElement]</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        A list of monitored elements that are not present in the network.</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="n">monitored_elements</span> <span class="o">=</span> <span class="n">nminus1_definition</span><span class="o">.</span><span class="n">monitored_elements</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="n">all_monitored_branches</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">monitored_elements</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;branch&quot;</span><span class="p">]</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">missing_branches</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_monitored_branches</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">branches</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="n">monitored_branch_df</span> <span class="o">=</span> <span class="n">branches</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="p">[</span><span class="n">branch_id</span> <span class="k">for</span> <span class="n">branch_id</span> <span class="ow">in</span> <span class="n">all_monitored_branches</span> <span class="k">if</span> <span class="n">branch_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">missing_branches</span><span class="p">]</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="p">]</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="n">monitored_branches</span> <span class="o">=</span> <span class="n">monitored_branch_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">monitored_branch_df</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;LINE&quot;</span><span class="p">,</span> <span class="s2">&quot;TWO_WINDINGS_TRANSFORMER&quot;</span><span class="p">,</span> <span class="s2">&quot;TIE_LINE&quot;</span><span class="p">])</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="n">monitored_trafo3w</span> <span class="o">=</span> <span class="n">monitored_branch_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">monitored_branch_df</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;THREE_WINDINGS_TRANSFORMER&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="n">all_monitored_buses</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">monitored_elements</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;bus&quot;</span><span class="p">]</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="n">missing_buses</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_monitored_buses</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">buses</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">monitored_buses</span> <span class="o">=</span> <span class="p">[</span><span class="n">bus_id</span> <span class="k">for</span> <span class="n">bus_id</span> <span class="ow">in</span> <span class="n">all_monitored_buses</span> <span class="k">if</span> <span class="n">bus_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">missing_buses</span><span class="p">]</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="n">all_monitored_switches</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">monitored_elements</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;switch&quot;</span><span class="p">]</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">missing_switches</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_monitored_switches</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">switches</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">monitored_switches</span> <span class="o">=</span> <span class="p">[</span><span class="n">switch_id</span> <span class="k">for</span> <span class="n">switch_id</span> <span class="ow">in</span> <span class="n">all_monitored_switches</span> <span class="k">if</span> <span class="n">switch_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">missing_switches</span><span class="p">]</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="c1"># The voltagelevels of outaged branches are relevant for the voltage angle difference calculation.</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="n">all_outaged_branch_ids</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">elem</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">nminus1_definition</span><span class="o">.</span><span class="n">contingencies</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">contingency</span><span class="o">.</span><span class="n">elements</span> <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;branch&quot;</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="p">]</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="n">missing_outage_branches</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_outaged_branch_ids</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">branches</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="n">outaged_branch_df</span> <span class="o">=</span> <span class="n">branches</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="p">[</span><span class="n">branch_id</span> <span class="k">for</span> <span class="n">branch_id</span> <span class="ow">in</span> <span class="n">all_outaged_branch_ids</span> <span class="k">if</span> <span class="n">branch_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">missing_outage_branches</span><span class="p">]</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="p">]</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">outaged_branch_ids</span> <span class="o">=</span> <span class="n">outaged_branch_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">outaged_branch_df</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;LINE&quot;</span><span class="p">,</span> <span class="s2">&quot;TWO_WINDINGS_TRANSFORMER&quot;</span><span class="p">,</span> <span class="s2">&quot;TIE_LINE&quot;</span><span class="p">])</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="n">monitored_voltage_levels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="n">buses</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">monitored_buses</span><span class="p">,</span> <span class="s2">&quot;voltage_level_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="o">+</span> <span class="n">switches</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">monitored_switches</span><span class="p">,</span> <span class="s2">&quot;voltage_level_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="o">+</span> <span class="n">branches</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">monitored_branches</span> <span class="o">+</span> <span class="n">outaged_branch_ids</span><span class="p">,</span> <span class="s2">&quot;voltage_level1_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="o">+</span> <span class="n">branches</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">monitored_branches</span> <span class="o">+</span> <span class="n">outaged_branch_ids</span><span class="p">,</span> <span class="s2">&quot;voltage_level2_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="p">)</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="n">powsybl_monitored_elements</span> <span class="o">=</span> <span class="n">PowsyblMonitoredElements</span><span class="p">(</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="n">branches</span><span class="o">=</span><span class="n">monitored_branches</span><span class="p">,</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">trafo3w</span><span class="o">=</span><span class="n">monitored_trafo3w</span><span class="p">,</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="n">switches</span><span class="o">=</span><span class="n">monitored_switches</span><span class="p">,</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="n">buses</span><span class="o">=</span><span class="n">monitored_buses</span><span class="p">,</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">voltage_levels</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">monitored_voltage_levels</span><span class="p">),</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="p">)</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">element_name_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">element</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">element</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">monitored_elements</span><span class="p">}</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="n">missing_element_ids</span> <span class="o">=</span> <span class="n">missing_branches</span> <span class="o">|</span> <span class="n">missing_buses</span> <span class="o">|</span> <span class="n">missing_switches</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="n">missing_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">monitored_elements</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">missing_element_ids</span><span class="p">]</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="k">return</span> <span class="n">powsybl_monitored_elements</span><span class="p">,</span> <span class="n">element_name_mapping</span><span class="p">,</span> <span class="n">missing_elements</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">prepare_branch_limits</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">prepare_branch_limits</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">branch_limits</span><span class="p">,</span> <span class="n">chosen_limit</span><span class="p">,</span> <span class="n">monitored_branches</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Prepare the branch limits for the N-1 analysis.</p>
<p>This is done here, to avoid having to do this in every process.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>branch_limits</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the branch limits of the network.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chosen_limit</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The name of the limit to be used for the N-1 analysis. This is usually "permanent_limit".</p>
<h4 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits--todo-decide-if-and-how-this-could-be-extended-to-other-limits">TODO Decide if and how this could be extended to other limits.<a class="headerlink" href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.prepare_branch_limits--todo-decide-if-and-how-this-could-be-extended-to-other-limits" title="Permanent link">#</a></h4>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_branches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of branches to be monitored during the N-1 analysis.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>branch_limits</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The dataframe containing the branch limits for the N-1 analysis in the right format.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="k">def</span><span class="w"> </span><span class="nf">prepare_branch_limits</span><span class="p">(</span><span class="n">branch_limits</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">chosen_limit</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">monitored_branches</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare the branch limits for the N-1 analysis.</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    This is done here, to avoid having to do this in every process.</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    ----------</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    branch_limits : pd.DataFrame</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        The dataframe containing the branch limits of the network.</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    chosen_limit : str</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        The name of the limit to be used for the N-1 analysis. This is usually &quot;permanent_limit&quot;.</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        #TODO Decide if and how this could be extended to other limits.</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">    monitored_branches : list[str]</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        The list of branches to be monitored during the N-1 analysis.</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    Returns</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    -------</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    branch_limits : pd.DataFrame</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        The dataframe containing the branch limits for the N-1 analysis in the right format.</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="n">translated_limits</span> <span class="o">=</span> <span class="n">branch_limits</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="n">chosen_limit_type</span> <span class="o">=</span> <span class="n">translated_limits</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">chosen_limit</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="n">limit_monitored</span> <span class="o">=</span> <span class="n">translated_limits</span><span class="p">[</span><span class="s2">&quot;element_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monitored_branches</span><span class="p">)</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="n">translated_limits</span> <span class="o">=</span> <span class="n">translated_limits</span><span class="p">[</span><span class="n">chosen_limit_type</span> <span class="o">&amp;</span> <span class="n">limit_monitored</span><span class="p">]</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="n">translated_limits</span><span class="p">[</span><span class="s2">&quot;side&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">translated_limits</span><span class="p">[</span><span class="s2">&quot;side&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s2">&quot;ONE&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;TWO&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;THREE&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="k">return</span> <span class="n">translated_limits</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;element_id&quot;</span><span class="p">,</span> <span class="s2">&quot;side&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()[[</span><span class="s2">&quot;value&quot;</span><span class="p">]]</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_blank_va_diff</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_blank_va_diff</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">all_outages</span><span class="p">,</span> <span class="n">single_branch_outages</span><span class="p">,</span> <span class="n">monitored_switches</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get a blank dataframe for the voltage angle difference results.</p>
<p>This already includes all possible contingencies and monitored switches.
The buses of the switches and the outaged branches are added later.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>all_outages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of all outages to be considered. For all of these cases, all switches need to be checked</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>single_branch_outages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary mapping contingency ids to single outaged element ids.
For all of these cases, the specific outaged branch need to be checked.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_switches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored switches to be considered. These are only the switches that are open and retained.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandas.DataFrame">DataFrame</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A blank dataframe with the correct index for the voltage angle difference results.
The index is a MultiIndex with the following levels:
- timestep: The timestep of the results
- contingency: The contingency id (including an empty string for the base case)
- element: The element id (the switch or outaged branch)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_blank_va_diff</span><span class="p">(</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="n">all_outages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">single_branch_outages</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">monitored_switches</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a blank dataframe for the voltage angle difference results.</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    This already includes all possible contingencies and monitored switches.</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">    The buses of the switches and the outaged branches are added later.</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    ----------</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    all_outages : list[str]</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        The list of all outages to be considered. For all of these cases, all switches need to be checked</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    single_branch_outages : dict[str, str]</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        A dictionary mapping contingency ids to single outaged element ids.</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        For all of these cases, the specific outaged branch need to be checked.</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    monitored_switches : list[str]</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        The list of monitored switches to be considered. These are only the switches that are open and retained.</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    Returns</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">    -------</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    pd.DataFrame</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        A blank dataframe with the correct index for the voltage angle difference results.</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        The index is a MultiIndex with the following levels:</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        - timestep: The timestep of the results</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        - contingency: The contingency id (including an empty string for the base case)</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        - element: The element id (the switch or outaged branch)</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="n">basecase_in_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">switch_va_diff_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">(</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="p">[</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a>                <span class="p">[</span><span class="n">basecase_in_result</span><span class="p">,</span> <span class="o">*</span><span class="n">all_outages</span><span class="p">],</span>  <span class="c1"># Add the empty string for the basecase</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a>                <span class="n">monitored_switches</span><span class="p">,</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="p">],</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">],</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="p">)</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="p">)</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="n">outage_va_diff_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">(</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="p">[</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a>                <span class="n">single_branch_outages</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a>            <span class="p">],</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;contingency&quot;</span><span class="p">],</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="p">)</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="p">)</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="n">outage_va_diff_df</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">single_branch_outages</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">outage_va_diff_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;element&quot;</span><span class="p">],</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="n">blank_va_diff_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">switch_va_diff_df</span><span class="p">,</span> <span class="n">outage_va_diff_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="k">return</span> <span class="n">blank_va_diff_df</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff_with_buses" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_blank_va_diff_with_buses</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_blank_va_diff_with_buses" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_blank_va_diff_with_buses</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">branches</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">switches</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">pow_contingencies</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">monitored_switches</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get a blank dataframe for the voltage angle difference results with the buspairs that need checking.</p>
<p>The buspairs are bus_breaker_buses (net.get_bus_breaker_view_buses)</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>branches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the branches of the network and their bus_breaker_buses.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>switches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the switches of the network and their bus_breaker_buses.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pow_contingencies</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of all contingencies to be considered. For all of these cases, all switches need to be checked.
For single outages we also consider the outaged branches.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="            PowsyblContingency (toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency)" href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblContingency">PowsyblContingency</a>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_switches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored switches to be considered. These are only the switches that are open and retained.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandas.DataFrame">DataFrame</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A blank dataframe with the correct index for the voltage angle difference results.
The index is a MultiIndex with the following levels:
- contingency: The contingency id (including an empty string for the base case)
- element: The element id (the switch or outaged branch)
- bus_breaker_bus1_id: The first bus_breaker_bus_id of the element
- bus_breaker_bus2_id: The second bus_breaker_bus_id of the element</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_blank_va_diff_with_buses</span><span class="p">(</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="n">branches</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="n">switches</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="n">pow_contingencies</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PowsyblContingency</span><span class="p">],</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="n">monitored_switches</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a blank dataframe for the voltage angle difference results with the buspairs that need checking.</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">    The buspairs are bus_breaker_buses (net.get_bus_breaker_view_buses)</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">    ----------</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">    branches : pd.DataFrame</span>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">        The dataframe containing the branches of the network and their bus_breaker_buses.</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">    switches : pd.DataFrame</span>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        The dataframe containing the switches of the network and their bus_breaker_buses.</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">    pow_contingencies: list[PowsyblContingency]</span>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        The list of all contingencies to be considered. For all of these cases, all switches need to be checked.</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        For single outages we also consider the outaged branches.</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">    monitored_switches : list[str]</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        The list of monitored switches to be considered. These are only the switches that are open and retained.</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">    Returns</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">    -------</span>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">    pd.DataFrame</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        A blank dataframe with the correct index for the voltage angle difference results.</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        The index is a MultiIndex with the following levels:</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        - contingency: The contingency id (including an empty string for the base case)</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        - element: The element id (the switch or outaged branch)</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        - bus_breaker_bus1_id: The first bus_breaker_bus_id of the element</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        - bus_breaker_bus2_id: The second bus_breaker_bus_id of the element</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="n">branch_indizes</span> <span class="o">=</span> <span class="n">branches</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;type in [&#39;LINE&#39;, &#39;TWO_WINDINGS_TRANSFORMER&#39;, &#39;TIE_LINE&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="n">single_contingencies</span> <span class="o">=</span> <span class="p">[</span><span class="n">contingency</span> <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">pow_contingencies</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contingency</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="n">single_branch_outages</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="n">contingency</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">contingency</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">single_contingencies</span>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="k">if</span> <span class="n">contingency</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">branch_indizes</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="p">}</span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="n">branches</span> <span class="o">=</span> <span class="n">branches</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">single_branch_outages</span><span class="o">.</span><span class="n">values</span><span class="p">()][[</span><span class="s2">&quot;bus_breaker_bus1_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus2_id&quot;</span><span class="p">]]</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="n">switches</span> <span class="o">=</span> <span class="n">switches</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">monitored_switches</span><span class="p">]</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="n">switches</span> <span class="o">=</span> <span class="n">switches</span><span class="p">[</span><span class="n">switches</span><span class="o">.</span><span class="n">open</span> <span class="o">&amp;</span> <span class="n">switches</span><span class="o">.</span><span class="n">retained</span><span class="p">][[</span><span class="s2">&quot;bus_breaker_bus1_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus2_id&quot;</span><span class="p">]]</span>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="n">element_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">branches</span><span class="p">,</span> <span class="n">switches</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="n">all_outage_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">contingency</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">pow_contingencies</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contingency</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="n">blank_va_diff</span> <span class="o">=</span> <span class="n">get_blank_va_diff</span><span class="p">(</span><span class="n">all_outage_ids</span><span class="p">,</span> <span class="n">single_branch_outages</span><span class="p">,</span> <span class="n">switches</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="n">va_diff_with_buses</span> <span class="o">=</span> <span class="n">blank_va_diff</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="n">element_df</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">blank_va_diff</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;key_0&quot;</span><span class="p">)</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="k">return</span> <span class="n">va_diff_with_buses</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_va_diff_results" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_va_diff_results</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_va_diff_results" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_va_diff_results</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">bus_results</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">outages</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">va_diff_with_buses</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">bus_map</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the voltage angle difference results for the given outages and bus results.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bus_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the bus results of powsybl contingency analysis.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>outages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of outages to be considered. These are the contingency ids that are outaged.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>va_diff_with_buses</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the voltage angle difference results with the bus pairs that need checking.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bus_map</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A mapping from busbar sections to bus breaker buses. This is used to convert the busbar sections to bus breaker buses
in the Node Breaker model.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep of the results.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandas.DataFrame">DataFrame</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The dataframe containing the voltage angle difference results for the given outages.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-429"><a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-430"><a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_va_diff_results</span><span class="p">(</span>
</span><span id="__span-0-431"><a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="n">bus_results</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">outages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">va_diff_with_buses</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">bus_map</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-0-432"><a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pat</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">VADiffResultSchema</span><span class="p">]:</span>
</span><span id="__span-0-433"><a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the voltage angle difference results for the given outages and bus results.</span>
</span><span id="__span-0-434"><a id="__codelineno-0-434" name="__codelineno-0-434"></a>
</span><span id="__span-0-435"><a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-436"><a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    ----------</span>
</span><span id="__span-0-437"><a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">    bus_results : pd.DataFrame</span>
</span><span id="__span-0-438"><a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">        The dataframe containing the bus results of powsybl contingency analysis.</span>
</span><span id="__span-0-439"><a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">    outages : list[str]</span>
</span><span id="__span-0-440"><a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        The list of outages to be considered. These are the contingency ids that are outaged.</span>
</span><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">    va_diff_with_buses : pd.DataFrame</span>
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        The dataframe containing the voltage angle difference results with the bus pairs that need checking.</span>
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    bus_map: pd.DataFrame</span>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">        A mapping from busbar sections to bus breaker buses. This is used to convert the busbar sections to bus breaker buses</span>
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">        in the Node Breaker model.</span>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">        The timestep of the results.</span>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448"></a>
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">    Returns</span>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">    -------</span>
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">    pd.DataFrame</span>
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">        The dataframe containing the voltage angle difference results for the given outages.</span>
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-454"><a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outages</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">va_diff_with_buses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-455"><a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="k">return</span> <span class="n">get_empty_dataframe_from_model</span><span class="p">(</span><span class="n">VADiffResultSchema</span><span class="p">)</span>
</span><span id="__span-0-456"><a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="n">basecase_in_result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-457"><a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">va_diff_with_buses</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="__span-0-458"><a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="n">va_diff_with_buses</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">basecase_in_result</span><span class="p">,</span> <span class="o">*</span><span class="n">outages</span><span class="p">])</span>
</span><span id="__span-0-459"><a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="p">]</span>
</span><span id="__span-0-460"><a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="n">iteration_va_diff</span><span class="p">[</span><span class="s2">&quot;timestep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timestep</span>
</span><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="c1"># Map busbar sections where there are any. For the rest use the bus_breaker_bus_id from the results (here the bus id)</span>
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="n">bus_results</span> <span class="o">=</span> <span class="n">bus_results</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="n">bus_map</span><span class="o">.</span><span class="n">bus_breaker_bus_id</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">bus_results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;bus_id&quot;</span><span class="p">),</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="p">)</span>
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465"></a>
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="__span-0-467"><a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="c1"># Map the values from the results to the buses of the switches and the outaged branches</span>
</span><span id="__span-0-468"><a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
</span><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="n">bus_results</span><span class="p">[[</span><span class="s2">&quot;v_angle&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">add_suffix</span><span class="p">(</span><span class="s2">&quot;_1&quot;</span><span class="p">),</span>
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus1_id&quot;</span><span class="p">],</span>
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="n">bus_results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">),</span> <span class="n">bus_results</span><span class="o">.</span><span class="n">bus_breaker_bus_id</span><span class="p">],</span>
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="p">)</span>
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="n">bus_results</span><span class="p">[[</span><span class="s2">&quot;v_angle&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">add_suffix</span><span class="p">(</span><span class="s2">&quot;_2&quot;</span><span class="p">),</span>
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus2_id&quot;</span><span class="p">],</span>
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="n">bus_results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">),</span> <span class="n">bus_results</span><span class="o">.</span><span class="n">bus_breaker_bus_id</span><span class="p">],</span>
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="p">)</span>
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481"></a>    <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;timestep&quot;</span><span class="p">,</span> <span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="n">iteration_va_diff</span><span class="p">[</span><span class="s2">&quot;va_diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="p">[</span><span class="s2">&quot;v_angle_1&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">iteration_va_diff</span><span class="p">[</span><span class="s2">&quot;v_angle_2&quot;</span><span class="p">]</span>
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483"></a>
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="n">iteration_va_diff</span> <span class="o">=</span> <span class="n">iteration_va_diff</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bus_breaker_bus1_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus2_id&quot;</span><span class="p">,</span> <span class="s2">&quot;v_angle_1&quot;</span><span class="p">,</span> <span class="s2">&quot;v_angle_2&quot;</span><span class="p">]</span>
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="p">)</span>
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487"></a>
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="c1"># set empty columns to NaN</span>
</span><span id="__span-0-489"><a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="n">iteration_va_diff</span><span class="p">[</span><span class="s2">&quot;element_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-490"><a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="n">iteration_va_diff</span><span class="p">[</span><span class="s2">&quot;contingency_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-491"><a id="__codelineno-0-491" name="__codelineno-0-491"></a>
</span><span id="__span-0-492"><a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="k">return</span> <span class="n">iteration_va_diff</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_busbar_mapping" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_busbar_mapping</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_busbar_mapping" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_busbar_mapping</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get a map between the different kind of buses in the network.</p>
<p>Maps busbar sections and bus breaker buses to bus breaker buses and electrical buses.
Maps the electrical buses to monitored buses (either bus breaker or busbar sections).</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The Powsybl network to use for the translation. This is used to get the busbar sections and bus breaker buses.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pypowsybl.network.Network">Network</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandas.DataFrame">DataFrame</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A dataframe containing the busbar mapping from busbar sections to bus breaker buses.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_busbar_mapping</span><span class="p">(</span><span class="n">net</span><span class="p">:</span> <span class="n">Network</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a map between the different kind of buses in the network.</span>
</span><span id="__span-0-497"><a id="__codelineno-0-497" name="__codelineno-0-497"></a>
</span><span id="__span-0-498"><a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">    Maps busbar sections and bus breaker buses to bus breaker buses and electrical buses.</span>
</span><span id="__span-0-499"><a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">    Maps the electrical buses to monitored buses (either bus breaker or busbar sections).</span>
</span><span id="__span-0-500"><a id="__codelineno-0-500" name="__codelineno-0-500"></a>
</span><span id="__span-0-501"><a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-502"><a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">    ----------</span>
</span><span id="__span-0-503"><a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">    net : Network</span>
</span><span id="__span-0-504"><a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        The Powsybl network to use for the translation. This is used to get the busbar sections and bus breaker buses.</span>
</span><span id="__span-0-505"><a id="__codelineno-0-505" name="__codelineno-0-505"></a>
</span><span id="__span-0-506"><a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">    Returns</span>
</span><span id="__span-0-507"><a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">    -------</span>
</span><span id="__span-0-508"><a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">    pd.DataFrame</span>
</span><span id="__span-0-509"><a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">        A dataframe containing the busbar mapping from busbar sections to bus breaker buses.</span>
</span><span id="__span-0-510"><a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-511"><a id="__codelineno-0-511" name="__codelineno-0-511"></a>    <span class="n">busbar_sections</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_injections</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_id&quot;</span><span class="p">,</span> <span class="s2">&quot;voltage_level_id&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
</span><span id="__span-0-512"><a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="s2">&quot;type == &#39;BUSBAR_SECTION&#39;&quot;</span>
</span><span id="__span-0-513"><a id="__codelineno-0-513" name="__codelineno-0-513"></a>    <span class="p">)</span>
</span><span id="__span-0-514"><a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="n">mapping_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_id&quot;</span><span class="p">,</span> <span class="s2">&quot;voltage_level_id&quot;</span><span class="p">]</span>
</span><span id="__span-0-515"><a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="n">bus_breaker_buses</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_bus_breaker_view_buses</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;voltage_level_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_id&quot;</span><span class="p">])</span>
</span><span id="__span-0-516"><a id="__codelineno-0-516" name="__codelineno-0-516"></a>    <span class="n">bus_breaker_buses</span><span class="p">[</span><span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bus_breaker_buses</span><span class="o">.</span><span class="n">index</span>
</span><span id="__span-0-517"><a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="n">bus_map</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">busbar_sections</span><span class="p">[</span><span class="n">mapping_cols</span><span class="p">],</span> <span class="n">bus_breaker_buses</span><span class="p">[</span><span class="n">mapping_cols</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-518"><a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="k">return</span> <span class="n">bus_map</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_nminus1_for_powsybl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">translate_nminus1_for_powsybl</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.translate_nminus1_for_powsybl" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">translate_nminus1_for_powsybl</span><span class="p">(</span><span class="n">n_minus_1_definition</span><span class="p">,</span> <span class="n">net</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Translate the N-1 definition to a format that can be used in Powsybl.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_minus_1_definition</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The N-1 definition to translate.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            Nminus1Definition (toop_engine_interfaces.nminus1_definition.Nminus1Definition)" href="../reference_interfaces/#toop_engine_interfaces.nminus1_definition.Nminus1Definition">Nminus1Definition</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The Powsybl network to use for the translation. This is used to get the busbarsections, buses, branches and switches.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pypowsybl.network.Network">Network</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="            PowsyblNMinus1Definition (toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition)" href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.PowsyblNMinus1Definition">PowsyblNMinus1Definition</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The translated N-1 definition that can be used in Powsybl.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-521"><a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="k">def</span><span class="w"> </span><span class="nf">translate_nminus1_for_powsybl</span><span class="p">(</span><span class="n">n_minus_1_definition</span><span class="p">:</span> <span class="n">Nminus1Definition</span><span class="p">,</span> <span class="n">net</span><span class="p">:</span> <span class="n">Network</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PowsyblNMinus1Definition</span><span class="p">:</span>
</span><span id="__span-0-522"><a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Translate the N-1 definition to a format that can be used in Powsybl.</span>
</span><span id="__span-0-523"><a id="__codelineno-0-523" name="__codelineno-0-523"></a>
</span><span id="__span-0-524"><a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">    ----------</span>
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">    n_minus_1_definition : Nminus1Definition</span>
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        The N-1 definition to translate.</span>
</span><span id="__span-0-528"><a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">    net : Network</span>
</span><span id="__span-0-529"><a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">        The Powsybl network to use for the translation. This is used to get the busbarsections, buses, branches and switches.</span>
</span><span id="__span-0-530"><a id="__codelineno-0-530" name="__codelineno-0-530"></a>
</span><span id="__span-0-531"><a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">    Returns</span>
</span><span id="__span-0-532"><a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">    -------</span>
</span><span id="__span-0-533"><a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">    PowsyblNMinus1Definition</span>
</span><span id="__span-0-534"><a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">        The translated N-1 definition that can be used in Powsybl.</span>
</span><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="n">id_type</span> <span class="o">=</span> <span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">id_type</span> <span class="ow">or</span> <span class="s2">&quot;powsybl&quot;</span>
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="c1"># By default we assume the id_type is powsybl. This works for all powsybl identifiables</span>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="k">if</span> <span class="n">id_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">supported_ids</span> <span class="o">:=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">POWSYBL_SUPPORTED_ID_TYPES</span><span class="p">)):</span>
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="sa">f</span><span class="s2">&quot;Unsupported id_type </span><span class="si">{</span><span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">id_type</span><span class="si">}</span><span class="s2">. Only </span><span class="si">{</span><span class="n">supported_ids</span><span class="si">}</span><span class="s2"> are supported for Powsybl.&quot;</span>
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="p">)</span>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542"></a>
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="c1"># Load data once from the network</span>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="n">busmap</span> <span class="o">=</span> <span class="n">get_busbar_mapping</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="n">voltage_levels</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_voltage_levels</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nominal_v&quot;</span><span class="p">,</span> <span class="s2">&quot;high_voltage_limit&quot;</span><span class="p">,</span> <span class="s2">&quot;low_voltage_limit&quot;</span><span class="p">])</span>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="n">voltage_levels</span><span class="p">[</span><span class="s2">&quot;high_voltage_limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">voltage_levels</span><span class="p">[</span><span class="s2">&quot;high_voltage_limit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">voltage_levels</span><span class="p">[</span><span class="s2">&quot;nominal_v&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="n">voltage_levels</span><span class="p">[</span><span class="s2">&quot;low_voltage_limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">voltage_levels</span><span class="p">[</span><span class="s2">&quot;low_voltage_limit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">voltage_levels</span><span class="p">[</span><span class="s2">&quot;nominal_v&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548"></a>
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="n">branch_limits</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_operational_limits</span><span class="p">()</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;type==&#39;CURRENT&#39;&quot;</span><span class="p">)</span>
</span><span id="__span-0-550"><a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="n">branches</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_branches</span><span class="p">(</span>
</span><span id="__span-0-551"><a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;voltage_level1_id&quot;</span><span class="p">,</span> <span class="s2">&quot;voltage_level2_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus1_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus2_id&quot;</span><span class="p">]</span>
</span><span id="__span-0-552"><a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="p">)</span>
</span><span id="__span-0-553"><a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="n">trafo3ws</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_3_windings_transformers</span><span class="p">(</span>
</span><span id="__span-0-554"><a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="n">attributes</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-555"><a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="s2">&quot;voltage_level1_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-556"><a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="s2">&quot;voltage_level2_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-557"><a id="__codelineno-0-557" name="__codelineno-0-557"></a>            <span class="s2">&quot;voltage_level3_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-558"><a id="__codelineno-0-558" name="__codelineno-0-558"></a>            <span class="s2">&quot;bus_breaker_bus1_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-559"><a id="__codelineno-0-559" name="__codelineno-0-559"></a>            <span class="s2">&quot;bus_breaker_bus2_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-560"><a id="__codelineno-0-560" name="__codelineno-0-560"></a>            <span class="s2">&quot;bus_breaker_bus3_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-561"><a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="p">]</span>
</span><span id="__span-0-562"><a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;THREE_WINDINGS_TRANSFORMER&quot;</span><span class="p">)</span>
</span><span id="__span-0-563"><a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="n">all_branches</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">branches</span><span class="p">,</span> <span class="n">trafo3ws</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-564"><a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="n">switches</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_switches</span><span class="p">(</span>
</span><span id="__span-0-565"><a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="s2">&quot;retained&quot;</span><span class="p">,</span> <span class="s2">&quot;voltage_level_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus1_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_breaker_bus2_id&quot;</span><span class="p">]</span>
</span><span id="__span-0-566"><a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="p">)</span>
</span><span id="__span-0-567"><a id="__codelineno-0-567" name="__codelineno-0-567"></a>    <span class="n">trafo3ws</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_3_windings_transformers</span><span class="p">(</span>
</span><span id="__span-0-568"><a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="n">attributes</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-0-569"><a id="__codelineno-0-569" name="__codelineno-0-569"></a>            <span class="s2">&quot;voltage_level1_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-570"><a id="__codelineno-0-570" name="__codelineno-0-570"></a>            <span class="s2">&quot;voltage_level2_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-571"><a id="__codelineno-0-571" name="__codelineno-0-571"></a>            <span class="s2">&quot;voltage_level3_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-572"><a id="__codelineno-0-572" name="__codelineno-0-572"></a>            <span class="s2">&quot;bus_breaker_bus1_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-573"><a id="__codelineno-0-573" name="__codelineno-0-573"></a>            <span class="s2">&quot;bus_breaker_bus2_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-574"><a id="__codelineno-0-574" name="__codelineno-0-574"></a>            <span class="s2">&quot;bus_breaker_bus3_id&quot;</span><span class="p">,</span>
</span><span id="__span-0-575"><a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="p">]</span>
</span><span id="__span-0-576"><a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="p">)</span>
</span><span id="__span-0-577"><a id="__codelineno-0-577" name="__codelineno-0-577"></a>    <span class="n">identifiables</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_identifiables</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[])</span><span class="o">.</span><span class="n">index</span>
</span><span id="__span-0-578"><a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="n">pow_contingencies</span><span class="p">,</span> <span class="n">missing_contingencies</span> <span class="o">=</span> <span class="n">translate_contingency_to_powsybl</span><span class="p">(</span>
</span><span id="__span-0-579"><a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">contingencies</span><span class="p">,</span> <span class="n">identifiables</span>
</span><span id="__span-0-580"><a id="__codelineno-0-580" name="__codelineno-0-580"></a>    <span class="p">)</span>
</span><span id="__span-0-581"><a id="__codelineno-0-581" name="__codelineno-0-581"></a>    <span class="n">contingency_name_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">contingency</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">contingency</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">contingencies</span><span class="p">}</span>
</span><span id="__span-0-582"><a id="__codelineno-0-582" name="__codelineno-0-582"></a>    <span class="p">(</span><span class="n">monitored_elements</span><span class="p">,</span> <span class="n">element_name_map</span><span class="p">,</span> <span class="n">missing_elements</span><span class="p">)</span> <span class="o">=</span> <span class="n">translate_monitored_elements_to_powsybl</span><span class="p">(</span>
</span><span id="__span-0-583"><a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="n">n_minus_1_definition</span><span class="p">,</span> <span class="n">all_branches</span><span class="p">,</span> <span class="n">busmap</span><span class="p">,</span> <span class="n">switches</span>
</span><span id="__span-0-584"><a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="p">)</span>
</span><span id="__span-0-585"><a id="__codelineno-0-585" name="__codelineno-0-585"></a>
</span><span id="__span-0-586"><a id="__codelineno-0-586" name="__codelineno-0-586"></a>    <span class="c1"># create an empty dataframe with the correct index</span>
</span><span id="__span-0-587"><a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="n">va_diff_with_buses</span> <span class="o">=</span> <span class="n">get_blank_va_diff_with_buses</span><span class="p">(</span><span class="n">branches</span><span class="p">,</span> <span class="n">switches</span><span class="p">,</span> <span class="n">pow_contingencies</span><span class="p">,</span> <span class="n">monitored_elements</span><span class="p">[</span><span class="s2">&quot;switches&quot;</span><span class="p">])</span>
</span><span id="__span-0-588"><a id="__codelineno-0-588" name="__codelineno-0-588"></a>    <span class="n">branch_limits</span> <span class="o">=</span> <span class="n">prepare_branch_limits</span><span class="p">(</span><span class="n">branch_limits</span><span class="p">,</span> <span class="s2">&quot;permanent_limit&quot;</span><span class="p">,</span> <span class="n">monitored_elements</span><span class="p">[</span><span class="s2">&quot;branches&quot;</span><span class="p">])</span>
</span><span id="__span-0-589"><a id="__codelineno-0-589" name="__codelineno-0-589"></a>    <span class="k">return</span> <span class="n">PowsyblNMinus1Definition</span><span class="p">(</span>
</span><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="n">contingencies</span><span class="o">=</span><span class="n">pow_contingencies</span><span class="p">,</span>
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="n">blank_va_diff</span><span class="o">=</span><span class="n">va_diff_with_buses</span><span class="p">,</span>
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="n">monitored_elements</span><span class="o">=</span><span class="n">monitored_elements</span><span class="p">,</span>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="n">branch_limits</span><span class="o">=</span><span class="n">branch_limits</span><span class="p">,</span>
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="n">bus_map</span><span class="o">=</span><span class="n">busmap</span><span class="p">,</span>
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="n">element_name_mapping</span><span class="o">=</span><span class="n">element_name_map</span><span class="p">,</span>
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="n">contingency_name_mapping</span><span class="o">=</span><span class="n">contingency_name_map</span><span class="p">,</span>
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="n">voltage_levels</span><span class="o">=</span><span class="n">voltage_levels</span><span class="p">,</span>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="n">distributed_slack</span><span class="o">=</span><span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">loadflow_parameters</span><span class="o">.</span><span class="n">distributed_slack</span><span class="p">,</span>
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="n">missing_elements</span><span class="o">=</span><span class="n">missing_elements</span><span class="p">,</span>
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="n">missing_contingencies</span><span class="o">=</span><span class="n">missing_contingencies</span><span class="p">,</span>
</span><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="n">contingency_propagation</span><span class="o">=</span><span class="n">n_minus_1_definition</span><span class="o">.</span><span class="n">loadflow_parameters</span><span class="o">.</span><span class="n">contingency_propagation</span><span class="p">,</span>
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_regulating_element_results" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_regulating_element_results</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_regulating_element_results" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_regulating_element_results</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">monitored_buses</span><span class="p">,</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">basecase_name</span><span class="o">=</span><span class="kc">None</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the regulating element results for the given outages and timestep.</p>
<p>TODO: This is a fake implementation, we need to get the real results from the powsybl security analysis</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>monitored_buses</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored buses to get the regulating element results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep to get the regulating element results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>basecase_name</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The name of the basecase contingency, if it is included in the run. Otherwise None, by default None</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandera.typing.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="            RegulatingElementResultSchema (toop_engine_interfaces.loadflow_results.RegulatingElementResultSchema)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.RegulatingElementResultSchema">RegulatingElementResultSchema</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The regulating element results for the given outages and timestep</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_regulating_element_results</span><span class="p">(</span>
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607"></a>    <span class="n">monitored_buses</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">basecase_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pat</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">RegulatingElementResultSchema</span><span class="p">]:</span>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the regulating element results for the given outages and timestep.</span>
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610"></a>
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">    TODO: This is a fake implementation, we need to get the real results from the powsybl security analysis</span>
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612"></a>
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">    ----------</span>
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">    monitored_buses : list[str]</span>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">        The list of monitored buses to get the regulating element results for</span>
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-618"><a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">        The timestep to get the regulating element results for</span>
</span><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">    basecase_name : str | None, optional</span>
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">        The name of the basecase contingency, if it is included in the run. Otherwise None, by default None</span>
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621"></a>
</span><span id="__span-0-622"><a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">    Returns</span>
</span><span id="__span-0-623"><a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">    -------</span>
</span><span id="__span-0-624"><a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">    pat.DataFrame[RegulatingElementResultSchema]</span>
</span><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">        The regulating element results for the given outages and timestep</span>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627"></a>    <span class="n">regulating_elements</span> <span class="o">=</span> <span class="n">get_empty_dataframe_from_model</span><span class="p">(</span><span class="n">RegulatingElementResultSchema</span><span class="p">)</span>
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628"></a>    <span class="c1"># TODO dont fake this</span>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a>    <span class="k">if</span> <span class="n">basecase_name</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">monitored_buses</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="n">regulating_elements</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">basecase_name</span><span class="p">,</span> <span class="n">monitored_buses</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.0</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="n">regulating_elements</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">basecase_name</span><span class="p">,</span> <span class="n">monitored_buses</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;regulating_element_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a>            <span class="n">RegulatingElementType</span><span class="o">.</span><span class="n">GENERATOR_Q</span><span class="o">.</span><span class="n">value</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a>        <span class="p">)</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="n">regulating_elements</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">basecase_name</span><span class="p">,</span> <span class="n">monitored_buses</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">9999.0</span>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a>        <span class="n">regulating_elements</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">basecase_name</span><span class="p">,</span> <span class="n">monitored_buses</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;regulating_element_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="n">RegulatingElementType</span><span class="o">.</span><span class="n">SLACK_P</span><span class="o">.</span><span class="n">value</span>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="p">)</span>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a>    <span class="k">return</span> <span class="n">regulating_elements</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_node_results" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_node_results</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_node_results" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_node_results</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">bus_results</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">monitored_buses</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">bus_map</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">voltage_levels</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">failed_outages</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">method</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the node results for the given outages and timestep.</p>
<p>TODO: This is currently faking the sum of p and q at the node</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bus_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The bus results from the powsybl security analysis</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_buses</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored buses to get the node results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bus_map</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A mapping from busbar sections or bus_breaker_buses to the electrical buses.
This is used to map the buses from bus_results to electrical buses and back to the monitored buses.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>voltage_levels</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The voltage levels of the buses. This is used to determine
voltage limits and nominal v in DC.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>failed_outages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of failed outages to get nan-node results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep to get the node results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The method to use for the node results. Either "ac" or "dc"</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="ac">ac</span>, <span title="dc">dc</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandera.typing.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="            NodeResultSchema (toop_engine_interfaces.loadflow_results.NodeResultSchema)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.NodeResultSchema">NodeResultSchema</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The node results for the given outages and timestep</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_node_results</span><span class="p">(</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a>    <span class="n">bus_results</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a>    <span class="n">monitored_buses</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645"></a>    <span class="n">bus_map</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646"></a>    <span class="n">voltage_levels</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647"></a>    <span class="n">failed_outages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">],</span>
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pat</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">NodeResultSchema</span><span class="p">]:</span>
</span><span id="__span-0-651"><a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the node results for the given outages and timestep.</span>
</span><span id="__span-0-652"><a id="__codelineno-0-652" name="__codelineno-0-652"></a>
</span><span id="__span-0-653"><a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">    TODO: This is currently faking the sum of p and q at the node</span>
</span><span id="__span-0-654"><a id="__codelineno-0-654" name="__codelineno-0-654"></a>
</span><span id="__span-0-655"><a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-656"><a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">    ----------</span>
</span><span id="__span-0-657"><a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">    bus_results : pd.DataFrame</span>
</span><span id="__span-0-658"><a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">        The bus results from the powsybl security analysis</span>
</span><span id="__span-0-659"><a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">    monitored_buses : list[str]</span>
</span><span id="__span-0-660"><a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">        The list of monitored buses to get the node results for</span>
</span><span id="__span-0-661"><a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">    bus_map: pd.DataFrame,</span>
</span><span id="__span-0-662"><a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">        A mapping from busbar sections or bus_breaker_buses to the electrical buses.</span>
</span><span id="__span-0-663"><a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">        This is used to map the buses from bus_results to electrical buses and back to the monitored buses.</span>
</span><span id="__span-0-664"><a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">    voltage_levels: pd.DataFrame,</span>
</span><span id="__span-0-665"><a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">        The voltage levels of the buses. This is used to determine</span>
</span><span id="__span-0-666"><a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">        voltage limits and nominal v in DC.</span>
</span><span id="__span-0-667"><a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">    failed_outages : list[str]</span>
</span><span id="__span-0-668"><a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">        The list of failed outages to get nan-node results for</span>
</span><span id="__span-0-669"><a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-670"><a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">        The timestep to get the node results for</span>
</span><span id="__span-0-671"><a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">    method : Literal[&quot;ac&quot;, &quot;dc&quot;]</span>
</span><span id="__span-0-672"><a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">        The method to use for the node results. Either &quot;ac&quot; or &quot;dc&quot;</span>
</span><span id="__span-0-673"><a id="__codelineno-0-673" name="__codelineno-0-673"></a>
</span><span id="__span-0-674"><a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">    Returns</span>
</span><span id="__span-0-675"><a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">    -------</span>
</span><span id="__span-0-676"><a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">    pat.DataFrame[NodeResultSchema]</span>
</span><span id="__span-0-677"><a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">        The node results for the given outages and timestep</span>
</span><span id="__span-0-678"><a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-679"><a id="__codelineno-0-679" name="__codelineno-0-679"></a>    <span class="k">if</span> <span class="n">bus_results</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-0-680"><a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="k">return</span> <span class="n">get_failed_node_results</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">failed_outages</span><span class="p">,</span> <span class="n">monitored_buses</span><span class="p">)</span>
</span><span id="__span-0-681"><a id="__codelineno-0-681" name="__codelineno-0-681"></a>    <span class="c1"># Translate bus_ids that could be busbar sections or bus_breaker_buses to the monitored buses</span>
</span><span id="__span-0-682"><a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="c1"># Should work for both busbar and bus_breaker models</span>
</span><span id="__span-0-683"><a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">bus_results</span><span class="p">)</span>
</span><span id="__span-0-684"><a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="n">node_results</span><span class="p">[</span><span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;bus_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">bus_map</span><span class="o">.</span><span class="n">bus_breaker_bus_id</span><span class="p">)</span>
</span><span id="__span-0-685"><a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">])</span>
</span><span id="__span-0-686"><a id="__codelineno-0-686" name="__codelineno-0-686"></a>    <span class="n">monitored_bus_map</span> <span class="o">=</span> <span class="n">bus_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">monitored_buses</span><span class="p">]</span>
</span><span id="__span-0-687"><a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="n">bus_to_element_map</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="__span-0-688"><a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">monitored_bus_map</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">monitored_bus_map</span><span class="o">.</span><span class="n">bus_breaker_bus_id</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-0-689"><a id="__codelineno-0-689" name="__codelineno-0-689"></a>    <span class="p">)</span>
</span><span id="__span-0-690"><a id="__codelineno-0-690" name="__codelineno-0-690"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">bus_to_element_map</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;bus_breaker_bus_id&quot;</span><span class="p">)</span>
</span><span id="__span-0-691"><a id="__codelineno-0-691" name="__codelineno-0-691"></a>
</span><span id="__span-0-692"><a id="__codelineno-0-692" name="__codelineno-0-692"></a>    <span class="c1"># Merge the actual voltage level in kV</span>
</span><span id="__span-0-693"><a id="__codelineno-0-693" name="__codelineno-0-693"></a>    <span class="n">voltage_columns</span> <span class="o">=</span> <span class="n">voltage_levels</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="__span-0-694"><a id="__codelineno-0-694" name="__codelineno-0-694"></a>    <span class="n">node_results</span><span class="p">[</span><span class="n">voltage_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">voltage_levels</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">node_results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;voltage_level_id&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-0-695"><a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="n">node_results</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-696"><a id="__codelineno-0-696" name="__codelineno-0-696"></a>    <span class="n">node_results</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
</span><span id="__span-0-697"><a id="__codelineno-0-697" name="__codelineno-0-697"></a>        <span class="p">[</span>
</span><span id="__span-0-698"><a id="__codelineno-0-698" name="__codelineno-0-698"></a>            <span class="n">node_results</span><span class="o">.</span><span class="n">timestep</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-0-699"><a id="__codelineno-0-699" name="__codelineno-0-699"></a>            <span class="n">node_results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-0-700"><a id="__codelineno-0-700" name="__codelineno-0-700"></a>            <span class="n">node_results</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-0-701"><a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="p">],</span>
</span><span id="__span-0-702"><a id="__codelineno-0-702" name="__codelineno-0-702"></a>        <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;timestep&quot;</span><span class="p">,</span> <span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">],</span>
</span><span id="__span-0-703"><a id="__codelineno-0-703" name="__codelineno-0-703"></a>    <span class="p">)</span>
</span><span id="__span-0-704"><a id="__codelineno-0-704" name="__codelineno-0-704"></a>
</span><span id="__span-0-705"><a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="n">node_results</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;v_mag&quot;</span><span class="p">:</span> <span class="s2">&quot;vm&quot;</span><span class="p">,</span> <span class="s2">&quot;v_angle&quot;</span><span class="p">:</span> <span class="s2">&quot;va&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-706"><a id="__codelineno-0-706" name="__codelineno-0-706"></a>
</span><span id="__span-0-707"><a id="__codelineno-0-707" name="__codelineno-0-707"></a>    <span class="c1"># Calculate the values</span>
</span><span id="__span-0-708"><a id="__codelineno-0-708" name="__codelineno-0-708"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;dc&quot;</span><span class="p">:</span>
</span><span id="__span-0-709"><a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="n">has_va</span> <span class="o">=</span> <span class="n">node_results</span><span class="p">[</span><span class="s2">&quot;va&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-0-710"><a id="__codelineno-0-710" name="__codelineno-0-710"></a>        <span class="n">node_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">has_va</span><span class="p">,</span> <span class="s2">&quot;vm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">has_va</span><span class="p">,</span> <span class="s2">&quot;nominal_v&quot;</span><span class="p">]</span>
</span><span id="__span-0-711"><a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="n">vm_deviation</span> <span class="o">=</span> <span class="n">node_results</span><span class="p">[</span><span class="s2">&quot;vm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">node_results</span><span class="p">[</span><span class="s2">&quot;nominal_v&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-0-712"><a id="__codelineno-0-712" name="__codelineno-0-712"></a>    <span class="n">deviation_to_max</span> <span class="o">=</span> <span class="n">vm_deviation</span> <span class="o">/</span> <span class="p">(</span><span class="n">node_results</span><span class="p">[</span><span class="s2">&quot;high_voltage_limit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">node_results</span><span class="p">[</span><span class="s2">&quot;nominal_v&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="__span-0-713"><a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="n">deviation_to_min</span> <span class="o">=</span> <span class="n">vm_deviation</span> <span class="o">/</span> <span class="p">(</span><span class="n">node_results</span><span class="p">[</span><span class="s2">&quot;nominal_v&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">node_results</span><span class="p">[</span><span class="s2">&quot;low_voltage_limit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="__span-0-714"><a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="n">higher_voltage</span> <span class="o">=</span> <span class="n">vm_deviation</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="__span-0-715"><a id="__codelineno-0-715" name="__codelineno-0-715"></a>    <span class="n">node_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">higher_voltage</span><span class="p">,</span> <span class="s2">&quot;vm_loading&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deviation_to_max</span><span class="p">[</span><span class="n">higher_voltage</span><span class="p">]</span>
</span><span id="__span-0-716"><a id="__codelineno-0-716" name="__codelineno-0-716"></a>    <span class="n">node_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">higher_voltage</span><span class="p">,</span> <span class="s2">&quot;vm_loading&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deviation_to_min</span><span class="p">[</span><span class="o">~</span><span class="n">higher_voltage</span><span class="p">]</span>
</span><span id="__span-0-717"><a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="c1"># TODO Add sum of p and q at the node</span>
</span><span id="__span-0-718"><a id="__codelineno-0-718" name="__codelineno-0-718"></a>    <span class="n">failed_node_results</span> <span class="o">=</span> <span class="n">get_failed_node_results</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">failed_outages</span><span class="p">,</span> <span class="n">monitored_buses</span><span class="p">)</span>
</span><span id="__span-0-719"><a id="__codelineno-0-719" name="__codelineno-0-719"></a>
</span><span id="__span-0-720"><a id="__codelineno-0-720" name="__codelineno-0-720"></a>    <span class="n">all_node_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">node_results</span><span class="p">,</span> <span class="n">failed_node_results</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[[</span><span class="s2">&quot;vm&quot;</span><span class="p">,</span> <span class="s2">&quot;va&quot;</span><span class="p">,</span> <span class="s2">&quot;vm_loading&quot;</span><span class="p">]]</span>
</span><span id="__span-0-721"><a id="__codelineno-0-721" name="__codelineno-0-721"></a>
</span><span id="__span-0-722"><a id="__codelineno-0-722" name="__codelineno-0-722"></a>    <span class="c1"># set empty dataframe columns to NaN</span>
</span><span id="__span-0-723"><a id="__codelineno-0-723" name="__codelineno-0-723"></a>    <span class="n">all_node_results</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="__span-0-724"><a id="__codelineno-0-724" name="__codelineno-0-724"></a>    <span class="n">all_node_results</span><span class="p">[</span><span class="s2">&quot;q&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="__span-0-725"><a id="__codelineno-0-725" name="__codelineno-0-725"></a>    <span class="n">all_node_results</span><span class="p">[</span><span class="s2">&quot;element_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-726"><a id="__codelineno-0-726" name="__codelineno-0-726"></a>    <span class="n">all_node_results</span><span class="p">[</span><span class="s2">&quot;contingency_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-727"><a id="__codelineno-0-727" name="__codelineno-0-727"></a>
</span><span id="__span-0-728"><a id="__codelineno-0-728" name="__codelineno-0-728"></a>    <span class="k">return</span> <span class="n">all_node_results</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_branch_results" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_branch_results</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_branch_results" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_branch_results</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">branch_results</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">three_winding_results</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">monitored_branches</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">monitored_trafo3w</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">failed_outages</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">branch_limits</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the branch results for the given outages and timestep.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>branch_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The branch results from the powsybl security analysis</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>three_winding_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The three winding transformer results from the powsybl security analysis</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_branches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored branches with 2 sides to get the branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitored_trafo3w</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of monitored three winding transformers to get the branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>failed_outages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of failed outages to get nan-branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep to get the branch results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branch_limits</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The branch limits from the powsybl network</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandera.typing.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="            BranchResultSchema (toop_engine_interfaces.loadflow_results.BranchResultSchema)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.BranchResultSchema">BranchResultSchema</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The branch results for the given outages and timestep</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-731"><a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-732"><a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_branch_results</span><span class="p">(</span>
</span><span id="__span-0-733"><a id="__codelineno-0-733" name="__codelineno-0-733"></a>    <span class="n">branch_results</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-0-734"><a id="__codelineno-0-734" name="__codelineno-0-734"></a>    <span class="n">three_winding_results</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-0-735"><a id="__codelineno-0-735" name="__codelineno-0-735"></a>    <span class="n">monitored_branches</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-736"><a id="__codelineno-0-736" name="__codelineno-0-736"></a>    <span class="n">monitored_trafo3w</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-737"><a id="__codelineno-0-737" name="__codelineno-0-737"></a>    <span class="n">failed_outages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-738"><a id="__codelineno-0-738" name="__codelineno-0-738"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-739"><a id="__codelineno-0-739" name="__codelineno-0-739"></a>    <span class="n">branch_limits</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-0-740"><a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pat</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">BranchResultSchema</span><span class="p">]:</span>
</span><span id="__span-0-741"><a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the branch results for the given outages and timestep.</span>
</span><span id="__span-0-742"><a id="__codelineno-0-742" name="__codelineno-0-742"></a>
</span><span id="__span-0-743"><a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-744"><a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="sd">    ----------</span>
</span><span id="__span-0-745"><a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">    branch_results : pd.DataFrame</span>
</span><span id="__span-0-746"><a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">        The branch results from the powsybl security analysis</span>
</span><span id="__span-0-747"><a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">    three_winding_results : pd.DataFrame</span>
</span><span id="__span-0-748"><a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">        The three winding transformer results from the powsybl security analysis</span>
</span><span id="__span-0-749"><a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="sd">    monitored_branches : list[str]</span>
</span><span id="__span-0-750"><a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">        The list of monitored branches with 2 sides to get the branch results for</span>
</span><span id="__span-0-751"><a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">    monitored_trafo3w : list[str]</span>
</span><span id="__span-0-752"><a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="sd">        The list of monitored three winding transformers to get the branch results for</span>
</span><span id="__span-0-753"><a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">    failed_outages : list[str]</span>
</span><span id="__span-0-754"><a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">        The list of failed outages to get nan-branch results for</span>
</span><span id="__span-0-755"><a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-756"><a id="__codelineno-0-756" name="__codelineno-0-756"></a><span class="sd">        The timestep to get the branch results for</span>
</span><span id="__span-0-757"><a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">    branch_limits : pd.DataFrame</span>
</span><span id="__span-0-758"><a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">        The branch limits from the powsybl network</span>
</span><span id="__span-0-759"><a id="__codelineno-0-759" name="__codelineno-0-759"></a>
</span><span id="__span-0-760"><a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">    Returns</span>
</span><span id="__span-0-761"><a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">    -------</span>
</span><span id="__span-0-762"><a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">    pat.DataFrame[BranchResultSchema]</span>
</span><span id="__span-0-763"><a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">        The branch results for the given outages and timestep</span>
</span><span id="__span-0-764"><a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-765"><a id="__codelineno-0-765" name="__codelineno-0-765"></a>    <span class="c1"># Align all indizes</span>
</span><span id="__span-0-766"><a id="__codelineno-0-766" name="__codelineno-0-766"></a>    <span class="n">branch_results</span> <span class="o">=</span> <span class="n">branch_results</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s2">&quot;operator_strategy_id&quot;</span><span class="p">)</span>
</span><span id="__span-0-767"><a id="__codelineno-0-767" name="__codelineno-0-767"></a>    <span class="n">branch_results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">:</span> <span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;branch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;element&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-768"><a id="__codelineno-0-768" name="__codelineno-0-768"></a>    <span class="n">three_winding_results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;contingency_id&quot;</span><span class="p">:</span> <span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;transformer_id&quot;</span><span class="p">:</span> <span class="s2">&quot;element&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-769"><a id="__codelineno-0-769" name="__codelineno-0-769"></a>
</span><span id="__span-0-770"><a id="__codelineno-0-770" name="__codelineno-0-770"></a>    <span class="n">side_one_results</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-771"><a id="__codelineno-0-771" name="__codelineno-0-771"></a>        <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">branch_results</span><span class="p">[[</span><span class="s2">&quot;p1&quot;</span><span class="p">,</span> <span class="s2">&quot;q1&quot;</span><span class="p">,</span> <span class="s2">&quot;i1&quot;</span><span class="p">]],</span> <span class="n">three_winding_results</span><span class="p">[[</span><span class="s2">&quot;p1&quot;</span><span class="p">,</span> <span class="s2">&quot;q1&quot;</span><span class="p">,</span> <span class="s2">&quot;i1&quot;</span><span class="p">]]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-772"><a id="__codelineno-0-772" name="__codelineno-0-772"></a>        <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">BranchSide</span><span class="o">.</span><span class="n">ONE</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="__span-0-773"><a id="__codelineno-0-773" name="__codelineno-0-773"></a>        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;p1&quot;</span><span class="p">:</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;q1&quot;</span><span class="p">:</span> <span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;i1&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">})</span>
</span><span id="__span-0-774"><a id="__codelineno-0-774" name="__codelineno-0-774"></a>    <span class="p">)</span>
</span><span id="__span-0-775"><a id="__codelineno-0-775" name="__codelineno-0-775"></a>    <span class="n">side_two_results</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-776"><a id="__codelineno-0-776" name="__codelineno-0-776"></a>        <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">branch_results</span><span class="p">[[</span><span class="s2">&quot;p2&quot;</span><span class="p">,</span> <span class="s2">&quot;q2&quot;</span><span class="p">,</span> <span class="s2">&quot;i2&quot;</span><span class="p">]],</span> <span class="n">three_winding_results</span><span class="p">[[</span><span class="s2">&quot;p2&quot;</span><span class="p">,</span> <span class="s2">&quot;q2&quot;</span><span class="p">,</span> <span class="s2">&quot;i2&quot;</span><span class="p">]]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-777"><a id="__codelineno-0-777" name="__codelineno-0-777"></a>        <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">BranchSide</span><span class="o">.</span><span class="n">TWO</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="__span-0-778"><a id="__codelineno-0-778" name="__codelineno-0-778"></a>        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;p2&quot;</span><span class="p">:</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;q2&quot;</span><span class="p">:</span> <span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;i2&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">})</span>
</span><span id="__span-0-779"><a id="__codelineno-0-779" name="__codelineno-0-779"></a>    <span class="p">)</span>
</span><span id="__span-0-780"><a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="n">side_three_results</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-781"><a id="__codelineno-0-781" name="__codelineno-0-781"></a>        <span class="n">three_winding_results</span><span class="p">[[</span><span class="s2">&quot;p3&quot;</span><span class="p">,</span> <span class="s2">&quot;q3&quot;</span><span class="p">,</span> <span class="s2">&quot;i3&quot;</span><span class="p">]]</span>
</span><span id="__span-0-782"><a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">BranchSide</span><span class="o">.</span><span class="n">THREE</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="__span-0-783"><a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;p3&quot;</span><span class="p">:</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;q3&quot;</span><span class="p">:</span> <span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;i3&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">})</span>
</span><span id="__span-0-784"><a id="__codelineno-0-784" name="__codelineno-0-784"></a>    <span class="p">)</span>
</span><span id="__span-0-785"><a id="__codelineno-0-785" name="__codelineno-0-785"></a>    <span class="c1"># Combine and Add timestep column</span>
</span><span id="__span-0-786"><a id="__codelineno-0-786" name="__codelineno-0-786"></a>    <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">side_one_results</span><span class="p">,</span> <span class="n">side_two_results</span><span class="p">,</span> <span class="n">side_three_results</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
</span><span id="__span-0-787"><a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span>
</span><span id="__span-0-788"><a id="__codelineno-0-788" name="__codelineno-0-788"></a>    <span class="p">)</span>
</span><span id="__span-0-789"><a id="__codelineno-0-789" name="__codelineno-0-789"></a>    <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;side&quot;</span><span class="p">,</span> <span class="s2">&quot;timestep&quot;</span><span class="p">],</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-790"><a id="__codelineno-0-790" name="__codelineno-0-790"></a>    <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">reorder_levels</span><span class="p">([</span><span class="s2">&quot;timestep&quot;</span><span class="p">,</span> <span class="s2">&quot;contingency&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span> <span class="s2">&quot;side&quot;</span><span class="p">])</span>
</span><span id="__span-0-791"><a id="__codelineno-0-791" name="__codelineno-0-791"></a>
</span><span id="__span-0-792"><a id="__codelineno-0-792" name="__codelineno-0-792"></a>    <span class="c1"># Add missing MultiIndex levels</span>
</span><span id="__span-0-793"><a id="__codelineno-0-793" name="__codelineno-0-793"></a>    <span class="c1"># divide current flow by current limits, but only keep the rows, that were there before</span>
</span><span id="__span-0-794"><a id="__codelineno-0-794" name="__codelineno-0-794"></a>    <span class="n">indexer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
</span><span id="__span-0-795"><a id="__codelineno-0-795" name="__codelineno-0-795"></a>        <span class="p">[</span><span class="n">converted_branch_results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="n">converted_branch_results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;side&quot;</span><span class="p">)]</span>
</span><span id="__span-0-796"><a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="p">)</span>
</span><span id="__span-0-797"><a id="__codelineno-0-797" name="__codelineno-0-797"></a>    <span class="n">converted_branch_results</span><span class="p">[</span><span class="s2">&quot;loading&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">converted_branch_results</span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">branch_limits</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">indexer</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-0-798"><a id="__codelineno-0-798" name="__codelineno-0-798"></a>
</span><span id="__span-0-799"><a id="__codelineno-0-799" name="__codelineno-0-799"></a>    <span class="c1"># Add results for non convergent contingencies</span>
</span><span id="__span-0-800"><a id="__codelineno-0-800" name="__codelineno-0-800"></a>    <span class="n">failed_branch_results</span> <span class="o">=</span> <span class="n">get_failed_branch_results</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">failed_outages</span><span class="p">,</span> <span class="n">monitored_branches</span><span class="p">,</span> <span class="n">monitored_trafo3w</span><span class="p">)</span>
</span><span id="__span-0-801"><a id="__codelineno-0-801" name="__codelineno-0-801"></a>
</span><span id="__span-0-802"><a id="__codelineno-0-802" name="__codelineno-0-802"></a>    <span class="n">converted_branch_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">converted_branch_results</span><span class="p">,</span> <span class="n">failed_branch_results</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-803"><a id="__codelineno-0-803" name="__codelineno-0-803"></a>    <span class="k">return</span> <span class="n">converted_branch_results</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_convergence_result_df" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_convergence_result_df</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_convergence_result_df" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_convergence_result_df</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">post_contingency_results</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">pre_contingency_result</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">outages</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">timestep</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">basecase_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the convergence dataframe for the given outages and timestep.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>post_contingency_results</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The post contingency results from the powsybl security analysis.
Maps contingency id to PostContingencyResult.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="pypowsybl._pypowsybl.PostContingencyResult">PostContingencyResult</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pre_contingency_result</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The pre contingency result from the powsybl security analysis. Holds the Basecase.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pypowsybl._pypowsybl.PreContingencyResult">PreContingencyResult</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>outages</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The list of outages to get the convergence results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The timestep to get the convergence results for</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>basecase_name</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The name of the basecase contingency, if it is included in the run. Otherwise None, by default None</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Optional">Optional</span>[<span title="str">str</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pandera.typing.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="            ConvergedSchema (toop_engine_interfaces.loadflow_results.ConvergedSchema)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.ConvergedSchema">ConvergedSchema</a>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The convergence dataframe for the given outages and timestep</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="list">list</span>[<span title="str">str</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The list of failed outages</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-806"><a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span>
</span><span id="__span-0-807"><a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_convergence_result_df</span><span class="p">(</span>
</span><span id="__span-0-808"><a id="__codelineno-0-808" name="__codelineno-0-808"></a>    <span class="n">post_contingency_results</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PostContingencyResult</span><span class="p">],</span>
</span><span id="__span-0-809"><a id="__codelineno-0-809" name="__codelineno-0-809"></a>    <span class="n">pre_contingency_result</span><span class="p">:</span> <span class="n">PreContingencyResult</span><span class="p">,</span>
</span><span id="__span-0-810"><a id="__codelineno-0-810" name="__codelineno-0-810"></a>    <span class="n">outages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-811"><a id="__codelineno-0-811" name="__codelineno-0-811"></a>    <span class="n">timestep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-0-812"><a id="__codelineno-0-812" name="__codelineno-0-812"></a>    <span class="n">basecase_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-813"><a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pat</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">ConvergedSchema</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="__span-0-814"><a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the convergence dataframe for the given outages and timestep.</span>
</span><span id="__span-0-815"><a id="__codelineno-0-815" name="__codelineno-0-815"></a>
</span><span id="__span-0-816"><a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-817"><a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">    ----------</span>
</span><span id="__span-0-818"><a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">    post_contingency_results: dict[str, PostContingencyResult],</span>
</span><span id="__span-0-819"><a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">        The post contingency results from the powsybl security analysis.</span>
</span><span id="__span-0-820"><a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">        Maps contingency id to PostContingencyResult.</span>
</span><span id="__span-0-821"><a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">    pre_contingency_result : PreContingencyResult</span>
</span><span id="__span-0-822"><a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        The pre contingency result from the powsybl security analysis. Holds the Basecase.</span>
</span><span id="__span-0-823"><a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">    outages : list[str]</span>
</span><span id="__span-0-824"><a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">        The list of outages to get the convergence results for</span>
</span><span id="__span-0-825"><a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">    timestep : int</span>
</span><span id="__span-0-826"><a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">        The timestep to get the convergence results for</span>
</span><span id="__span-0-827"><a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">    basecase_name : Optional[str], optional</span>
</span><span id="__span-0-828"><a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">        The name of the basecase contingency, if it is included in the run. Otherwise None, by default None</span>
</span><span id="__span-0-829"><a id="__codelineno-0-829" name="__codelineno-0-829"></a>
</span><span id="__span-0-830"><a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">    Returns</span>
</span><span id="__span-0-831"><a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">    -------</span>
</span><span id="__span-0-832"><a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">    pat.DataFrame[ConvergedSchema]</span>
</span><span id="__span-0-833"><a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">        The convergence dataframe for the given outages and timestep</span>
</span><span id="__span-0-834"><a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">    list[str]</span>
</span><span id="__span-0-835"><a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">        The list of failed outages</span>
</span><span id="__span-0-836"><a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-837"><a id="__codelineno-0-837" name="__codelineno-0-837"></a>    <span class="n">converge_converted_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">outages</span><span class="p">)</span>
</span><span id="__span-0-838"><a id="__codelineno-0-838" name="__codelineno-0-838"></a>    <span class="n">converge_converted_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;contingency&quot;</span>
</span><span id="__span-0-839"><a id="__codelineno-0-839" name="__codelineno-0-839"></a>    <span class="n">converge_converted_df</span><span class="p">[</span><span class="s2">&quot;timestep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timestep</span>
</span><span id="__span-0-840"><a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="n">converge_converted_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;timestep&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-841"><a id="__codelineno-0-841" name="__codelineno-0-841"></a>    <span class="n">converge_converted_df</span> <span class="o">=</span> <span class="n">converge_converted_df</span><span class="o">.</span><span class="n">reorder_levels</span><span class="p">([</span><span class="s2">&quot;timestep&quot;</span><span class="p">,</span> <span class="s2">&quot;contingency&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-842"><a id="__codelineno-0-842" name="__codelineno-0-842"></a>    <span class="n">converge_converted_df</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-843"><a id="__codelineno-0-843" name="__codelineno-0-843"></a>        <span class="n">post_contingency_results</span><span class="p">[</span><span class="n">contingency</span><span class="p">]</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">value</span>
</span><span id="__span-0-844"><a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="k">if</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">post_contingency_results</span>
</span><span id="__span-0-845"><a id="__codelineno-0-845" name="__codelineno-0-845"></a>        <span class="k">else</span> <span class="n">pypowsybl</span><span class="o">.</span><span class="n">loadflow</span><span class="o">.</span><span class="n">ComponentStatus</span><span class="o">.</span><span class="n">NO_CALCULATION</span><span class="o">.</span><span class="n">value</span>
</span><span id="__span-0-846"><a id="__codelineno-0-846" name="__codelineno-0-846"></a>        <span class="k">for</span> <span class="n">contingency</span> <span class="ow">in</span> <span class="n">outages</span>
</span><span id="__span-0-847"><a id="__codelineno-0-847" name="__codelineno-0-847"></a>    <span class="p">]</span>
</span><span id="__span-0-848"><a id="__codelineno-0-848" name="__codelineno-0-848"></a>    <span class="n">converge_converted_df</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">converge_converted_df</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">POWSYBL_CONVERGENCE_MAP</span><span class="p">)</span>
</span><span id="__span-0-849"><a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="n">failed_outages</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-850"><a id="__codelineno-0-850" name="__codelineno-0-850"></a>        <span class="n">outage</span>
</span><span id="__span-0-851"><a id="__codelineno-0-851" name="__codelineno-0-851"></a>        <span class="k">for</span> <span class="n">outage</span><span class="p">,</span> <span class="n">success</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outages</span><span class="p">,</span> <span class="n">converge_converted_df</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="s2">&quot;CONVERGED&quot;</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-852"><a id="__codelineno-0-852" name="__codelineno-0-852"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span>
</span><span id="__span-0-853"><a id="__codelineno-0-853" name="__codelineno-0-853"></a>    <span class="p">]</span>
</span><span id="__span-0-854"><a id="__codelineno-0-854" name="__codelineno-0-854"></a>
</span><span id="__span-0-855"><a id="__codelineno-0-855" name="__codelineno-0-855"></a>    <span class="k">if</span> <span class="n">basecase_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-856"><a id="__codelineno-0-856" name="__codelineno-0-856"></a>        <span class="c1"># Add the basecase to the convergence dataframe</span>
</span><span id="__span-0-857"><a id="__codelineno-0-857" name="__codelineno-0-857"></a>        <span class="n">converge_converted_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">timestep</span><span class="p">,</span> <span class="n">basecase_name</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">POWSYBL_CONVERGENCE_MAP</span><span class="p">[</span>
</span><span id="__span-0-858"><a id="__codelineno-0-858" name="__codelineno-0-858"></a>            <span class="n">pre_contingency_result</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">value</span>
</span><span id="__span-0-859"><a id="__codelineno-0-859" name="__codelineno-0-859"></a>        <span class="p">]</span>
</span><span id="__span-0-860"><a id="__codelineno-0-860" name="__codelineno-0-860"></a>
</span><span id="__span-0-861"><a id="__codelineno-0-861" name="__codelineno-0-861"></a>    <span class="n">converge_converted_df</span><span class="p">[</span><span class="s2">&quot;iteration_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="__span-0-862"><a id="__codelineno-0-862" name="__codelineno-0-862"></a>    <span class="n">converge_converted_df</span><span class="p">[</span><span class="s2">&quot;warnings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-863"><a id="__codelineno-0-863" name="__codelineno-0-863"></a>    <span class="n">converge_converted_df</span><span class="p">[</span><span class="s2">&quot;contingency_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-0-864"><a id="__codelineno-0-864" name="__codelineno-0-864"></a>
</span><span id="__span-0-865"><a id="__codelineno-0-865" name="__codelineno-0-865"></a>    <span class="k">return</span> <span class="n">converge_converted_df</span><span class="p">,</span> <span class="n">failed_outages</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.update_basename" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">update_basename</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.update_basename" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">update_basename</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">basecase_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Update the basecase name in the results dataframes.</p>
<p>This function updates the contingency index level of the results dataframes to
reflect the basecase name. If the basecase is not included in the run, it will
remove it from the results. Powsybl includes the basecase as an empty string by default.</p>
<p>The Dataframes are expected to have a multi-index with a "contingency" level.
The Dataframes are updated inplace.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>result_df</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the branch / node / VADiff results</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            LoadflowResultTable


  
      module-attribute
   (toop_engine_interfaces.loadflow_results.LoadflowResultTable)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.LoadflowResultTable">LoadflowResultTable</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>basecase_name</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The name of the basecase contingency, if it is included in the run. Otherwise None, by default None</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Optional">Optional</span>[<span title="str">str</span>]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="LOADFLOW_RESULT_TABLE">LOADFLOW_RESULT_TABLE</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The updated dataframes with the basecase name set or removed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-868"><a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-869"><a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_basename</span><span class="p">(</span>
</span><span id="__span-0-870"><a id="__codelineno-0-870" name="__codelineno-0-870"></a>    <span class="n">result_df</span><span class="p">:</span> <span class="n">LoadflowResultTable</span><span class="p">,</span>
</span><span id="__span-0-871"><a id="__codelineno-0-871" name="__codelineno-0-871"></a>    <span class="n">basecase_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-872"><a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoadflowResultTable</span><span class="p">:</span>
</span><span id="__span-0-873"><a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the basecase name in the results dataframes.</span>
</span><span id="__span-0-874"><a id="__codelineno-0-874" name="__codelineno-0-874"></a>
</span><span id="__span-0-875"><a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">    This function updates the contingency index level of the results dataframes to</span>
</span><span id="__span-0-876"><a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">    reflect the basecase name. If the basecase is not included in the run, it will</span>
</span><span id="__span-0-877"><a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">    remove it from the results. Powsybl includes the basecase as an empty string by default.</span>
</span><span id="__span-0-878"><a id="__codelineno-0-878" name="__codelineno-0-878"></a>
</span><span id="__span-0-879"><a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">    The Dataframes are expected to have a multi-index with a &quot;contingency&quot; level.</span>
</span><span id="__span-0-880"><a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">    The Dataframes are updated inplace.</span>
</span><span id="__span-0-881"><a id="__codelineno-0-881" name="__codelineno-0-881"></a>
</span><span id="__span-0-882"><a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-883"><a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">    ----------</span>
</span><span id="__span-0-884"><a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">    result_df: LOADFLOW_RESULT_TABLE</span>
</span><span id="__span-0-885"><a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">        The dataframe containing the branch / node / VADiff results</span>
</span><span id="__span-0-886"><a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">    basecase_name: Optional[str], optional</span>
</span><span id="__span-0-887"><a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">        The name of the basecase contingency, if it is included in the run. Otherwise None, by default None</span>
</span><span id="__span-0-888"><a id="__codelineno-0-888" name="__codelineno-0-888"></a>
</span><span id="__span-0-889"><a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">    Returns</span>
</span><span id="__span-0-890"><a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">    -------</span>
</span><span id="__span-0-891"><a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">    LOADFLOW_RESULT_TABLE</span>
</span><span id="__span-0-892"><a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">        The updated dataframes with the basecase name set or removed.</span>
</span><span id="__span-0-893"><a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-894"><a id="__codelineno-0-894" name="__codelineno-0-894"></a>    <span class="n">contingency_index_level</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;contingency&quot;</span><span class="p">)</span>
</span><span id="__span-0-895"><a id="__codelineno-0-895" name="__codelineno-0-895"></a>    <span class="k">if</span> <span class="n">basecase_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-896"><a id="__codelineno-0-896" name="__codelineno-0-896"></a>        <span class="n">result_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">set_levels</span><span class="p">(</span>
</span><span id="__span-0-897"><a id="__codelineno-0-897" name="__codelineno-0-897"></a>            <span class="n">result_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="n">contingency_index_level</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">basecase_name</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="n">x</span><span class="p">),</span>
</span><span id="__span-0-898"><a id="__codelineno-0-898" name="__codelineno-0-898"></a>            <span class="n">level</span><span class="o">=</span><span class="n">contingency_index_level</span><span class="p">,</span>
</span><span id="__span-0-899"><a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="p">)</span>
</span><span id="__span-0-900"><a id="__codelineno-0-900" name="__codelineno-0-900"></a>        <span class="k">return</span> <span class="n">result_df</span>
</span><span id="__span-0-901"><a id="__codelineno-0-901" name="__codelineno-0-901"></a>    <span class="n">result_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">contingency_index_level</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</span><span id="__span-0-902"><a id="__codelineno-0-902" name="__codelineno-0-902"></a>    <span class="k">return</span> <span class="n">result_df</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.add_name_column" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">add_name_column</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.add_name_column" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">add_name_column</span><span class="p">(</span><span class="n">result_df</span><span class="p">,</span> <span class="n">name_map</span><span class="p">,</span> <span class="n">index_level</span><span class="o">=</span><span class="s1">&#39;element&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Translate the element ids in the results dataframes to the original names.</p>
<p>This function translates the element names in the results dataframes to the original names
from the Powsybl network. This is useful for debugging and for displaying the results.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>result_df</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataframe containing the node / branch / VADiff results</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="            LoadflowResultTable


  
      module-attribute
   (toop_engine_interfaces.loadflow_results.LoadflowResultTable)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.LoadflowResultTable">LoadflowResultTable</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name_map</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A mapping from the element ids to the original names. This is used to translate the element names in the results.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index_level</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The index level storing the ids that should be mapped to the names. by default "element" for the monitored elements.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;element&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="            LoadflowResultTable


  
      module-attribute
   (toop_engine_interfaces.loadflow_results.LoadflowResultTable)" href="../reference_interfaces/#toop_engine_interfaces.loadflow_results.LoadflowResultTable">LoadflowResultTable</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The updated dataframe with the ids translated to the original names.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-905"><a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="nd">@pa</span><span class="o">.</span><span class="n">check_types</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-906"><a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_name_column</span><span class="p">(</span>
</span><span id="__span-0-907"><a id="__codelineno-0-907" name="__codelineno-0-907"></a>    <span class="n">result_df</span><span class="p">:</span> <span class="n">LoadflowResultTable</span><span class="p">,</span>
</span><span id="__span-0-908"><a id="__codelineno-0-908" name="__codelineno-0-908"></a>    <span class="n">name_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
</span><span id="__span-0-909"><a id="__codelineno-0-909" name="__codelineno-0-909"></a>    <span class="n">index_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span>
</span><span id="__span-0-910"><a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoadflowResultTable</span><span class="p">:</span>
</span><span id="__span-0-911"><a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Translate the element ids in the results dataframes to the original names.</span>
</span><span id="__span-0-912"><a id="__codelineno-0-912" name="__codelineno-0-912"></a>
</span><span id="__span-0-913"><a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">    This function translates the element names in the results dataframes to the original names</span>
</span><span id="__span-0-914"><a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">    from the Powsybl network. This is useful for debugging and for displaying the results.</span>
</span><span id="__span-0-915"><a id="__codelineno-0-915" name="__codelineno-0-915"></a>
</span><span id="__span-0-916"><a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-917"><a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">    ----------</span>
</span><span id="__span-0-918"><a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">    result_df: LoadflowResultTable</span>
</span><span id="__span-0-919"><a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">        The dataframe containing the node / branch / VADiff results</span>
</span><span id="__span-0-920"><a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">    name_map: dict[str | str]</span>
</span><span id="__span-0-921"><a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        A mapping from the element ids to the original names. This is used to translate the element names in the results.</span>
</span><span id="__span-0-922"><a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">    index_level: str, optional</span>
</span><span id="__span-0-923"><a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">        The index level storing the ids that should be mapped to the names. by default &quot;element&quot; for the monitored elements.</span>
</span><span id="__span-0-924"><a id="__codelineno-0-924" name="__codelineno-0-924"></a>
</span><span id="__span-0-925"><a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">    Returns</span>
</span><span id="__span-0-926"><a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">    -------</span>
</span><span id="__span-0-927"><a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">    LoadflowResultTable</span>
</span><span id="__span-0-928"><a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        The updated dataframe with the ids translated to the original names.</span>
</span><span id="__span-0-929"><a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-930"><a id="__codelineno-0-930" name="__codelineno-0-930"></a>    <span class="n">result_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index_level</span><span class="si">}</span><span class="s2">_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="n">index_level</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">name_map</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-0-931"><a id="__codelineno-0-931" name="__codelineno-0-931"></a>    <span class="k">return</span> <span class="n">result_df</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.set_target_values_to_lf_values_incl_distributed_slack" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">set_target_values_to_lf_values_incl_distributed_slack</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.set_target_values_to_lf_values_incl_distributed_slack" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">set_target_values_to_lf_values_incl_distributed_slack</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">net</span><span class="p">,</span> <span class="n">method</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Update the target values of generators to include the distributed slack.</p>
<p>This is necessary if you want to run the security analysis for generators without distributed their
outaged power across the whole network, but still want to mantain the original n0-flows.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The powsybl network to update</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pypowsybl.network.Network">Network</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The method to use for the loadflow, either "ac" or "dc"</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="beartype.typing.Literal">Literal</span>[<span title="ac">ac</span>, <span title="dc">dc</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="pypowsybl.network.Network">Network</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The updated network</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-934"><a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_target_values_to_lf_values_incl_distributed_slack</span><span class="p">(</span><span class="n">net</span><span class="p">:</span> <span class="n">Network</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Network</span><span class="p">:</span>
</span><span id="__span-0-935"><a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the target values of generators to include the distributed slack.</span>
</span><span id="__span-0-936"><a id="__codelineno-0-936" name="__codelineno-0-936"></a>
</span><span id="__span-0-937"><a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">    This is necessary if you want to run the security analysis for generators without distributed their</span>
</span><span id="__span-0-938"><a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">    outaged power across the whole network, but still want to mantain the original n0-flows.</span>
</span><span id="__span-0-939"><a id="__codelineno-0-939" name="__codelineno-0-939"></a>
</span><span id="__span-0-940"><a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-941"><a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">    ----------</span>
</span><span id="__span-0-942"><a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">    net : Network</span>
</span><span id="__span-0-943"><a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">        The powsybl network to update</span>
</span><span id="__span-0-944"><a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">    method : Literal[&quot;ac&quot;, &quot;dc&quot;]</span>
</span><span id="__span-0-945"><a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">        The method to use for the loadflow, either &quot;ac&quot; or &quot;dc&quot;</span>
</span><span id="__span-0-946"><a id="__codelineno-0-946" name="__codelineno-0-946"></a>
</span><span id="__span-0-947"><a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">    Returns</span>
</span><span id="__span-0-948"><a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">    -------</span>
</span><span id="__span-0-949"><a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">    Network</span>
</span><span id="__span-0-950"><a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">        The updated network</span>
</span><span id="__span-0-951"><a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-952"><a id="__codelineno-0-952" name="__codelineno-0-952"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;ac&quot;</span><span class="p">:</span>
</span><span id="__span-0-953"><a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="n">pypowsybl</span><span class="o">.</span><span class="n">loadflow</span><span class="o">.</span><span class="n">run_ac</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">DISTRIBUTED_SLACK</span><span class="p">)</span>
</span><span id="__span-0-954"><a id="__codelineno-0-954" name="__codelineno-0-954"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-955"><a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="n">pypowsybl</span><span class="o">.</span><span class="n">loadflow</span><span class="o">.</span><span class="n">run_dc</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">DISTRIBUTED_SLACK</span><span class="p">)</span>
</span><span id="__span-0-956"><a id="__codelineno-0-956" name="__codelineno-0-956"></a>    <span class="n">gens</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_generators</span><span class="p">()</span>
</span><span id="__span-0-957"><a id="__codelineno-0-957" name="__codelineno-0-957"></a>    <span class="n">gens</span><span class="p">[</span><span class="s2">&quot;target_p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">gens</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">gens</span><span class="p">[</span><span class="s2">&quot;target_p&quot;</span><span class="p">])</span>
</span><span id="__span-0-958"><a id="__codelineno-0-958" name="__codelineno-0-958"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;ac&quot;</span><span class="p">:</span>
</span><span id="__span-0-959"><a id="__codelineno-0-959" name="__codelineno-0-959"></a>        <span class="n">gens</span><span class="p">[</span><span class="s2">&quot;target_q&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">gens</span><span class="p">[</span><span class="s2">&quot;q&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">gens</span><span class="p">[</span><span class="s2">&quot;target_q&quot;</span><span class="p">])</span>
</span><span id="__span-0-960"><a id="__codelineno-0-960" name="__codelineno-0-960"></a>    <span class="n">net</span><span class="o">.</span><span class="n">update_generators</span><span class="p">(</span><span class="n">gens</span><span class="p">[[</span><span class="s2">&quot;target_p&quot;</span><span class="p">,</span> <span class="s2">&quot;target_q&quot;</span><span class="p">]])</span>
</span><span id="__span-0-961"><a id="__codelineno-0-961" name="__codelineno-0-961"></a>    <span class="n">batteries</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_batteries</span><span class="p">()</span>
</span><span id="__span-0-962"><a id="__codelineno-0-962" name="__codelineno-0-962"></a>    <span class="n">batteries</span><span class="p">[</span><span class="s2">&quot;target_p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">batteries</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">batteries</span><span class="p">[</span><span class="s2">&quot;target_p&quot;</span><span class="p">])</span>
</span><span id="__span-0-963"><a id="__codelineno-0-963" name="__codelineno-0-963"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;ac&quot;</span><span class="p">:</span>
</span><span id="__span-0-964"><a id="__codelineno-0-964" name="__codelineno-0-964"></a>        <span class="n">batteries</span><span class="p">[</span><span class="s2">&quot;target_q&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">batteries</span><span class="p">[</span><span class="s2">&quot;q&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">batteries</span><span class="p">[</span><span class="s2">&quot;target_q&quot;</span><span class="p">])</span>
</span><span id="__span-0-965"><a id="__codelineno-0-965" name="__codelineno-0-965"></a>    <span class="n">net</span><span class="o">.</span><span class="n">update_batteries</span><span class="p">(</span><span class="n">batteries</span><span class="p">[[</span><span class="s2">&quot;target_p&quot;</span><span class="p">,</span> <span class="s2">&quot;target_q&quot;</span><span class="p">]])</span>
</span><span id="__span-0-966"><a id="__codelineno-0-966" name="__codelineno-0-966"></a>    <span class="k">return</span> <span class="n">net</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_full_nminus1_definition_powsybl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_full_nminus1_definition_powsybl</span>


<a href="#toop_engine_contingency_analysis.pypowsybl.powsybl_helpers.get_full_nminus1_definition_powsybl" class="headerlink" title="Permanent link">#</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_full_nminus1_definition_powsybl</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the full N-1 definition from a Powsybl network.</p>
<p>This function retrieves the N-1 definition from a Powsybl network, including:
    Monitored Elements
        all lines, trafos, buses and switches
    Contingencies
        all lines, trafos, generators and loads
        Basecase contingency with name "BASECASE"</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>net</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The Powsybl network to retrieve the N-1 definition from.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pypowsybl.network.Network">Network</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="            Nminus1Definition (toop_engine_interfaces.nminus1_definition.Nminus1Definition)" href="../reference_interfaces/#toop_engine_interfaces.nminus1_definition.Nminus1Definition">Nminus1Definition</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The complete N-1 definition for the given Powsybl network.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>packages/contingency_analysis_pkg/src/toop_engine_contingency_analysis/pypowsybl/powsybl_helpers.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-969"><a id="__codelineno-0-969" name="__codelineno-0-969"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_full_nminus1_definition_powsybl</span><span class="p">(</span><span class="n">net</span><span class="p">:</span> <span class="n">pypowsybl</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Network</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Nminus1Definition</span><span class="p">:</span>
</span><span id="__span-0-970"><a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the full N-1 definition from a Powsybl network.</span>
</span><span id="__span-0-971"><a id="__codelineno-0-971" name="__codelineno-0-971"></a>
</span><span id="__span-0-972"><a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">    This function retrieves the N-1 definition from a Powsybl network, including:</span>
</span><span id="__span-0-973"><a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">        Monitored Elements</span>
</span><span id="__span-0-974"><a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">            all lines, trafos, buses and switches</span>
</span><span id="__span-0-975"><a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">        Contingencies</span>
</span><span id="__span-0-976"><a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">            all lines, trafos, generators and loads</span>
</span><span id="__span-0-977"><a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">            Basecase contingency with name &quot;BASECASE&quot;</span>
</span><span id="__span-0-978"><a id="__codelineno-0-978" name="__codelineno-0-978"></a>
</span><span id="__span-0-979"><a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-980"><a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">    ----------</span>
</span><span id="__span-0-981"><a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">    net : pypowsybl.network.Network</span>
</span><span id="__span-0-982"><a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">        The Powsybl network to retrieve the N-1 definition from.</span>
</span><span id="__span-0-983"><a id="__codelineno-0-983" name="__codelineno-0-983"></a>
</span><span id="__span-0-984"><a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">    Returns</span>
</span><span id="__span-0-985"><a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">    -------</span>
</span><span id="__span-0-986"><a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">    Nminus1Definition</span>
</span><span id="__span-0-987"><a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">        The complete N-1 definition for the given Powsybl network.</span>
</span><span id="__span-0-988"><a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-989"><a id="__codelineno-0-989" name="__codelineno-0-989"></a>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-990"><a id="__codelineno-0-990" name="__codelineno-0-990"></a>        <span class="n">GridElement</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;LINE&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;branch&quot;</span><span class="p">)</span>
</span><span id="__span-0-991"><a id="__codelineno-0-991" name="__codelineno-0-991"></a>        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">get_lines</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
</span><span id="__span-0-992"><a id="__codelineno-0-992" name="__codelineno-0-992"></a>    <span class="p">]</span>
</span><span id="__span-0-993"><a id="__codelineno-0-993" name="__codelineno-0-993"></a>    <span class="n">trafo2w</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-994"><a id="__codelineno-0-994" name="__codelineno-0-994"></a>        <span class="n">GridElement</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;TWO_WINDINGS_TRANSFORMER&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;branch&quot;</span><span class="p">)</span>
</span><span id="__span-0-995"><a id="__codelineno-0-995" name="__codelineno-0-995"></a>        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">get_2_windings_transformers</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
</span><span id="__span-0-996"><a id="__codelineno-0-996" name="__codelineno-0-996"></a>    <span class="p">]</span>
</span><span id="__span-0-997"><a id="__codelineno-0-997" name="__codelineno-0-997"></a>    <span class="n">trafos3w</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-998"><a id="__codelineno-0-998" name="__codelineno-0-998"></a>        <span class="n">GridElement</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;THREE_WINDINGS_TRANSFORMER&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;branch&quot;</span><span class="p">)</span>
</span><span id="__span-0-999"><a id="__codelineno-0-999" name="__codelineno-0-999"></a>        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">get_3_windings_transformers</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
</span><span id="__span-0-1000"><a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>    <span class="p">]</span>
</span><span id="__span-0-1001"><a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
</span><span id="__span-0-1002"><a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>    <span class="n">branch_elements</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">lines</span><span class="p">,</span> <span class="o">*</span><span class="n">trafo2w</span><span class="p">,</span> <span class="o">*</span><span class="n">trafos3w</span><span class="p">]</span>
</span><span id="__span-0-1003"><a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>
</span><span id="__span-0-1004"><a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>    <span class="n">switches</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-1005"><a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>        <span class="n">GridElement</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;SWITCH&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;switch&quot;</span><span class="p">)</span>
</span><span id="__span-0-1006"><a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">get_switches</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
</span><span id="__span-0-1007"><a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>    <span class="p">]</span>
</span><span id="__span-0-1008"><a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>    <span class="n">buses</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_busbar_sections</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[])</span>
</span><span id="__span-0-1009"><a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>    <span class="k">if</span> <span class="n">buses</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-0-1010"><a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="n">buses</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">get_bus_breaker_view_buses</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[])</span>
</span><span id="__span-0-1011"><a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>    <span class="n">buses</span> <span class="o">=</span> <span class="p">[</span><span class="n">GridElement</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;BUS&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bus&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">buses</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()]</span>
</span><span id="__span-0-1012"><a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>    <span class="n">monitored_elements</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">branch_elements</span><span class="p">,</span> <span class="o">*</span><span class="n">switches</span><span class="p">,</span> <span class="o">*</span><span class="n">buses</span><span class="p">]</span>
</span><span id="__span-0-1013"><a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>
</span><span id="__span-0-1014"><a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>    <span class="n">generators</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-1015"><a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>        <span class="n">GridElement</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;GENERATOR&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;injection&quot;</span><span class="p">)</span>
</span><span id="__span-0-1016"><a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">get_generators</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
</span><span id="__span-0-1017"><a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>    <span class="p">]</span>
</span><span id="__span-0-1018"><a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>    <span class="n">loads</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-1019"><a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>        <span class="n">GridElement</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;LOAD&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;injection&quot;</span><span class="p">)</span>
</span><span id="__span-0-1020"><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">net</span><span class="o">.</span><span class="n">get_loads</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
</span><span id="__span-0-1021"><a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>    <span class="p">]</span>
</span><span id="__span-0-1022"><a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>    <span class="n">outaged_elements</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">branch_elements</span><span class="p">,</span> <span class="o">*</span><span class="n">generators</span><span class="p">,</span> <span class="o">*</span><span class="n">loads</span><span class="p">]</span>
</span><span id="__span-0-1023"><a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>
</span><span id="__span-0-1024"><a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>    <span class="n">basecase_contingency</span> <span class="o">=</span> <span class="p">[</span><span class="n">Contingency</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;BASECASE&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;BASECASE&quot;</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="p">[])]</span>
</span><span id="__span-0-1025"><a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>    <span class="n">single_contingencies</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-1026"><a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>        <span class="n">Contingency</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">element</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">element</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="n">element</span><span class="p">])</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">outaged_elements</span>
</span><span id="__span-0-1027"><a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>    <span class="p">]</span>
</span><span id="__span-0-1028"><a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>
</span><span id="__span-0-1029"><a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>    <span class="n">nminus1_definition</span> <span class="o">=</span> <span class="n">Nminus1Definition</span><span class="p">(</span>
</span><span id="__span-0-1030"><a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>        <span class="n">contingencies</span><span class="o">=</span><span class="p">[</span><span class="o">*</span><span class="n">basecase_contingency</span><span class="p">,</span> <span class="o">*</span><span class="n">single_contingencies</span><span class="p">],</span>
</span><span id="__span-0-1031"><a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>        <span class="n">monitored_elements</span><span class="o">=</span><span class="n">monitored_elements</span><span class="p">,</span>
</span><span id="__span-0-1032"><a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>        <span class="n">id_type</span><span class="o">=</span><span class="s2">&quot;powsybl&quot;</span><span class="p">,</span>
</span><span id="__span-0-1033"><a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>        <span class="n">loadflow_parameters</span><span class="o">=</span><span class="n">LoadflowParameters</span><span class="p">(</span>
</span><span id="__span-0-1034"><a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>            <span class="n">distributed_slack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># This is the default for Powsybl</span>
</span><span id="__span-0-1035"><a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>        <span class="p">),</span>
</span><span id="__span-0-1036"><a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>    <span class="p">)</span>
</span><span id="__span-0-1037"><a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>    <span class="k">return</span> <span class="n">nminus1_definition</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../reference_grid_helpers/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Grid Helpers">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Grid Helpers
              </div>
            </div>
          </a>
        
        
          
          <a href="../../contribution_guide/" class="md-footer__link md-footer__link--next" aria-label="Next: Contribution Guide">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Contribution Guide
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2026 <a href="https://www.eliagroup.eu/">50Hertz Transmission GmbH and Elia Transmission Belgium SA/NV</a>. Correspondence to <a href="mailto:toop@eliagroup.eu">toop@eliagroup.eu</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tabs", {"navigation.expand": false}, "navigation.top", "content.code.copy", "navigation.footer", "content.action.edit"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../search/main.js"></script>
      
    
  </body>
</html>